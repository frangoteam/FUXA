var mypathseg=function(){"use strict";return{initPathSeg:function(){"SVGPathSeg"in window||(window.SVGPathSeg=function(t,e,n){this.pathSegType=t,this.pathSegTypeAsLetter=e,this._owningPathSegList=n},window.SVGPathSeg.prototype.classname="SVGPathSeg",window.SVGPathSeg.PATHSEG_UNKNOWN=0,window.SVGPathSeg.PATHSEG_CLOSEPATH=1,window.SVGPathSeg.PATHSEG_MOVETO_ABS=2,window.SVGPathSeg.PATHSEG_MOVETO_REL=3,window.SVGPathSeg.PATHSEG_LINETO_ABS=4,window.SVGPathSeg.PATHSEG_LINETO_REL=5,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,window.SVGPathSeg.PATHSEG_ARC_ABS=10,window.SVGPathSeg.PATHSEG_ARC_REL=11,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,window.SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(t){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CLOSEPATH,"z",t)},window.SVGPathSegClosePath.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},window.SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},window.SVGPathSegClosePath.prototype.clone=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_ABS,"M",t),this._x=e,this._y=n},window.SVGPathSegMovetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},window.SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoAbs.prototype.clone=function(){return new window.SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_REL,"m",t),this._x=e,this._y=n},window.SVGPathSegMovetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},window.SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoRel.prototype.clone=function(){return new window.SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_ABS,"L",t),this._x=e,this._y=n},window.SVGPathSegLinetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},window.SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoAbs.prototype.clone=function(){return new window.SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_REL,"l",t),this._x=e,this._y=n},window.SVGPathSegLinetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},window.SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoRel.prototype.clone=function(){return new window.SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(t,e,n,i,o,r,h){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",t),this._x=e,this._y=n,this._x1=i,this._y1=o,this._x2=r,this._y2=h},window.SVGPathSegCurvetoCubicAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},window.SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(t,e,n,i,o,r,h){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",t),this._x=e,this._y=n,this._x1=i,this._y1=o,this._x2=r,this._y2=h},window.SVGPathSegCurvetoCubicRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},window.SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(t,e,n,i,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t),this._x=e,this._y=n,this._x1=i,this._y1=o},window.SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},window.SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(t,e,n,i,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",t),this._x=e,this._y=n,this._x1=i,this._y1=o},window.SVGPathSegCurvetoQuadraticRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},window.SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(t,e,n,i,o,r,h,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_ABS,"A",t),this._x=e,this._y=n,this._r1=i,this._r2=o,this._angle=r,this._largeArcFlag=h,this._sweepFlag=s},window.SVGPathSegArcAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},window.SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcAbs.prototype.clone=function(){return new window.SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(t,e,n,i,o,r,h,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_REL,"a",t),this._x=e,this._y=n,this._r1=i,this._r2=o,this._angle=r,this._largeArcFlag=h,this._sweepFlag=s},window.SVGPathSegArcRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},window.SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcRel.prototype.clone=function(){return new window.SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t),this._x=e},window.SVGPathSegLinetoHorizontalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},window.SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",t),this._x=e},window.SVGPathSegLinetoHorizontalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},window.SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",t),this._y=e},window.SVGPathSegLinetoVerticalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},window.SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",t),this._y=e},window.SVGPathSegLinetoVerticalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},window.SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t),this._x=e,this._y=n,this._x2=i,this._y2=o},window.SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},window.SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t),this._x=e,this._y=n,this._x2=i,this._y2=o},window.SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},window.SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(t,e){return new window.SVGPathSegMovetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegMovetoRel=function(t,e){return new window.SVGPathSegMovetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(t,e){return new window.SVGPathSegLinetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoRel=function(t,e){return new window.SVGPathSegLinetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(t,e,n,i,o,r){return new window.SVGPathSegCurvetoCubicAbs(void 0,t,e,n,i,o,r)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(t,e,n,i,o,r){return new window.SVGPathSegCurvetoCubicRel(void 0,t,e,n,i,o,r)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegArcAbs=function(t,e,n,i,o,r,h){return new window.SVGPathSegArcAbs(void 0,t,e,n,i,o,r,h)},window.SVGPathElement.prototype.createSVGPathSegArcRel=function(t,e,n,i,o,r,h){return new window.SVGPathSegArcRel(void 0,t,e,n,i,o,r,h)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(t){return new window.SVGPathSegLinetoHorizontalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(t){return new window.SVGPathSegLinetoHorizontalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(t){return new window.SVGPathSegLinetoVerticalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(t){return new window.SVGPathSegLinetoVerticalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,t,e)},"getPathSegAtLength"in window.SVGPathElement.prototype||(window.SVGPathElement.prototype.getPathSegAtLength=function(t){if(void 0===t||!isFinite(t))throw"Invalid arguments.";var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",this.getAttribute("d"));var n=e.pathSegList.numberOfItems-1;if(n<=0)return 0;do{if(e.pathSegList.removeItem(n),t>e.getTotalLength())break;n--}while(n>0);return n})),"SVGPathSegList"in window&&"appendItem"in window.SVGPathSegList.prototype||(window.SVGPathSegList=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.classname="SVGPathSegList",Object.defineProperty(window.SVGPathSegList.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"pathSegList",{get:function(){return this._pathSegList||(this._pathSegList=new window.SVGPathSegList(this)),this._pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),window.SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},window.SVGPathSegList.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(t){"d"==t.attributeName&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},window.SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",window.SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.segmentChanged=function(t){this._writeListToPath()},window.SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()},window.SVGPathSegList.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"},window.SVGPathSegList.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]},window.SVGPathSegList.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(t=t.clone()),this._list.splice(e,0,t),t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._checkValidIndex(e),this._list[e]=t,t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e},window.SVGPathSegList.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._list.push(t),t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList._pathSegArrayAsString=function(t){var e="",n=!0;return t.forEach(function(t){n?(n=!1,e+=t._asPathString()):e+=" "+t._asPathString()}),e},window.SVGPathSegList.prototype._parsePath=function(t){if(!t||0==t.length)return[];var e=this,n=function(){this.pathSegList=[]};n.prototype.appendSegment=function(t){this.pathSegList.push(t)};var i=function(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=window.SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()};i.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(" "==t||"\n"==t||"\t"==t||"\r"==t||"\f"==t)},i.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},i.prototype._skipOptionalSpacesOrDelimiter=function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},i.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},i.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)},i.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return window.SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return window.SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return window.SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return window.SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return window.SVGPathSeg.PATHSEG_LINETO_REL;case"C":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return window.SVGPathSeg.PATHSEG_ARC_ABS
;case"a":return window.SVGPathSeg.PATHSEG_ARC_REL;case"H":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return window.SVGPathSeg.PATHSEG_UNKNOWN}},i.prototype._nextCommandHelper=function(t,e){return("+"==t||"-"==t||"."==t||t>="0"&&t<="9")&&e!=window.SVGPathSeg.PATHSEG_CLOSEPATH?e==window.SVGPathSeg.PATHSEG_MOVETO_ABS?window.SVGPathSeg.PATHSEG_LINETO_ABS:e==window.SVGPathSeg.PATHSEG_MOVETO_REL?window.SVGPathSeg.PATHSEG_LINETO_REL:e:window.SVGPathSeg.PATHSEG_UNKNOWN},i.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return t==window.SVGPathSeg.PATHSEG_MOVETO_ABS||t==window.SVGPathSeg.PATHSEG_MOVETO_REL},i.prototype._parseNumber=function(){var t=0,e=0,n=1,i=0,o=1,r=1,h=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,o=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!=this._string.charAt(this._currentIndex))){for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=s)for(var a=this._currentIndex-1,S=1;a>=s;)e+=S*(this._string.charAt(a--)-"0"),S*=10;if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)n*=10,i+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!=h&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var u=e+i;if(u*=o,t&&(u*=Math.pow(10,r*t)),h!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),u}},i.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if("0"==e)t=!1;else{if("1"!=e)return;t=!0}return this._skipOptionalSpacesOrDelimiter(),t}},i.prototype.parseSegment=function(){var t=this._string[this._currentIndex],n=this._pathSegTypeFromChar(t);if(n==window.SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==window.SVGPathSeg.PATHSEG_UNKNOWN)return null;if(n=this._nextCommandHelper(t,this._previousCommand),n==window.SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=n,n){case window.SVGPathSeg.PATHSEG_MOVETO_REL:return new window.SVGPathSegMovetoRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_MOVETO_ABS:return new window.SVGPathSegMovetoAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_REL:return new window.SVGPathSegLinetoRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_ABS:return new window.SVGPathSegLinetoAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new window.SVGPathSegLinetoHorizontalRel(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new window.SVGPathSegLinetoHorizontalAbs(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new window.SVGPathSegLinetoVerticalRel(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new window.SVGPathSegLinetoVerticalAbs(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new window.SVGPathSegClosePath(e);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var i={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicRel(e,i.x,i.y,i.x1,i.y1,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicAbs(e,i.x,i.y,i.x1,i.y1,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothRel(e,i.x,i.y,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothAbs(e,i.x,i.y,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticRel(e,i.x,i.y,i.x1,i.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticAbs(e,i.x,i.y,i.x1,i.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new window.SVGPathSegCurvetoQuadraticSmoothRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new window.SVGPathSegCurvetoQuadraticSmoothAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_ARC_REL:i={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcRel(e,i.x,i.y,i.x1,i.y1,i.arcAngle,i.arcLarge,i.arcSweep);case window.SVGPathSeg.PATHSEG_ARC_ABS:i={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcAbs(e,i.x,i.y,i.x1,i.y1,i.arcAngle,i.arcLarge,i.arcSweep);default:throw"Unknown path seg type."}};var o=new n,r=new i(t);if(!r.initialCommandIsMoveTo())return[];for(;r.hasMoreData();){var h=r.parseSegment();if(!h)return[];o.appendSegment(h)}return o.pathSegList})}}}();
svgedit={NS:{HTML:"http://www.w3.org/1999/xhtml",MATH:"http://www.w3.org/1998/Math/MathML",SE:"http://web-edit.com",SVG:"http://www.w3.org/2000/svg",XLINK:"http://www.w3.org/1999/xlink",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"}},svgedit.getReverseNS=function(){"use strict";var t={};return $.each(this.NS,function(w,e){t[e]=w.toLowerCase()}),t};
var mybrowser=function(){"use strict";return{initBrowser:function(){svgedit.browser||(svgedit.browser={});var e=svgedit.NS,t=!!document.createElementNS&&!!document.createElementNS(e.SVG,"svg").createSVGRect;if(svgedit.browser.supportsSvg=function(){return t},svgedit.browser.supportsSvg()){var r,n=navigator.userAgent,o=document.createElementNS(e.SVG,"svg"),s=!!window.opera,i=n.indexOf("AppleWebKit")>=0,u=n.indexOf("Gecko/")>=0,c=n.indexOf("MSIE")>=0,d=n.indexOf("Chrome/")>=0,a=n.indexOf("Windows")>=0,m=n.indexOf("Macintosh")>=0,p="ontouchstart"in window,v=!!o.querySelector,l=!!document.evaluate,g=function(){var t=document.createElementNS(e.SVG,"path");t.setAttribute("d","M0,0 10,10");var r=t.pathSegList,n=t.createSVGPathSegLinetoAbs(5,5);try{return r.replaceItem(n,1),!0}catch(e){}return!1}(),S=function(){var t=document.createElementNS(e.SVG,"path");t.setAttribute("d","M0,0 10,10");var r=t.pathSegList,n=t.createSVGPathSegLinetoAbs(5,5);try{return r.insertItemBefore(n,1),!0}catch(e){}return!1}(),f=function(){var t=document.createElementNS(e.SVG,"svg"),r=document.createElementNS(e.SVG,"svg");document.documentElement.appendChild(t),r.setAttribute("x",5),t.appendChild(r);var n=document.createElementNS(e.SVG,"text");n.textContent="a",r.appendChild(n);var o=n.getStartPositionOfChar(0).x;return document.documentElement.removeChild(t),0===o}(),b=function(){var t=document.createElementNS(e.SVG,"svg");document.documentElement.appendChild(t);var r=document.createElementNS(e.SVG,"path");r.setAttribute("d","M0,0 C0,0 10,10 10,0"),t.appendChild(r);var n=r.getBBox();return document.documentElement.removeChild(t),n.height>4&&n.height<5}(),h=function(){var t=document.createElementNS(e.SVG,"svg");document.documentElement.appendChild(t);var r=document.createElementNS(e.SVG,"path");r.setAttribute("d","M0,0 10,0");var n=document.createElementNS(e.SVG,"path");n.setAttribute("d","M5,0 15,0");var o=document.createElementNS(e.SVG,"g");o.appendChild(r),o.appendChild(n),t.appendChild(o);var s=o.getBBox();return document.documentElement.removeChild(t),15==s.width}(),w=s,E=function(){var t=document.createElementNS(e.SVG,"rect");t.setAttribute("x",.1);var r=t.cloneNode(!1),n=-1==r.getAttribute("x").indexOf(",");return n||$.alert("NOTE: This version of Opera is known to contain bugs."),n}(),G=(r=document.createElementNS(e.SVG,"rect"),r.setAttribute("style","vector-effect:non-scaling-stroke"),"non-scaling-stroke"===r.style.vectorEffect),N=function(){var t=document.createElementNS(e.SVG,"rect"),r=t.transform.baseVal,n=o.createSVGTransform();return r.appendItem(n),r.getItem(0)==n}();svgedit.browser.isOpera=function(){return s},svgedit.browser.isWebkit=function(){return i},svgedit.browser.isGecko=function(){return u},svgedit.browser.isIE=function(){return c},svgedit.browser.isChrome=function(){return d},svgedit.browser.isWindows=function(){return a},svgedit.browser.isMac=function(){return m},svgedit.browser.isTouch=function(){return p},svgedit.browser.supportsSelectors=function(){return v},svgedit.browser.supportsXpath=function(){return l},svgedit.browser.supportsPathReplaceItem=function(){return g},svgedit.browser.supportsPathInsertItemBefore=function(){return S},svgedit.browser.supportsPathBBox=function(){return b},svgedit.browser.supportsHVLineContainerBBox=function(){return h},svgedit.browser.supportsGoodTextCharPos=function(){return f},svgedit.browser.supportsEditableText=function(){return w},svgedit.browser.supportsGoodDecimals=function(){return E},svgedit.browser.supportsNonScalingStroke=function(){return G},svgedit.browser.supportsNativeTransformLists=function(){return N}}else window.location="browser-not-supported.html"}}}();
(function(){"use strict";function i(n){var t=n.matrix,i="",f,u,r;switch(n.type){case 1:i="matrix("+[t.a,t.b,t.c,t.d,t.e,t.f].join(",")+")";break;case 2:i="translate("+t.e+","+t.f+")";break;case 3:i=t.a==t.d?"scale("+t.a+")":"scale("+t.a+","+t.d+")";break;case 4:f=0;u=0;n.angle!=0&&(r=1-t.a,u=(r*t.f+t.b*t.e)/(r*r+t.b*t.b),f=(t.e-t.b*u)/r);i="rotate("+n.angle+" "+f+","+u+")"}return i}var t,n;svgedit.transformlist||(svgedit.transformlist={});t=document.createElementNS(svgedit.NS.SVG,"svg");n={};svgedit.transformlist.SVGTransformList=function(r){this._elem=r||null;this._xforms=[];this._update=function(){for(var r="",f=t.createSVGMatrix(),u,n=0;n<this.numberOfItems;++n)u=this._list.getItem(n),r+=i(u)+" ";this._elem.setAttribute("transform",r)};this._list=this;this._init=function(){var u=this._elem.getAttribute("transform"),e,r;if(u)for(e=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,r=!0;r;)if(r=u.match(e),u=u.replace(e,""),r&&r[1]){var l=r[1],h=l.split(/\s*\(/),i=h[0],o=h[1].match(/\s*(.*?)\s*\)/);o[1]=o[1].replace(/(\d)-/g,"$1 -");var f=o[1].split(/[, ]+/),a="abcdef".split(""),c=t.createSVGMatrix();$.each(f,function(n,t){f[n]=parseFloat(t);i=="matrix"&&(c[a[n]]=f[n])});var s=t.createSVGTransform(),v="set"+i.charAt(0).toUpperCase()+i.slice(1),n=i=="matrix"?[c]:f;i=="scale"&&n.length==1?n.push(n[0]):i=="translate"&&n.length==1?n.push(0):i=="rotate"&&n.length==1&&n.push(0,0);s[v].apply(s,n);this._list.appendItem(s)}};this._removeFromOtherLists=function(t){var u,f,r,i,e;if(t){u=!1;for(f in n){for(r=n[f],i=0,e=r._xforms.length;i<e;++i)if(r._xforms[i]==t){u=!0;r.removeItem(i);break}if(u)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(n){this.numberOfItems=1;this._removeFromOtherLists(n);this._xforms=[n]};this.getItem=function(n){if(n<this.numberOfItems&&n>=0)return this._xforms[n];throw{code:1};};this.insertItemBefore=function(n,t){var u=null,r,i,f;if(t>=0)if(t<this.numberOfItems){for(this._removeFromOtherLists(n),r=new Array(this.numberOfItems+1),i=0;i<t;++i)r[i]=this._xforms[i];for(r[i]=n,f=i+1;i<this.numberOfItems;++f,++i)r[f]=this._xforms[i];this.numberOfItems++;this._xforms=r;u=n;this._list._update()}else u=this._list.appendItem(n);return u};this.replaceItem=function(n,t){var i=null;return t<this.numberOfItems&&t>=0&&(this._removeFromOtherLists(n),this._xforms[t]=n,i=n,this._list._update()),i};this.removeItem=function(n){if(n<this.numberOfItems&&n>=0){for(var u=this._xforms[n],r=new Array(this.numberOfItems-1),i,t=0;t<n;++t)r[t]=this._xforms[t];for(i=t;i<this.numberOfItems-1;++i,++t)r[i]=this._xforms[t+1];return this.numberOfItems--,this._xforms=r,this._list._update(),u}throw{code:1};};this.appendItem=function(n){return this._removeFromOtherLists(n),this._xforms.push(n),this.numberOfItems++,this._list._update(),n}};svgedit.transformlist.resetListMap=function(){n={}};svgedit.transformlist.removeElementFromListMap=function(t){t.id&&n[t.id]&&delete n[t.id]};svgedit.transformlist.getTransformList=function(t){if(!svgedit.browser.supportsNativeTransformLists()){var i=t.id||"temp",r=n[i];return r&&i!=="temp"||(n[i]=new svgedit.transformlist.SVGTransformList(t),n[i]._init(),r=n[i]),r}return t.transform?t.transform.baseVal:t.gradientTransform?t.gradientTransform.baseVal:t.patternTransform?t.patternTransform.baseVal:null}})();
(function(){"use strict";var f;svgedit.units||(svgedit.units={});var i=svgedit.NS,r=["x","x1","cx","rx","width"],u=["y","y1","cy","ry","height"],e=["r","radius"].concat(r,u),n,t={};svgedit.units.init=function(r){var e,u,o,f;n=r;e=document.createElementNS(i.SVG,"svg");document.body.appendChild(e);u=document.createElementNS(i.SVG,"rect");u.setAttribute("width","1em");u.setAttribute("height","1ex");u.setAttribute("x","1in");e.appendChild(u);o=u.getBBox();document.body.removeChild(e);f=o.x;t={em:o.width,ex:o.height,"in":f,cm:f/2.54,mm:f/25.4,pt:f/72,pc:f/6,px:1,"%":0}};svgedit.units.getTypeMap=function(){return t};svgedit.units.shortFloat=function(t){var i=n.getRoundDigits();return isNaN(t)?$.isArray(t)?svgedit.units.shortFloat(t[0])+","+svgedit.units.shortFloat(t[1]):parseFloat(t).toFixed(i)-0:+(+t).toFixed(i)};svgedit.units.convertUnit=function(i,r){return r=r||n.getBaseUnit(),svgedit.units.shortFloat(i/t[r])};svgedit.units.setUnitAttr=function(n,t,i){n.setAttribute(t,i)};f={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(i){var c=i.tagName,s=n.getBaseUnit(),e=f[c],h,r,o,u;if(e)for(h=e.length,r=0;r<h;r++)o=e[r],u=i.getAttribute(o),u&&(isNaN(u)||i.setAttribute(o,u/t[s]+s))};svgedit.units.convertToNum=function(i,f){var e,o,s,h;return isNaN(f)?f.substr(-1)==="%"?(e=f.substr(0,f.length-1)/100,o=n.getWidth(),s=n.getHeight(),r.indexOf(i)>=0)?e*o:u.indexOf(i)>=0?e*s:e*Math.sqrt(o*o+s*s)/Math.sqrt(2):(h=f.substr(-2),e=f.substr(0,f.length-2),e*t[h]):+f};svgedit.units.isValidUnit=function(i,r,u){var f=!1,o,s;if(e.indexOf(i)>=0)isNaN(r)?(r=r.toLowerCase(),$.each(t,function(n){if(!f){var t=new RegExp("^-?[\\d\\.]+"+n+"$");t.test(r)&&(f=!0)}})):f=!0;else if(i=="id"){o=!1;try{s=n.getElement(r);o=s==null||s===u}catch(h){}return o}return f=!0}})();
(function(){"use strict";svgedit.math||(svgedit.math={});var n=1e-14,t=document.createElementNS(svgedit.NS.SVG,"svg");svgedit.math.transformPoint=function(n,t,i){return{x:i.a*n+i.c*t+i.e,y:i.b*n+i.d*t+i.f}};svgedit.math.isIdentity=function(n){return n.a===1&&n.b===0&&n.c===0&&n.d===1&&n.e===0&&n.f===0};svgedit.math.matrixMultiply=function(){for(var i=arguments,r=i.length,t=i[r-1],u;r-->1;)u=i[r-1],t=u.multiply(t);return Math.abs(t.a)<n&&(t.a=0),Math.abs(t.b)<n&&(t.b=0),Math.abs(t.c)<n&&(t.c=0),Math.abs(t.d)<n&&(t.d=0),Math.abs(t.e)<n&&(t.e=0),Math.abs(t.f)<n&&(t.f=0),t};svgedit.math.hasMatrixTransform=function(n){var t,i;if(!n)return!1;for(t=n.numberOfItems;t--;)if(i=n.getItem(t),i.type==1&&!svgedit.math.isIdentity(i.matrix))return!0;return!1};svgedit.math.transformBox=function(n,t,i,r,u){var h=svgedit.math.transformPoint,f=h(n,t,u),e=h(n+i,t,u),o=h(n,t+r,u),s=h(n+i,t+r,u),c=Math.min(f.x,e.x,o.x,s.x),a=Math.max(f.x,e.x,o.x,s.x),l=Math.min(f.y,e.y,o.y,s.y),v=Math.max(f.y,e.y,o.y,s.y);return{tl:f,tr:e,bl:o,br:s,aabox:{x:c,y:l,width:a-c,height:v-l}}};svgedit.math.transformListToTransform=function(n,i,r){var e,f,u,o;if(n==null)return t.createSVGTransformFromMatrix(t.createSVGMatrix());for(i=i||0,r=r||n.numberOfItems-1,i=parseInt(i,10),r=parseInt(r,10),i>r&&(e=r,r=i,i=e),f=t.createSVGMatrix(),u=i;u<=r;++u)o=u>=0&&u<n.numberOfItems?n.getItem(u).matrix:t.createSVGMatrix(),f=svgedit.math.matrixMultiply(f,o);return t.createSVGTransformFromMatrix(f)};svgedit.math.getMatrix=function(n){var t=svgedit.transformlist.getTransformList(n);return svgedit.math.transformListToTransform(t).matrix};svgedit.math.snapToAngle=function(n,t,i,r){var o=Math.PI/4,u=i-n,f=r-t,h=Math.atan2(f,u),s=Math.sqrt(u*u+f*f),e=Math.round(h/o)*o;return{x:n+s*Math.cos(e),y:t+s*Math.sin(e),a:e}};svgedit.math.rectsIntersect=function(n,t){return t.x<n.x+n.width&&t.x+t.width>n.x&&t.y<n.y+n.height&&t.y+t.height>n.y}})();
var mysvgutils=function(t){"use strict";return{initSvgutils:function(){function e(t){if(svgedit.browser.supportsHVLineContainerBBox())try{return t.getBBox()}catch(t){}var e,i,r=$.data(t,"ref"),n=null;r?(i=$(r).children().clone().attr("visibility","hidden"),$(a).append(i),n=i.filter("line, path")):n=$(t).find("line, path");var s=!1;if(n.length)if(n.each(function(){var t=this.getBBox();t.width&&t.height||(s=!0)}),s){var o=r?i:$(t).children();e=getStrokedBBox(o)}else e=t.getBBox();else e=t.getBBox();return r&&i.remove(),e}svgedit.utilities||(svgedit.utilities={});var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=svgedit.NS,n="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",s=n.split(","),o=null,u=null,l=null,a=null;svgedit.utilities.init=function(t){o=t,u=t.getDOMDocument(),l=t.getDOMContainer(),a=t.getSVGRoot()},svgedit.utilities.toXml=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/,"&#x27;")},svgedit.utilities.fromXml=function(t){return $("<p/>").html(t).text()},svgedit.utilities.encode64=function(t){if(t=svgedit.utilities.encodeUTF8(t),window.btoa)return window.btoa(t);var e,r,n,s,o,u,l,a=[];a.length=4*Math.floor((t.length+2)/3);var g=0,d=0;do{e=t.charCodeAt(g++),r=t.charCodeAt(g++),n=t.charCodeAt(g++),s=e>>2,o=(3&e)<<4|r>>4,u=(15&r)<<2|n>>6,l=63&n,isNaN(r)?u=l=64:isNaN(n)&&(l=64),a[d++]=i.charAt(s),a[d++]=i.charAt(o),a[d++]=i.charAt(u),a[d++]=i.charAt(l)}while(g<t.length);return a.join("")},svgedit.utilities.decode64=function(t){if(window.atob)return svgedit.utilities.decodeUTF8(window.atob(t));var e,r,n,s,o,u="",l="",a="",g=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{n=i.indexOf(t.charAt(g++)),s=i.indexOf(t.charAt(g++)),o=i.indexOf(t.charAt(g++)),a=i.indexOf(t.charAt(g++)),e=n<<2|s>>4,r=(15&s)<<4|o>>2,l=(3&o)<<6|a,u+=String.fromCharCode(e),64!=o&&(u+=String.fromCharCode(r)),64!=a&&(u+=String.fromCharCode(l)),e=r=l="",n=s=o=a=""}while(g<t.length);return svgedit.utilities.decodeUTF8(u)},svgedit.utilities.decodeUTF8=function(t){return decodeURIComponent(escape(t))},svgedit.utilities.encodeUTF8=function(t){return unescape(encodeURIComponent(t))},svgedit.utilities.convertToXMLReferences=function(t){var e,i="";for(e=0;e<t.length;e++){var r=t.charCodeAt(e);r<128?i+=t[e]:r>127&&(i+="&#"+r+";")}return i},svgedit.utilities.text2xml=function(t){var e,i;t.indexOf("<svg:svg")>=0&&(t=t.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns"));try{i=window.DOMParser?new DOMParser:new ActiveXObject("Microsoft.XMLDOM"),i.async=!1}catch(t){throw new Error("XML Parser could not be instantiated")}try{e=i.loadXML?!!i.loadXML(t)&&i:i.parseFromString(t,"text/xml")}catch(t){throw new Error("Error parsing XML string")}return e},svgedit.utilities.bboxToObj=function(t){return{x:t.x,y:t.y,width:t.width,height:t.height}},svgedit.utilities.walkTree=function(t,e){if(t&&1==t.nodeType){e(t);for(var i=t.childNodes.length;i--;)svgedit.utilities.walkTree(t.childNodes.item(i),e)}},svgedit.utilities.walkTreePost=function(t,e){if(t&&1==t.nodeType){for(var i=t.childNodes.length;i--;)svgedit.utilities.walkTree(t.childNodes.item(i),e);e(t)}},svgedit.utilities.getUrlFromAttr=function(t){if(t){if(0===t.indexOf('url("'))return t.substring(5,t.indexOf('"',6));if(0===t.indexOf("url('"))return t.substring(5,t.indexOf("'",6));if(0===t.indexOf("url("))return t.substring(4,t.indexOf(")"))}return null},svgedit.utilities.getHref=function(t){return t.getAttributeNS(r.XLINK,"href")},svgedit.utilities.setHref=function(t,e){t.setAttributeNS(r.XLINK,"xlink:href",e)},svgedit.utilities.findDefs=function(){var t=o.getSVGContent(),e=t.getElementsByTagNameNS(r.SVG,"defs");return e.length>0?e=e[0]:(e=t.ownerDocument.createElementNS(r.SVG,"defs"),t.firstChild?t.insertBefore(e,t.firstChild.nextSibling):t.appendChild(e)),e},svgedit.utilities.getPathBBox=function(e){var i,r=e.pathSegList,n=r.numberOfItems,s=[[],[]],o=r.getItem(0),u=[o.x,o.y];for(i=0;i<n;i++){var l=r.getItem(i);if(l.x!==t)if(s[0].push(u[0]),s[1].push(u[1]),l.x1){var a,g=[l.x1,l.y1],d=[l.x2,l.y2],c=[l.x,l.y];for(a=0;a<2;a++){var f=function(t){return Math.pow(1-t,3)*u[a]+3*Math.pow(1-t,2)*t*g[a]+3*(1-t)*Math.pow(t,2)*d[a]+Math.pow(t,3)*c[a]},v=6*u[a]-12*g[a]+6*d[a],h=-3*u[a]+9*g[a]-9*d[a]+3*c[a],p=3*g[a]-3*u[a];if(0!=h){var x=Math.pow(v,2)-4*p*h;if(!(x<0)){var m=(-v+Math.sqrt(x))/(2*h);0<m&&m<1&&s[a].push(f(m));var b=(-v-Math.sqrt(x))/(2*h);0<b&&b<1&&s[a].push(f(b))}}else{if(0==v)continue;var w=-p/v;0<w&&w<1&&s[a].push(f(w))}}u=c}else s[0].push(l.x),s[1].push(l.y)}var B=Math.min.apply(null,s[0]),y=Math.max.apply(null,s[0])-B,A=Math.min.apply(null,s[1]),M=Math.max.apply(null,s[1])-A;return{x:B,y:A,width:y,height:M}},svgedit.utilities.getBBox=function(t){var i=t||o.geSelectedElements()[0];if(1!=t.nodeType)return null;var r=null,n=i.nodeName;switch(n){case"text":""===i.textContent?(i.textContent="a",r=i.getBBox(),i.textContent=""):i.getBBox&&(r=i.getBBox());break;case"path":svgedit.browser.supportsPathBBox()?i.getBBox&&(r=i.getBBox()):r=svgedit.utilities.getPathBBox(i);break;case"g":case"a":r=e(i);break;default:if("use"===n&&(r=e(i,!0)),"use"===n||"foreignObject"===n&&svgedit.browser.isWebkit()){r||(r=i.getBBox());var u={};u.width=r.width,u.height=r.height,u.x=r.x+parseFloat(i.getAttribute("x")||0),u.y=r.y+parseFloat(i.getAttribute("y")||0),r=u}else if(~s.indexOf(n))if(i)r=i.getBBox();else{var l=$(i).closest("foreignObject");l.length&&l[0].getBBox&&(r=l[0].getBBox())}}return r&&(r=svgedit.utilities.bboxToObj(r)),r},svgedit.utilities.getRotationAngle=function(t,e){var i=t||o.getSelectedElements()[0],r=svgedit.transformlist.getTransformList(i);if(!r)return 0;var n,s=r.numberOfItems;for(n=0;n<s;++n){var u=r.getItem(n);if(4==u.type)return e?u.angle*Math.PI/180:u.angle}return 0},svgedit.utilities.getRefElem=function(t){return svgedit.utilities.getElem(svgedit.utilities.getUrlFromAttr(t).substr(1))},svgedit.browser.supportsSelectors()?svgedit.utilities.getElem=function(t){return a.querySelector("#"+t)}:svgedit.browser.supportsXpath()?svgedit.utilities.getElem=function(t){return u.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+t+'"]',l,function(){return svgedit.NS.SVG},9,null).singleNodeValue}:svgedit.utilities.getElem=function(t){return $(a).find("[id="+t+"]")[0]},svgedit.utilities.assignAttributes=function(t,e,i,n){var s;for(s in e){var o="xml:"===s.substr(0,4)?r.XML:"xlink:"===s.substr(0,6)?r.XLINK:null;svgedit.utilities.isNullish(e[s])?o?t.removeAttributeNS(o,s):t.removeAttribute(s):o?t.setAttributeNS(o,s,e[s]):n?svgedit.units.setUnitAttr(t,s,e[s]):t.setAttribute(s,e[s])}},svgedit.utilities.cleanupElement=function(t){var e,i={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0};for(e in i){var r=i[e];t.getAttribute(e)==r&&t.removeAttribute(e)}},svgedit.utilities.snapToGrid=function(t){var e=o.getSnappingStep(),i=o.getBaseUnit();return"px"!==i&&(e*=svgedit.units.getTypeMap()[i]),t=Math.round(t/e)*e,t},svgedit.utilities.preg_quote=function(t,e){return String(t).replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(e||"")+"-]","g"),"\\$&")},svgedit.utilities.executeAfterLoads=function(t,e,i){return function(){function r(){i.apply(null,n)}var n=arguments;window[t]?r():e.reduceRight(function(t,e){return function(){$.getScript(e,t)}},r)()}},svgedit.utilities.buildCanvgCallback=function(t){return svgedit.utilities.executeAfterLoads("canvg",["canvg/rgbcolor.js","canvg/canvg.js"],t)},svgedit.utilities.buildJSPDFCallback=function(e){return svgedit.utilities.executeAfterLoads("RGBColor",["canvg/rgbcolor.js"],function(){var i=[];RGBColor&&RGBColor.ok!==t||i.push("canvg/rgbcolor.js"),svgedit.utilities.executeAfterLoads("jsPDF",i.concat("jspdf/underscore-min.js","jspdf/jspdf.min.js","jspdf/jspdf.plugin.svgToPdf.js"),e)()})},svgedit.utilities.takePil=function(){var t=new Date,e=t.getFullYear(),i=t.getDay();Math.floor(3*Math.random());return e%2>0&&Math.floor(i/2),!0},svgedit.utilities.isNullish=function(t){return null==t}}}}(mysvgutils||{});
(function(){"use strict";svgedit.history||(svgedit.history={}),svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(t,e,i,n){this.elem=t,this.text=n?"Move "+t.tagName+" to "+n:"Move "+t.tagName,this.oldNextSibling=e,this.oldParent=i,this.newNextSibling=t.nextSibling,this.newParent=t.parentNode},svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"},svgedit.history.MoveElementCommand.prototype.type=svgedit.history.MoveElementCommand.type,svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text},svgedit.history.MoveElementCommand.prototype.apply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.MoveElementCommand.prototype.unapply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.InsertElementCommand=function(t,e){this.elem=t,this.text=e||"Create "+t.tagName,this.parent=t.parentNode,this.nextSibling=this.elem.nextSibling},svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"},svgedit.history.InsertElementCommand.prototype.type=svgedit.history.InsertElementCommand.type,svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text},svgedit.history.InsertElementCommand.prototype.apply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.parent.insertBefore(this.elem,this.nextSibling),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.InsertElementCommand.prototype.unapply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),this.parent=this.elem.parentNode,this.elem=this.elem.parentNode.removeChild(this.elem),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.RemoveElementCommand=function(t,e,i,n){this.elem=t,this.text=n||"Delete "+t.tagName,this.nextSibling=e,this.parent=i,svgedit.transformlist.removeElementFromListMap(t)},svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"},svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type,svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text},svgedit.history.RemoveElementCommand.prototype.apply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),svgedit.transformlist.removeElementFromListMap(this.elem),this.parent=this.elem.parentNode,this.elem=this.parent.removeChild(this.elem),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.RemoveElementCommand.prototype.unapply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),svgedit.transformlist.removeElementFromListMap(this.elem),null==this.nextSibling&&window.console&&console.log("Error: reference element was lost"),this.parent.insertBefore(this.elem,this.nextSibling),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.ChangeElementCommand=function(t,e,i){this.elem=t,this.text=i?"Change "+t.tagName+" "+i:"Change "+t.tagName,this.newValues={},this.oldValues=e;var n;for(n in e)"#text"==n?this.newValues[n]=t.textContent:"#href"==n?this.newValues[n]=svgedit.utilities.getHref(t):this.newValues[n]=t.getAttribute(n)},svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"},svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type,svgedit.history.ChangeElementCommand.prototype.getText=function(){return this.text},svgedit.history.ChangeElementCommand.prototype.apply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var e,i=!1;for(e in this.newValues)this.newValues[e]?"#text"==e?this.elem.textContent=this.newValues[e]:"#href"==e?svgedit.utilities.setHref(this.elem,this.newValues[e]):this.elem.setAttribute(e,this.newValues[e]):"#text"==e?this.elem.textContent="":(this.elem.setAttribute(e,""),this.elem.removeAttribute(e)),"transform"==e&&(i=!0);if(!i){var n=svgedit.utilities.getRotationAngle(this.elem);if(n){var s=elem.getBBox(),o=s.x+s.width/2,r=s.y+s.height/2,h=["rotate(",n," ",o,",",r,")"].join("");h!=elem.getAttribute("transform")&&elem.setAttribute("transform",h)}}return t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this),!0},svgedit.history.ChangeElementCommand.prototype.unapply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var e,i=!1;for(e in this.oldValues)this.oldValues[e]?"#text"==e?this.elem.textContent=this.oldValues[e]:"#href"==e?svgedit.utilities.setHref(this.elem,this.oldValues[e]):this.elem.setAttribute(e,this.oldValues[e]):"#text"==e?this.elem.textContent="":this.elem.removeAttribute(e),"transform"==e&&(i=!0);if(!i){var n=svgedit.utilities.getRotationAngle(this.elem);if(n){var s=elem.getBBox(),o=s.x+s.width/2,r=s.y+s.height/2,h=["rotate(",n," ",o,",",r,")"].join("");h!=elem.getAttribute("transform")&&elem.setAttribute("transform",h)}}return svgedit.transformlist.removeElementFromListMap(this.elem),t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this),!0},svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.BatchCommand=function(t){this.text=t||"Batch Command",this.stack=[]},svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"},svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type,svgedit.history.BatchCommand.prototype.getText=function(){return this.text},svgedit.history.BatchCommand.prototype.apply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var e,i=this.stack.length;for(e=0;e<i;++e)this.stack[e].apply(t);t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.BatchCommand.prototype.unapply=function(t){t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var e;for(e=this.stack.length-1;e>=0;e--)this.stack[e].unapply(t);t&&t.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.BatchCommand.prototype.elements=function(){for(var t=[],e=this.stack.length;e--;)for(var i=this.stack[e].elements(),n=i.length;n--;)t.indexOf(i[n])==-1&&t.push(i[n]);return t},svgedit.history.BatchCommand.prototype.addSubCommand=function(t){this.stack.push(t)},svgedit.history.BatchCommand.prototype.isEmpty=function(){return 0===this.stack.length},svgedit.history.UndoManager=function(t){this.handler_=t||null,this.undoStackPointer=0,this.undoStack=[],this.undoChangeStackPointer=-1,this.undoableChangeStack=[]},svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[],this.undoStackPointer=0},svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer},svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer},svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():""},svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""},svgedit.history.UndoManager.prototype.undo=function(){if(this.undoStackPointer>0){var t=this.undoStack[--this.undoStackPointer];t.unapply(this.handler_)}},svgedit.history.UndoManager.prototype.redo=function(){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0){var t=this.undoStack[this.undoStackPointer++];t.apply(this.handler_)}},svgedit.history.UndoManager.prototype.addCommandToHistory=function(t){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&(this.undoStack=this.undoStack.splice(0,this.undoStackPointer)),this.undoStack.push(t),this.undoStackPointer=this.undoStack.length},svgedit.history.UndoManager.prototype.beginUndoableChange=function(t,e){for(var i=++this.undoChangeStackPointer,n=e.length,s=new Array(n),o=new Array(n);n--;){var r=e[n];null!=r&&(o[n]=r,s[n]=r.getAttribute(t))}this.undoableChangeStack[i]={attrName:t,oldValues:s,elements:o}},svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var t=this.undoChangeStackPointer--,e=this.undoableChangeStack[t],i=e.elements.length,n=e.attrName,s=new svgedit.history.BatchCommand("Change "+n);i--;){var o=e.elements[i];if(null!=o){var r={};r[n]=e.oldValues[i],r[n]!=o.getAttribute(n)&&s.addSubCommand(new svgedit.history.ChangeElementCommand(o,r,n))}}return this.undoableChangeStack[t]=null,s}})();
(function(){"use strict";svgedit.sanitize||(svgedit.sanitize={});var e=svgedit.NS,t=svgedit.getReverseNS(),i={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class","clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters","filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["type","class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","font-family","font-size","font-style","font-weight","text-anchor"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x","y"],metadata:["class","id"],path:["type","class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se","xmlns:xlink","y"],switch:["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],input:["class","id","type","style","value"],INPUT:["class","id","type","style","value"],select:["class","id","type","style"],SELECT:["class","id","type","style"],option:["value","text"],OPTION:["value","text"],button:["class","color","style","id"],BUTTON:["class","color","style","id"],span:["class","color","style","id"],SPAN:["class","color","style","id"],div:["class","style","id"],DIV:["class","style","id"],label:["class","style","id"],LABEL:["class","style","id"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],semantics:[]},s={};$.each(i,function(t,i){var r={};$.each(i,function(t,i){if(i.indexOf(":")>=0){var s=i.split(":");r[s[1]]=e[s[0].toUpperCase()]}else r[i]="xmlns"==i?e.XMLNS:null}),s[t]=r}),svgedit.sanitize.sanitizeSvg=function(r){if(3==r.nodeType&&(r.nodeValue=r.nodeValue.replace(/^\s+|\s+$/g,""),0===r.nodeValue.length&&r.parentNode.removeChild(r)),1==r.nodeType){var a=r.ownerDocument,l=r.parentNode;if(a&&l){var o=i[r.nodeName],n=s[r.nodeName];if(void 0!==o){if("foreignObject"===l.nodeName||l.parentNode&&"foreignObject"===l.parentNode.nodeName){for(var d=document.createElement(r.tagName),c=r.attributes.length;c--;){var m=r.attributes.item(c);d.setAttribute(m.nodeName,m.value)}d.innerHTML=r.innerHTML,l.removeChild(r),l.appendChild(d),r=d}var f=[];for(c=r.attributes.length;c--;){m=r.attributes.item(c);var p=m.nodeName,y=m.localName,k=m.namespaceURI;if(n.hasOwnProperty(y)&&k==n[y]&&k!=e.XMLNS||k==e.XMLNS&&t[m.value]||(0===p.indexOf("se:")&&f.push([p,m.value]),r.removeAttributeNS(k,y)),svgedit.browser.isGecko())switch(p){case"transform":case"gradientTransform":case"patternTransform":var u=m.value.replace(/(\d)-/g,"$1 -");r.setAttribute(p,u)}if("style"==p&&"foreignObject"!==l.nodeName){for(var h=m.value.split(";"),g=h.length;g--;){var v=h[g].split(":"),x=$.trim(v[0]),w=$.trim(v[1]);o.indexOf(x)>=0&&r.setAttribute(x,w)}r.removeAttribute("style")}}$.each(f,function(t,i){r.setAttributeNS(e.SE,i[0],i[1])});var L=svgedit.utilities.getHref(r);if(L&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(r.nodeName)>=0&&"#"!=L[0]&&(svgedit.utilities.setHref(r,""),r.removeAttributeNS(e.XLINK,"href")),"use"==r.nodeName&&!svgedit.utilities.getHref(r))return void l.removeChild(r);for($.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(e,t){var i=r.getAttribute(t);i&&(i=svgedit.utilities.getUrlFromAttr(i),i&&"#"!==i[0]&&(r.setAttribute(t,""),r.removeAttribute(t)))}),c=r.childNodes.length;c--;)svgedit.sanitize.sanitizeSvg(r.childNodes.item(c))}else{for(var N=[];r.hasChildNodes();)N.push(l.insertBefore(r.firstChild,r));for(l.removeChild(r),c=N.length;c--;)svgedit.sanitize.sanitizeSvg(N[c])}}}}})();
var svgedit=svgedit||{};(function(){"use strict";svgedit.coords||(svgedit.coords={});var t=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],n=null;svgedit.coords.init=function(t){n=t};svgedit.coords.remapElement=function(i,r,u){for(var v,h=function(n,t){return svgedit.math.transformPoint(n,t,u)},p=function(n){return u.a*n},w=function(n){return u.d*n},kt=n.getGridSnapping()&&i.parentNode.parentNode.localName==="svg",tt=function(){var n;if(kt)for(n in r)r[n]=svgedit.utilities.snapToGrid(r[n]);svgedit.utilities.assignAttributes(i,r,1e3,!0)},it=svgedit.utilities.getBBox(i),rt,lt,o,at,vt,yt,pt,b,y,k,ft,et,d,s,a,g,c,ot,st,f,ht,ct,nt,wt,bt,l,e=0;e<2;e++)v=e===0?"fill":"stroke",rt=i.getAttribute(v),rt&&rt.indexOf("url(")===0&&(u.a<0||u.d<0)&&(lt=svgedit.utilities.getRefElem(rt),o=lt.cloneNode(!0),u.a<0&&(at=o.getAttribute("x1"),vt=o.getAttribute("x2"),o.setAttribute("x1",-(at-1)),o.setAttribute("x2",-(vt-1))),u.d<0&&(yt=o.getAttribute("y1"),pt=o.getAttribute("y2"),o.setAttribute("y1",-(yt-1)),o.setAttribute("y2",-(pt-1))),o.id=n.getDrawing().getNextId(),svgedit.utilities.findDefs().appendChild(o),i.setAttribute(v,"url(#"+o.id+")"));b=i.tagName;(b==="g"||b==="text"||b=="tspan"||b==="use")&&(u.a==1&&u.b==0&&u.c==0&&u.d==1&&(u.e!=0||u.f!=0)?(ft=svgedit.math.transformListToTransform(i).matrix,et=svgedit.math.matrixMultiply(ft.inverse(),u,ft),r.x=parseFloat(r.x)+et.e,r.y=parseFloat(r.y)+et.f):(y=svgedit.transformlist.getTransformList(i),k=svgroot.createSVGTransform(),k.setMatrix(svgedit.math.matrixMultiply(svgedit.math.transformListToTransform(y).matrix,u)),y.clear(),y.appendItem(k)));switch(b){case"foreignObject":case"rect":case"image":b==="image"&&(u.a<0||u.d<0)?(y=svgedit.transformlist.getTransformList(i),k=svgroot.createSVGTransform(),k.setMatrix(svgedit.math.matrixMultiply(svgedit.math.transformListToTransform(y).matrix,u)),y.clear(),y.appendItem(k)):(a=h(r.x,r.y),r.width=p(r.width),r.height=w(r.height),r.x=a.x+Math.min(0,r.width),r.y=a.y+Math.min(0,r.height),r.width=Math.abs(r.width),r.height=Math.abs(r.height));tt();break;case"ellipse":d=h(r.cx,r.cy);r.cx=d.x;r.cy=d.y;r.rx=p(r.rx);r.ry=w(r.ry);r.rx=Math.abs(r.rx);r.ry=Math.abs(r.ry);tt();break;case"circle":d=h(r.cx,r.cy);r.cx=d.x;r.cy=d.y;var ut=svgedit.math.transformBox(it.x,it.y,it.width,it.height,u),dt=ut.tr.x-ut.tl.x,gt=ut.bl.y-ut.tl.y;r.r=Math.min(dt/2,gt/2);r.r&&(r.r=Math.abs(r.r));tt();break;case"line":a=h(r.x1,r.y1);g=h(r.x2,r.y2);r.x1=a.x;r.y1=a.y;r.x2=g.x;r.y2=g.y;case"text":case"tspan":case"use":tt();break;case"g":ot=$(i).data("gsvg");ot&&svgedit.utilities.assignAttributes(ot,r,1e3,!0);break;case"polyline":case"polygon":for(c=r.points.length,e=0;e<c;++e)s=r.points[e],s=h(s.x,s.y),r.points[e].x=s.x,r.points[e].y=s.y;for(c=r.points.length,st="",e=0;e<c;++e)s=r.points[e],st+=s.x+","+s.y+" ";i.setAttribute("points",st);break;case"path":for(ht=i.pathSegList,c=ht.numberOfItems,r.d=[],e=0;e<c;++e)f=ht.getItem(e),r.d[e]={type:f.pathSegType,x:f.x,y:f.y,x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,r1:f.r1,r2:f.r2,angle:f.angle,largeArcFlag:f.largeArcFlag,sweepFlag:f.sweepFlag};for(c=r.d.length,ct=r.d[0],nt=h(ct.x,ct.y),r.d[0].x=nt.x,r.d[0].y=nt.y,e=1;e<c;++e)f=r.d[e],v=f.type,v%2==0?(wt=f.x!=undefined?f.x:nt.x,bt=f.y!=undefined?f.y:nt.y,s=h(wt,bt),a=h(f.x1,f.y1),g=h(f.x2,f.y2),f.x=s.x,f.y=s.y,f.x1=a.x,f.y1=a.y,f.x2=g.x,f.y2=g.y,f.r1=p(f.r1),f.r2=w(f.r2)):(f.x=p(f.x),f.y=w(f.y),f.x1=p(f.x1),f.y1=w(f.y1),f.x2=p(f.x2),f.y2=w(f.y2),f.r1=p(f.r1),f.r2=w(f.r2));for(l="",c=r.d.length,e=0;e<c;++e){f=r.d[e];v=f.type;l+=t[v];switch(v){case 13:case 12:l+=f.x+" ";break;case 15:case 14:l+=f.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:l+=f.x+","+f.y+" ";break;case 7:case 6:l+=f.x1+","+f.y1+" "+f.x2+","+f.y2+" "+f.x+","+f.y+" ";break;case 9:case 8:l+=f.x1+","+f.y1+" "+f.x+","+f.y+" ";break;case 11:case 10:l+=f.r1+","+f.r2+" "+f.angle+" "+ +f.largeArcFlag+" "+ +f.sweepFlag+" "+f.x+","+f.y+" ";break;case 17:case 16:l+=f.x2+","+f.y2+" "+f.x+","+f.y+" "}}i.setAttribute("d",l)}}})();
var svgedit=svgedit||{};(function(){svgedit.recalculate||(svgedit.recalculate={});var t,e=svgedit.NS;svgedit.recalculate.init=function(e){t=e},svgedit.recalculate.updateClipPath=function(e,r,a){var s=getRefElem(e).firstChild,i=svgedit.transformlist.getTransformList(s),m=t.getSVGRoot().createSVGTransform();m.setTranslate(r,a),i.appendItem(m),svgedit.recalculate.recalculateDimensions(s)},svgedit.recalculate.recalculateDimensions=function(r){if(null==r)return null;if("svg"==r.nodeName&&navigator.userAgent.indexOf("Firefox/20")>=0)return null;var a,s=t.getSVGRoot(),i=svgedit.transformlist.getTransformList(r);if(i&&i.numberOfItems>0){for(a=i.numberOfItems;a--;){var m=i.getItem(a);0===m.type?i.removeItem(a):1===m.type?svgedit.math.isIdentity(m.matrix)&&i.removeItem(a):4===m.type&&0===m.angle&&i.removeItem(a)}if(1===i.numberOfItems&&svgedit.utilities.getRotationAngle(r))return null}if(!i||0==i.numberOfItems)return r.setAttribute("transform",""),r.removeAttribute("transform"),null;if(i){a=i.numberOfItems;for(var n=[];a--;){var m=i.getItem(a);1===m.type?n.push([m.matrix,a]):n.length&&(n=[])}if(2===n.length){var o=s.createSVGTransformFromMatrix(svgedit.math.matrixMultiply(n[1][0],n[0][0]));i.removeItem(n[0][1]),i.removeItem(n[1][1]),i.insertItemBefore(o,n[1][1])}if(a=i.numberOfItems,a>=2&&1===i.getItem(a-2).type&&2===i.getItem(a-1).type){var f=s.createSVGTransform(),v=svgedit.math.matrixMultiply(i.getItem(a-2).matrix,i.getItem(a-1).matrix);f.setMatrix(v),i.removeItem(a-2),i.removeItem(a-2),i.appendItem(f)}}switch(r.tagName){case"line":case"polyline":case"polygon":case"path":break;default:if(1===i.numberOfItems&&1===i.getItem(0).type||2===i.numberOfItems&&1===i.getItem(0).type&&4===i.getItem(0).type)return null}var g=$(r).data("gsvg"),l=new svgedit.history.BatchCommand("Transform"),d={},u=null,c=[];switch(r.tagName){case"line":c=["x1","y1","x2","y2"];break;case"circle":c=["cx","cy","r"];break;case"ellipse":c=["cx","cy","rx","ry"];break;case"foreignObject":case"rect":case"image":c=["width","height","x","y"];break;case"use":case"text":case"tspan":c=["x","y"];break;case"polygon":case"polyline":u={},u.points=r.getAttribute("points");var p=r.points,I=p.numberOfItems;d.points=new Array(I);var x;for(x=0;x<I;++x){var h=p.getItem(x);d.points[x]={x:h.x,y:h.y}}break;case"path":u={},u.d=r.getAttribute("d"),d.d=r.getAttribute("d")}if(c.length?(d=$(r).attr(c),$.each(d,function(t,e){d[t]=svgedit.units.convertToNum(t,e)})):g&&(d={x:$(g).attr("x")||0,y:$(g).attr("y")||0}),null==u&&(u=$.extend(!0,{},d),$.each(u,function(t,e){u[t]=svgedit.units.convertToNum(t,e)})),u.transform=t.getStartTransform()||"","g"==r.tagName&&!g||"a"==r.tagName){var T=svgedit.utilities.getBBox(r),y={x:T.x+T.width/2,y:T.y+T.height/2},b=svgedit.math.transformPoint(T.x+T.width/2,T.y+T.height/2,svgedit.math.transformListToTransform(i).matrix),v=s.createSVGMatrix(),S=svgedit.utilities.getRotationAngle(r);if(S){var M=S*Math.PI/180;if(Math.abs(M)>1e-10)var O=Math.sin(M)/(1-Math.cos(M));else var O=2/M;var x;for(x=0;x<i.numberOfItems;++x){var m=i.getItem(x);if(4==m.type){var A=m.matrix;y.y=(O*A.e+A.f)/2,y.x=(A.e-O*A.f)/2,i.removeItem(x);break}}}var G=0,V=0,L=0,N=i.numberOfItems;if(N)var B=i.getItem(0).matrix;if(N>=3&&3==i.getItem(N-2).type&&2==i.getItem(N-3).type&&2==i.getItem(N-1).type){L=3;for(var R=i.getItem(N-3).matrix,w=i.getItem(N-2).matrix,k=i.getItem(N-1).matrix,C=r.childNodes,D=C.length;D--;){var E=C.item(D);if(G=0,V=0,1==E.nodeType){var P=svgedit.transformlist.getTransformList(E);if(!P)continue;var v=svgedit.math.transformListToTransform(P).matrix,j=svgedit.utilities.getRotationAngle(E),F=t.getStartTransform(),U=[];if(t.setStartTransform(E.getAttribute("transform")),j||svgedit.math.hasMatrixTransform(P)){var H=s.createSVGTransform();H.setMatrix(svgedit.math.matrixMultiply(R,w,k,v)),P.clear(),P.appendItem(H),U.push(H)}else{var W=svgedit.math.matrixMultiply(v.inverse(),k,v),q=s.createSVGMatrix();q.e=-W.e,q.f=-W.f;var z=svgedit.math.matrixMultiply(q.inverse(),v.inverse(),R,w,k,v,W.inverse()),J=s.createSVGTransform(),K=s.createSVGTransform(),Q=s.createSVGTransform();J.setTranslate(W.e,W.f),K.setScale(z.a,z.d),Q.setTranslate(q.e,q.f),P.appendItem(Q),P.appendItem(K),P.appendItem(J),U.push(Q),U.push(K),U.push(J)}l.addSubCommand(svgedit.recalculate.recalculateDimensions(E)),t.setStartTransform(F)}}i.removeItem(N-1),i.removeItem(N-2),i.removeItem(N-3)}else if(N>=3&&1==i.getItem(N-1).type){L=3,v=svgedit.math.transformListToTransform(i).matrix;var H=s.createSVGTransform();H.setMatrix(v),i.clear(),i.appendItem(H)}else if((1==N||N>1&&3!=i.getItem(1).type)&&2==i.getItem(0).type){L=2;var X=svgedit.math.transformListToTransform(i).matrix;i.removeItem(0);var Y=svgedit.math.transformListToTransform(i).matrix.inverse(),Z=svgedit.math.matrixMultiply(Y,X);if(G=Z.e,V=Z.f,0!=G||0!=V){for(var C=r.childNodes,D=C.length,_=[];D--;){var E=C.item(D);if(1==E.nodeType){if(E.getAttribute("clip-path")){var tt=E.getAttribute("clip-path");_.indexOf(tt)===-1&&(svgedit.recalculate.updateClipPath(tt,G,V),_.push(tt))}var F=t.getStartTransform();t.setStartTransform(E.getAttribute("transform"));var P=svgedit.transformlist.getTransformList(E);if(P){var et=s.createSVGTransform();et.setTranslate(G,V),P.numberOfItems?P.insertItemBefore(et,0):P.appendItem(et),l.addSubCommand(svgedit.recalculate.recalculateDimensions(E));for(var rt=r.getElementsByTagNameNS(e.SVG,"use"),at="#"+E.id,st=rt.length;st--;){var it=rt.item(st);if(at==svgedit.utilities.getHref(it)){var mt=s.createSVGTransform();mt.setTranslate(-G,-V),svgedit.transformlist.getTransformList(it).insertItemBefore(mt,0),l.addSubCommand(svgedit.recalculate.recalculateDimensions(it))}}t.setStartTransform(F)}}}_=[],t.setStartTransform(F)}}else{if(1!=N||1!=i.getItem(0).type||S){if(S){var nt=s.createSVGTransform();nt.setRotate(S,b.x,b.y),i.numberOfItems?i.insertItemBefore(nt,0):i.appendItem(nt)}return 0==i.numberOfItems&&r.removeAttribute("transform"),null}L=1;for(var v=i.getItem(0).matrix,C=r.childNodes,D=C.length;D--;){var E=C.item(D);if(1==E.nodeType){var F=t.getStartTransform();t.setStartTransform(E.getAttribute("transform"));var P=svgedit.transformlist.getTransformList(E);if(!P)continue;var ot=svgedit.math.matrixMultiply(v,svgedit.math.transformListToTransform(P).matrix),ft=s.createSVGTransform();ft.setMatrix(ot),P.clear(),P.appendItem(ft,0),l.addSubCommand(svgedit.recalculate.recalculateDimensions(E)),t.setStartTransform(F);var vt=E.getAttribute("stroke-width");if("none"!==E.getAttribute("stroke")&&!isNaN(vt)){var gt=(Math.abs(ot.a)+Math.abs(ot.d))/2;E.setAttribute("stroke-width",vt*gt)}}}i.clear()}if(2==L){if(S){b={x:y.x+B.e,y:y.y+B.f};var nt=s.createSVGTransform();nt.setRotate(S,b.x,b.y),i.numberOfItems?i.insertItemBefore(nt,0):i.appendItem(nt)}}else if(3==L){var v=svgedit.math.transformListToTransform(i).matrix,lt=s.createSVGTransform();lt.setRotate(S,y.x,y.y);var dt=lt.matrix,ut=s.createSVGTransform();ut.setRotate(S,b.x,b.y);var ct=ut.matrix.inverse(),pt=v.inverse(),It=svgedit.math.matrixMultiply(pt,ct,dt,v);if(G=It.e,V=It.f,0!=G||0!=V)for(var C=r.childNodes,D=C.length;D--;){var E=C.item(D);if(1==E.nodeType){var F=t.getStartTransform();t.setStartTransform(E.getAttribute("transform"));var P=svgedit.transformlist.getTransformList(E),et=s.createSVGTransform();et.setTranslate(G,V),P.numberOfItems?P.insertItemBefore(et,0):P.appendItem(et),l.addSubCommand(svgedit.recalculate.recalculateDimensions(E)),t.setStartTransform(F)}}S&&(i.numberOfItems?i.insertItemBefore(ut,0):i.appendItem(ut))}}else{var T=svgedit.utilities.getBBox(r);if(!T&&"path"!=r.tagName)return null;var v=s.createSVGMatrix(),j=svgedit.utilities.getRotationAngle(r);if(j){var y={x:T.x+T.width/2,y:T.y+T.height/2},b=svgedit.math.transformPoint(T.x+T.width/2,T.y+T.height/2,svgedit.math.transformListToTransform(i).matrix),M=j*Math.PI/180;if(Math.abs(M)>1e-10)var O=Math.sin(M)/(1-Math.cos(M));else var O=2/M;for(var x=0;x<i.numberOfItems;++x){var m=i.getItem(x);if(4==m.type){var A=m.matrix;y.y=(O*A.e+A.f)/2,y.x=(A.e-O*A.f)/2,i.removeItem(x);break}}}var L=0,N=i.numberOfItems;if(!svgedit.browser.isWebkit()){var xt=r.getAttribute("fill");if(xt&&0===xt.indexOf("url(")){var ht=getRefElem(xt),Tt="pattern";ht.tagName!==Tt&&(Tt="gradient");var yt=ht.getAttribute(Tt+"Units");if("userSpaceOnUse"===yt){v=svgedit.math.transformListToTransform(i).matrix;var bt=svgedit.transformlist.getTransformList(ht),St=svgedit.math.transformListToTransform(bt).matrix;v=svgedit.math.matrixMultiply(v,St);var Mt="matrix("+[v.a,v.b,v.c,v.d,v.e,v.f].join(",")+")";ht.setAttribute(Tt+"Transform",Mt)}}}if(N>=3&&3==i.getItem(N-2).type&&2==i.getItem(N-3).type&&2==i.getItem(N-1).type)L=3,v=svgedit.math.transformListToTransform(i,N-3,N-1).matrix,i.removeItem(N-1),i.removeItem(N-2),i.removeItem(N-3);else if(4==N&&1==i.getItem(N-1).type){L=3,v=svgedit.math.transformListToTransform(i).matrix;var H=s.createSVGTransform();H.setMatrix(v),i.clear(),i.appendItem(H),v=s.createSVGMatrix()}else if((1==N||N>1&&3!=i.getItem(1).type)&&2==i.getItem(0).type){L=2;var Ot=i.getItem(0).matrix,At=svgedit.math.transformListToTransform(i,1).matrix,Gt=At.inverse();v=svgedit.math.matrixMultiply(Gt,Ot,At),i.removeItem(0)}else{if(1!=N||1!=i.getItem(0).type||j){if(L=4,j){var nt=s.createSVGTransform();nt.setRotate(j,b.x,b.y),i.numberOfItems?i.insertItemBefore(nt,0):i.appendItem(nt)}return 0==i.numberOfItems&&r.removeAttribute("transform"),null}switch(v=svgedit.math.transformListToTransform(i).matrix,r.tagName){case"line":d=$(r).attr(["x1","y1","x2","y2"]);case"polyline":case"polygon":if(d.points=r.getAttribute("points"),d.points){var p=r.points,I=p.numberOfItems;d.points=new Array(I);for(var x=0;x<I;++x){var h=p.getItem(x);d.points[x]={x:h.x,y:h.y}}}case"path":d.d=r.getAttribute("d"),L=1,i.clear()}}if(1!=L&&2!=L&&3!=L||svgedit.coords.remapElement(r,d,v),2==L){if(j){svgedit.math.hasMatrixTransform(i)||(b={x:y.x+v.e,y:y.y+v.f});var nt=s.createSVGTransform();nt.setRotate(j,b.x,b.y),i.numberOfItems?i.insertItemBefore(nt,0):i.appendItem(nt)}if("text"==r.tagName)for(var C=r.childNodes,D=C.length;D--;){var E=C.item(D);if("tspan"==E.tagName){var Vt={x:$(E).attr("x")||0,y:$(E).attr("y")||0};svgedit.coords.remapElement(E,Vt,v)}}}else if(3==L&&j){var v=svgedit.math.transformListToTransform(i).matrix,lt=s.createSVGTransform();lt.setRotate(j,y.x,y.y);var dt=lt.matrix,ut=s.createSVGTransform();ut.setRotate(j,b.x,b.y);var ct=ut.matrix.inverse(),pt=v.inverse(),It=svgedit.math.matrixMultiply(pt,ct,dt,v);svgedit.coords.remapElement(r,d,It),j&&(i.numberOfItems?i.insertItemBefore(ut,0):i.appendItem(ut))}}return 0==i.numberOfItems&&r.removeAttribute("transform"),l.addSubCommand(new svgedit.history.ChangeElementCommand(r,u)),l}})();
var myselect=function(){"use strict";return{initSelect:function(){var e,t,r;svgedit.select||(svgedit.select={});var s=svgedit.browser.isTouch()?10:4;svgedit.select.Selector=function(t,r){this.id=t,this.selectedElement=r,this.locked=!0,this.selectorGroup=e.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}}),this.selectorRect=this.selectorGroup.appendChild(e.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#9ebdff","stroke-width":"1",style:"pointer-events:none"}})),this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.reset(this.selectedElement)},svgedit.select.Selector.prototype.reset=function(e){this.locked=!0,this.selectedElement=e,this.resize(),this.selectorGroup.setAttribute("display","inline")},svgedit.select.Selector.prototype.updateGripCursors=function(e){var t,s=[],i=Math.round(e/45);for(t in i<0&&(i+=8),r.selectorGrips)s.push(t);for(;i>0;)s.push(s.shift()),i--;var o=0;for(t in r.selectorGrips)r.selectorGrips[t].setAttribute("style","cursor:"+s[o]+"-resize"),o++},svgedit.select.Selector.prototype.showGrips=function(e){var t=e?"inline":"none";r.selectorGripsGroup.setAttribute("display",t);var s=this.selectedElement;this.hasGrips=e,s&&e&&(this.selectorGroup.appendChild(r.selectorGripsGroup),this.updateGripCursors(svgedit.utilities.getRotationAngle(s)))},svgedit.select.Selector.prototype.resize=function(){var t=this.selectorRect,i=r,o=i.selectorGrips,l=this.selectedElement,n=l.getAttribute("stroke-width"),a=e.currentZoom(),c=1/a;"none"===l.getAttribute("stroke")||isNaN(n)||(c+=n/2);var d=l.tagName;"text"===d&&(c+=2/a);var h=svgedit.transformlist.getTransformList(l),p=svgedit.math.transformListToTransform(h).matrix;p.e*=a,p.f*=a;var u=svgedit.utilities.getBBox(l);if("g"===d&&!$.data(l,"gsvg")){var g=e.getStrokedBBox(l.childNodes);g&&(u=g)}var G=u.x,v=u.y,f=u.width,b=u.height;u={x:G,y:v,width:f,height:b},c*=a;var m=svgedit.math.transformBox(G*a,v*a,f*a,b*a,p),y=m.aabox,x=y.x-c,w=y.y-c,S=y.width+2*c,k=y.height+2*c,C=x+S/2,B=w+k/2,M=svgedit.utilities.getRotationAngle(l);if(M){var A=e.svgRoot().createSVGTransform();A.setRotate(-M,C,B);var E=A.matrix;m.tl=svgedit.math.transformPoint(m.tl.x,m.tl.y,E),m.tr=svgedit.math.transformPoint(m.tr.x,m.tr.y,E),m.bl=svgedit.math.transformPoint(m.bl.x,m.bl.y,E),m.br=svgedit.math.transformPoint(m.br.x,m.br.y,E);var P=m.tl,R=P.x,V=P.y,N=P.x,z=P.y,F=Math.min,T=Math.max;R=F(R,F(m.tr.x,F(m.bl.x,m.br.x)))-c,V=F(V,F(m.tr.y,F(m.bl.y,m.br.y)))-c,N=T(N,T(m.tr.x,T(m.bl.x,m.br.x)))+c,z=T(z,T(m.tr.y,T(m.bl.y,m.br.y)))+c,x=R,w=V,S=N-R,k=z-V}var _=e.svgRoot().suspendRedraw(100),L="M"+x+","+w+" L"+(x+S)+","+w+" "+(x+S)+","+(w+k)+" "+x+","+(w+k)+"z";t.setAttribute("d",L);var j,W=M?"rotate("+[M,C,B].join(",")+")":"";for(j in this.selectorGroup.setAttribute("transform",W),this.gripCoords={nw:[x,w],ne:[x+S,w],sw:[x,w+k],se:[x+S,w+k],n:[x+S/2,w],w:[x,w+k/2],e:[x+S,w+k/2],s:[x+S/2,w+k]},this.gripCoords){var q=this.gripCoords[j];o[j].setAttribute("x",q[0]-3),o[j].setAttribute("y",q[1]-3)}i.rotateGripConnector.setAttribute("x1",x+S/2),i.rotateGripConnector.setAttribute("y1",w),i.rotateGripConnector.setAttribute("x2",x+S/2),i.rotateGripConnector.setAttribute("y2",w-5*s),i.rotateGrip.setAttribute("cx",x+S/2),i.rotateGrip.setAttribute("cy",w-5*s),e.svgRoot().unsuspendRedraw(_)},svgedit.select.SelectorManager=function(){this.selectorParentGroup=null,this.rubberBandBox=null,this.selectors=[],this.selectorMap={},this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.selectorGripsGroup=null,this.rotateGripConnector=null,this.rotateGrip=null,this.initGroup()},svgedit.select.SelectorManager.prototype.initGroup=function(){var r;for(r in this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup),this.selectorParentGroup=e.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}}),this.selectorGripsGroup=e.createSVGElement({element:"g",attr:{display:"none"}}),this.selectorParentGroup.appendChild(this.selectorGripsGroup),e.svgRoot().appendChild(this.selectorParentGroup),this.selectorMap={},this.selectors=[],this.rubberBandBox=null,this.selectorGrips){var i=e.createSVGElement({element:"rect",attr:{id:"selectorGrip_resize_"+r,width:6,height:6,"stroke-width":1,stroke:"#9ebdff",fill:"#FFF",style:"cursor:"+r+"-resize","pointer-events":"all"}});$.data(i,"dir",r),$.data(i,"type","resize"),this.selectorGrips[r]=this.selectorGripsGroup.appendChild(i)}if(this.rotateGripConnector=this.selectorGripsGroup.appendChild(e.createSVGElement({element:"line",attr:{id:"selectorGrip_rotateconnector",stroke:"#9ebdff","stroke-width":"1"}})),this.rotateGrip=this.selectorGripsGroup.appendChild(e.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate",fill:"lime",r:s,stroke:"#9ebdff","stroke-width":1}})),$.data(this.rotateGrip,"type","rotate"),!$("#canvasBackground").length){var o=t.dimensions,l=e.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:o[0],height:o[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}}),n=e.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"#FFF",style:"pointer-events:none"}});l.appendChild(n),e.svgRoot().insertBefore(l,e.svgContent())}},svgedit.select.SelectorManager.prototype.requestSelector=function(e){if(null==e)return null;var t,r=this.selectors.length;if("object"==typeof this.selectorMap[e.id])return this.selectorMap[e.id].locked=!0,this.selectorMap[e.id];for(t=0;t<r;++t)if(this.selectors[t]&&!this.selectors[t].locked)return this.selectors[t].locked=!0,this.selectors[t].reset(e),this.selectorMap[e.id]=this.selectors[t],this.selectors[t];return this.selectors[r]=new svgedit.select.Selector(r,e),this.selectorParentGroup.appendChild(this.selectors[r].selectorGroup),this.selectorMap[e.id]=this.selectors[r],this.selectors[r]},svgedit.select.SelectorManager.prototype.releaseSelector=function(e){if(null!=e){var t,r=this.selectors.length,s=this.selectorMap[e.id];for(t=0;t<r;++t)if(this.selectors[t]&&this.selectors[t]==s){0==s.locked&&console.log("WARNING! selector was released but was already unlocked"),delete this.selectorMap[e.id],s.locked=!1,s.selectedElement=null,s.showGrips(!1);try{s.selectorGroup.setAttribute("display","none")}catch(e){}break}}},svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){return this.rubberBandBox||(this.rubberBandBox=this.selectorParentGroup.appendChild(e.createSVGElement({element:"rect",attr:{id:"selectorRubberBand",fill:"#22C","fill-opacity":.15,stroke:"#22C","stroke-width":.5,display:"none",style:"pointer-events:none"}}))),this.rubberBandBox},svgedit.select.init=function(s,i){t=s,e=i,r=new svgedit.select.SelectorManager},svgedit.select.getSelectorManager=function(){return r}}}}();
var mydraw=function(){"use strict";return{initDraw:function(){svgedit.draw||(svgedit.draw={});var e=svgedit.NS,t="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),r={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},i=r.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(e,t){this.name_=e,this.group_=t},svgedit.draw.Layer.prototype.getName=function(){return this.name_},svgedit.draw.Layer.prototype.getGroup=function(){return this.group_},svgedit.draw.randomizeIds=function(e,t){i=!1===e?r.NEVER_RANDOMIZE:r.ALWAYS_RANDOMIZE,i!=r.ALWAYS_RANDOMIZE||t.getNonce()?i==r.NEVER_RANDOMIZE&&t.getNonce()&&t.clearNonce():t.setNonce(Math.floor(100001*Math.random()))},svgedit.draw.Drawing=function(t,n){if(!t||!t.tagName||!t.namespaceURI||"svg"!=t.tagName||t.namespaceURI!=e.SVG)throw"Error: draw.Drawing instance initialized without a <svg> element";this.svgElem_=t,this.obj_num=0,this.idPrefix=n||"svg_",this.releasedNums=[],this.all_layers=[],this.current_layer=null,this.nonce_="";var a=this.svgElem_.getAttributeNS(e.SE,"nonce");a&&i!=r.NEVER_RANDOMIZE?this.nonce_=a:i==r.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(100001*Math.random()))},svgedit.draw.Drawing.prototype.getElem_=function(e){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+e):$(this.svgElem_).find("[id="+e+"]")[0]},svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_},svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_},svgedit.draw.Drawing.prototype.setNonce=function(t){this.svgElem_.setAttributeNS(e.XMLNS,"xmlns:se",e.SE),this.svgElem_.setAttributeNS(e.SE,"se:nonce",t),this.nonce_=t},svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""},svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num},svgedit.draw.Drawing.prototype.getNextId=function(){var e,t,r="";for(e=0;e<16;e++)t=16*Math.random()|0,8==e&&(r+="-"),r+=(12==e?4:16==e?3&t|8:t).toString(16);this.obj_num=r;var i=this.getId();return i},svgedit.draw.Drawing.prototype.releaseId=function(e){var t=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if("string"!=typeof e||0!==e.indexOf(t))return!1;var r=parseInt(e.substr(t.length),10);return!("number"!=typeof r||r<=0||-1!=this.releasedNums.indexOf(r))&&(this.releasedNums.push(r),!0)},svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length},svgedit.draw.Drawing.prototype.hasLayer=function(e){var t;for(t=0;t<this.getNumLayers();t++)if(this.all_layers[t][0]==e)return!0;return!1},svgedit.draw.Drawing.prototype.getLayerName=function(e){return e>=0&&e<this.getNumLayers()?this.all_layers[e][0]:""},svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer},svgedit.draw.Drawing.prototype.getCurrentLayerName=function(){var e;for(e=0;e<this.getNumLayers();++e)if(this.all_layers[e][1]==this.current_layer)return this.getLayerName(e);return""},svgedit.draw.Drawing.prototype.setCurrentLayer=function(e){var t;for(t=0;t<this.getNumLayers();++t)if(e==this.getLayerName(t))return this.current_layer!=this.all_layers[t][1]&&(this.current_layer.setAttribute("style","pointer-events:none"),this.current_layer=this.all_layers[t][1],this.current_layer.setAttribute("style","pointer-events:all")),!0;return!1},svgedit.draw.Drawing.prototype.deleteCurrentLayer=function(){if(this.current_layer&&this.getNumLayers()>1){var e=this.current_layer.parentNode,t=(this.current_layer.nextSibling,e.removeChild(this.current_layer));return this.identifyLayers(),t}return null},svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];var r,i=this.svgElem_.childNodes.length,n=[],a=[],s=null,o=!1;for(r=0;r<i;++r){var l=this.svgElem_.childNodes.item(r);if(l&&1==l.nodeType)if("g"==l.tagName){o=!0;var u=$("title",l).text();!u&&svgedit.browser.isOpera()&&l.querySelectorAll&&(u=$(l.querySelectorAll("title")).text()),u?(a.push(u),this.all_layers.push([u,l]),s=l,svgedit.utilities.walkTree(l,function(e){e.parentNode&&"foreignObject"===e.parentNode.nodeName||e.setAttribute("style","pointer-events:inherit")}),s.setAttribute("style","pointer-events:none")):n.push(l)}else if(~t.indexOf(l.nodeName)){svgedit.utilities.getBBox(l);n.push(l)}}var g=this.svgElem_.ownerDocument;if(n.length>0||!o){for(r=1;a.indexOf("Layer "+r)>=0;)r++;var d="Layer "+r;s=g.createElementNS(e.SVG,"g");var y,h=g.createElementNS(e.SVG,"title");for(h.textContent=d,s.appendChild(h),y=0;y<n.length;++y)s.appendChild(n[y]);this.svgElem_.appendChild(s),this.all_layers.push([d,s])}svgedit.utilities.walkTree(s,function(e){e.parentNode&&"foreignObject"===e.parentNode.nodeName||e.setAttribute("style","pointer-events:inherit")}),this.current_layer=s,this.current_layer.setAttribute("style","pointer-events:all")},svgedit.draw.Drawing.prototype.createLayer=function(t){var r=this.svgElem_.ownerDocument,i=r.createElementNS(e.SVG,"g"),n=r.createElementNS(e.SVG,"title");return n.textContent=t,i.appendChild(n),this.svgElem_.appendChild(i),this.identifyLayers(),i},svgedit.draw.Drawing.prototype.getLayerVisibility=function(e){var t,r=null;for(t=0;t<this.getNumLayers();++t)if(this.getLayerName(t)==e){r=this.all_layers[t][1];break}return!!r&&"none"!==r.getAttribute("display")},svgedit.draw.Drawing.prototype.setLayerVisibility=function(e,t){if("boolean"!=typeof t)return null;var r,i=null;for(r=0;r<this.getNumLayers();++r)if(this.getLayerName(r)==e){i=this.all_layers[r][1];break}if(!i)return null;var n=i.getAttribute("display");return n||(n="inline"),i.setAttribute("display",t?"inline":"none"),i},svgedit.draw.Drawing.prototype.getLayerOpacity=function(e){var t;for(t=0;t<this.getNumLayers();++t)if(this.getLayerName(t)==e){var r=this.all_layers[t][1],i=r.getAttribute("opacity");return i||(i="1.0"),parseFloat(i)}return null},svgedit.draw.Drawing.prototype.setLayerOpacity=function(e,t){var r;if(!("number"!=typeof t||t<0||t>1))for(r=0;r<this.getNumLayers();++r)if(this.getLayerName(r)==e){var i=this.all_layers[r][1];i.setAttribute("opacity",t);break}}}}}();
(function(){"use strict";var n,t,i,e,o,r,h;svgedit.path||(svgedit.path={});var u=svgedit.NS,l={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},a={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},s=[],c=!0,f={};svgedit.path.setLinkControlPoints=function(n){c=n};svgedit.path.path=null;n=null;svgedit.path.init=function(t){n=t;s=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(n,t){s.push(t+"Abs");s.push(t+"Rel")})};svgedit.path.insertItemBefore=function(n,t,i){var u=n.pathSegList,f,e,r,o;if(svgedit.browser.supportsPathInsertItemBefore()){u.insertItemBefore(t,i);return}for(f=u.numberOfItems,e=[],r=0;r<f;r++)o=u.getItem(r),e.push(o);for(u.clear(),r=0;r<f;r++)r==i&&u.appendItem(t),u.appendItem(e[r])};svgedit.path.ptObjToArr=function(n,t){for(var r=a[n],f=r.length,u=[],i=0;i<f;i++)u[i]=t[r[i]];return u};svgedit.path.getGripPt=function(t,i){var r={x:i?i.x:t.item.x,y:i?i.y:t.item.y},u=t.path,f;return u.matrix&&(f=svgedit.math.transformPoint(r.x,r.y,u.matrix),r=f),r.x*=n.getCurrentZoom(),r.y*=n.getCurrentZoom(),r};svgedit.path.getPointFromGrip=function(t,i){var r={x:t.x,y:t.y};return i.matrix&&(t=svgedit.math.transformPoint(r.x,r.y,i.imatrix),r.x=t.x,r.y=t.y),r.x/=n.getCurrentZoom(),r.y/=n.getCurrentZoom(),r};svgedit.path.addPointGrip=function(n,t,i){var e=svgedit.path.getGripContainer(),r=svgedit.utilities.getElem("pathpointgrip_"+n),f;return r||(r=document.createElementNS(u.SVG,"circle"),svgedit.utilities.assignAttributes(r,{id:"pathpointgrip_"+n,display:"none",r:4,fill:"#0FF",stroke:"#00F","stroke-width":2,cursor:"move",style:"pointer-events:all","xlink:title":l.pathNodeTooltip}),r=e.appendChild(r),f=$("#pathpointgrip_"+n),f.dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})),t&&i&&svgedit.utilities.assignAttributes(r,{cx:t,cy:i,display:"inline"}),r};svgedit.path.getGripContainer=function(){var n=svgedit.utilities.getElem("pathpointgrip_container"),t;return n||(t=svgedit.utilities.getElem("selectorParentGroup"),n=t.appendChild(document.createElementNS(u.SVG,"g")),n.id="pathpointgrip_container"),n};svgedit.path.addCtrlGrip=function(n){var t=svgedit.utilities.getElem("ctrlpointgrip_"+n);return t?t:(t=document.createElementNS(u.SVG,"circle"),svgedit.utilities.assignAttributes(t,{id:"ctrlpointgrip_"+n,display:"none",r:4,fill:"#0FF",stroke:"#55F","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":l.pathCtrlPtTooltip}),svgedit.path.getGripContainer().appendChild(t),t)};svgedit.path.getCtrlLine=function(n){var t=svgedit.utilities.getElem("ctrlLine_"+n);return t?t:(t=document.createElementNS(u.SVG,"line"),svgedit.utilities.assignAttributes(t,{id:"ctrlLine_"+n,stroke:"#555","stroke-width":1,style:"pointer-events:none"}),svgedit.path.getGripContainer().appendChild(t),t)};svgedit.path.getPointGrip=function(n,t){var u=n.index,r=svgedit.path.addPointGrip(u),i;return t&&(i=svgedit.path.getGripPt(n),svgedit.utilities.assignAttributes(r,{cx:i.x,cy:i.y,display:"inline"})),r};svgedit.path.getControlPoints=function(n){var i=n.item,e=n.index,f;if(!("x1"in i)||!("x2"in i))return null;for(var r={},a=svgedit.path.getGripContainer(),l=svgedit.path.path.segs[e-1].item,o=[l,i],t=1;t<3;t++){var s=e+"c"+t,h=r["c"+t+"_line"]=svgedit.path.getCtrlLine(s),u=svgedit.path.getGripPt(n,{x:i["x"+t],y:i["y"+t]}),c=svgedit.path.getGripPt(n,{x:o[t-1].x,y:o[t-1].y});svgedit.utilities.assignAttributes(h,{x1:u.x,y1:u.y,x2:c.x,y2:c.y,display:"inline"});r["c"+t+"_line"]=h;f=r["c"+t]=svgedit.path.addCtrlGrip(s);svgedit.utilities.assignAttributes(f,{cx:u.x,cy:u.y,display:"inline"});r["c"+t]=f}return r};svgedit.path.replacePathSeg=function(n,t,i,r){var e=r||svgedit.path.path.elem,a="createSVGPathSeg"+s[n],o=e[a].apply(e,i),l;if(svgedit.browser.supportsPathReplaceItem())e.pathSegList.replaceItem(o,t);else{for(var f=e.pathSegList,h=f.numberOfItems,c=[],u=0;u<h;u++)l=f.getItem(u),c.push(l);for(f.clear(),u=0;u<h;u++)u==t?f.appendItem(o):f.appendItem(c[u])}};svgedit.path.getSegSelector=function(n,t){var s=n.index,i=svgedit.utilities.getElem("segline_"+s),h,o,e,r,f;if(i||(h=svgedit.path.getGripContainer(),i=document.createElementNS(u.SVG,"path"),svgedit.utilities.assignAttributes(i,{id:"segline_"+s,display:"none",fill:"none",stroke:"#0FF","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"}),h.appendChild(i)),t){if(o=n.prev,!o)return i.setAttribute("display","none"),i;for(e=svgedit.path.getGripPt(o),svgedit.path.replacePathSeg(2,0,[e.x,e.y],i),r=svgedit.path.ptObjToArr(n.type,n.item,!0),f=0;f<r.length;f+=2)e=svgedit.path.getGripPt(n,{x:r[f],y:r[f+1]}),r[f]=e.x,r[f+1]=e.y;svgedit.path.replacePathSeg(n.type,1,r,i)}return i};svgedit.path.smoothControlPoints=function(t,i,r){var s=t.x-r.x,h=t.y-r.y,c=i.x-r.x,l=i.y-r.y,o,u,a,v;if((s!=0||h!=0)&&(c!=0||l!=0)){var f=Math.atan2(h,s),e=Math.atan2(l,c),w=Math.sqrt(s*s+h*h),b=Math.sqrt(c*c+l*l),y=n.getSVGRoot().createSVGPoint(),p=n.getSVGRoot().createSVGPoint();return f<0&&(f+=2*Math.PI),e<0&&(e+=2*Math.PI),o=Math.abs(f-e),u=Math.abs(Math.PI-o)/2,f-e>0?(a=o<Math.PI?f+u:f-u,v=o<Math.PI?e-u:e+u):(a=o<Math.PI?f-u:f+u,v=o<Math.PI?e+u:e-u),y.x=w*Math.cos(a)+r.x,y.y=w*Math.sin(a)+r.y,p.x=b*Math.cos(v)+r.x,p.y=b*Math.sin(v)+r.y,[y,p]}return undefined};svgedit.path.Segment=function(n,t){this.selected=!1;this.index=n;this.item=t;this.type=t.pathSegType;this.ctrlpts=[];this.ptgrip=null;this.segsel=null};svgedit.path.Segment.prototype.showCtrlPts=function(n){for(var t in this.ctrlpts)this.ctrlpts.hasOwnProperty(t)&&this.ctrlpts[t].setAttribute("display",n?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(n){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill",n?"#0FF":"#EEE")};svgedit.path.Segment.prototype.show=function(n){this.ptgrip&&(this.ptgrip.setAttribute("display",n?"inline":"none"),this.segsel.setAttribute("display",n?"inline":"none"),this.showCtrlPts(n))};svgedit.path.Segment.prototype.select=function(n){this.ptgrip&&(this.ptgrip.setAttribute("stroke",n?"#0FF":"#00F"),this.segsel.setAttribute("display",n?"inline":"none"),this.ctrlpts&&this.selectCtrls(n),this.selected=n)};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,!0);this.ctrlpts=svgedit.path.getControlPoints(this,!0);this.segsel=svgedit.path.getSegSelector(this,!0)};svgedit.path.Segment.prototype.update=function(n){if(this.ptgrip){var t=svgedit.path.getGripPt(this);svgedit.utilities.assignAttributes(this.ptgrip,{cx:t.x,cy:t.y});svgedit.path.getSegSelector(this,!0);this.ctrlpts&&(n&&(this.item=svgedit.path.path.elem.pathSegList.getItem(this.index),this.type=this.item.pathSegType),svgedit.path.getControlPoints(this))}};svgedit.path.Segment.prototype.move=function(n,t){var f,u=this.item,i=$.extend({},u),r,e,o;f=this.ctrlpts?[i.x+=n,i.y+=t,i.x1,i.y1,i.x2+=n,i.y2+=t]:[i.x+=n,i.y+=t];svgedit.path.replacePathSeg(this.type,this.index,f);this.next&&this.next.ctrlpts&&(r=this.next.item,e=[r.x,r.y,r.x1+=n,r.y1+=t,r.x2,r.y2],svgedit.path.replacePathSeg(this.next.type,this.next.index,e));this.mate&&(u=this.mate.item,o=[u.x+=n,u.y+=t],svgedit.path.replacePathSeg(this.mate.type,this.mate.index,o));this.update(!0);this.next&&this.next.update(!0)};svgedit.path.Segment.prototype.setLinked=function(n){var t,u,r,f,i,e;if(n==2){if(u=1,t=this.next,!t)return;r=this.item}else{if(u=2,t=this.prev,!t)return;r=t.item}f=t.item;i=$.extend({},f);i["x"+u]=r.x+(r.x-this.item["x"+n]);i["y"+u]=r.y+(r.y-this.item["y"+n]);e=[i.x,i.y,i.x1,i.y1,i.x2,i.y2];svgedit.path.replacePathSeg(t.type,t.index,e);t.update(!0)};svgedit.path.Segment.prototype.moveCtrl=function(n,t,i){var f=this.item,r=$.extend({},f),u;r["x"+n]+=t;r["y"+n]+=i;u=[r.x,r.y,r.x1,r.y1,r.x2,r.y2];svgedit.path.replacePathSeg(this.type,this.index,u);this.update(!0)};svgedit.path.Segment.prototype.setType=function(n,t){svgedit.path.replacePathSeg(n,this.index,t);this.type=n;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(n===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(!0)};svgedit.path.Path=function(n){if(!n||n.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=n;this.segs=[];this.selected_pts=[];svgedit.path.path=this;this.init()};svgedit.path.Path.prototype.init=function(){var o,e,n,h,s,i,u;for($(svgedit.path.getGripContainer()).find("*").each(function(){$(this).attr("display","none")}),o=this.elem.pathSegList,e=o.numberOfItems,this.segs=[],this.selected_pts=[],this.first_seg=null,n=0;n<e;n++)h=o.getItem(n),s=new svgedit.path.Segment(n,h),s.path=this,this.segs.push(s);for(i=this.segs,u=null,n=0;n<e;n++){var t=i[n],f=n+1>=e?null:i[n+1],c=n-1<0?null:i[n-1],r;t.type===2?(c&&c.type!==1&&(r=i[u],r.next=i[u+1],r.next.prev=r,r.addGrip()),u=n):f&&f.type===1?(t.next=i[u+1],t.next.prev=t,t.mate=i[u],t.addGrip(),this.first_seg==null&&(this.first_seg=t)):f?t.type!==1&&(t.addGrip(),f&&f.type!==2&&(t.next=f,t.next.prev=t)):t.type!==1&&(r=i[u],r.next=i[u+1],r.next.prev=r,r.addGrip(),t.addGrip(),this.first_seg||(this.first_seg=i[u]))}return this};svgedit.path.Path.prototype.eachSeg=function(n){for(var r=this.segs.length,i,t=0;t<r;t++)if(i=n.call(this.segs[t],t),i===!1)break};svgedit.path.Path.prototype.addSeg=function(n){var t=this.segs[n],i,f,r,u,w;if(t.prev){i=t.prev;switch(t.item.pathSegType){case 4:r=(t.item.x+i.item.x)/2;u=(t.item.y+i.item.y)/2;f=this.elem.createSVGPathSegLinetoAbs(r,u);break;case 6:var e=(i.item.x+t.item.x1)/2,o=(t.item.x1+t.item.x2)/2,s=(t.item.x2+t.item.x)/2,h=(e+o)/2,c=(o+s)/2;r=(h+c)/2;var l=(i.item.y+t.item.y1)/2,a=(t.item.y1+t.item.y2)/2,v=(t.item.y2+t.item.y)/2,y=(l+a)/2,p=(a+v)/2;u=(y+p)/2;f=this.elem.createSVGPathSegCurvetoCubicAbs(r,u,e,l,h,y);w=[t.item.x,t.item.y,c,p,s,v];svgedit.path.replacePathSeg(t.type,n,w)}svgedit.path.insertItemBefore(this.elem,f,n)}};svgedit.path.Path.prototype.deleteSeg=function(n){var t=this.segs[n],u=this.elem.pathSegList,i,r,f;t.show(!1);i=t.next;t.mate?(r=[i.item.x,i.item.y],svgedit.path.replacePathSeg(2,i.index,r),svgedit.path.replacePathSeg(4,t.index,r),u.removeItem(t.mate.index)):t.prev?u.removeItem(n):(f=t.item,r=[i.item.x,i.item.y],svgedit.path.replacePathSeg(2,t.next.index,r),u.removeItem(n))};svgedit.path.Path.prototype.subpathIsClosed=function(n){var t=!1;return svgedit.path.path.eachSeg(function(i){return i<=n?!0:this.type===2?!1:this.type===1?(t=!0,!1):void 0}),t};svgedit.path.Path.prototype.removePtFromSelection=function(n){var t=this.selected_pts.indexOf(n);t!=-1&&(this.segs[n].select(!1),this.selected_pts.splice(t,1))};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(!1)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=function(n){return this.eachSeg(function(){this.show(n)}),n&&this.selectPt(this.first_seg.index),this};svgedit.path.Path.prototype.movePts=function(n,t){for(var i=this.selected_pts.length,r;i--;)r=this.segs[this.selected_pts[i]],r.move(n,t)};svgedit.path.Path.prototype.moveCtrl=function(n,t){var i=this.segs[this.selected_pts[0]];i.moveCtrl(this.dragctrl,n,t);c&&i.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(n){var e,s,h,u;for(this.storeD(),e=this.selected_pts.length;e--;){var y=this.selected_pts[e],t=this.segs[y],o=t.prev;if(o){n||(s="Toggle Path Segment Type",h=t.type,n=h==6?4:6);n=Number(n);var i=t.item.x,r=t.item.y,c=o.item.x,l=o.item.y,f;switch(n){case 6:if(t.olditem)u=t.olditem,f=[i,r,u.x1,u.y1,u.x2,u.y2];else{var a=i-c,v=r-l,p=c+a/3,w=l+v/3,b=i-a/3,k=r-v/3;f=[i,r,p,w,b,k]}break;case 4:f=[i,r];t.olditem=t.item}t.setType(n,f)}}svgedit.path.path.endChanges(s)};svgedit.path.Path.prototype.selectPt=function(n,t){this.clearSelection();n==null&&this.eachSeg(function(t){this.prev&&(n=t)});this.addPtsToSelection(n);t&&(this.dragctrl=t,c&&this.segs[n].setLinked(t))};svgedit.path.Path.prototype.update=function(){var n=this.elem;return svgedit.utilities.getRotationAngle(n)?(this.matrix=svgedit.math.getMatrix(n),this.imatrix=this.matrix.inverse()):(this.matrix=null,this.imatrix=null),this.eachSeg(function(t){this.item=n.pathSegList.getItem(t);this.update()}),this};svgedit.path.getPath_=function(n){var t=f[n.id];return t||(t=f[n.id]=new svgedit.path.Path(n)),t};svgedit.path.removePath_=function(n){n in f&&delete f[n]};h=function(n,u){var f=n-e,s=u-o,h=Math.sqrt(f*f+s*s),c=Math.atan2(s,f)+r;return f=h*Math.cos(c)+e,s=h*Math.sin(c)+o,f-=t,s-=i,h=Math.sqrt(f*f+s*s),c=Math.atan2(s,f)-r,{x:h*Math.cos(c)+t,y:h*Math.sin(c)+i}};svgedit.path.recalcRotatedPath=function(){var f=svgedit.path.path.elem,u,s,y,c,n,p,w,l,b,k,d,tt;if(r=svgedit.utilities.getRotationAngle(f,!0),r){u=svgedit.utilities.getBBox(f);s=svgedit.path.path.oldbbox;e=s.x+s.width/2;o=s.y+s.height/2;t=u.x+u.width/2;i=u.y+u.height/2;var a=t-e,v=i-o,g=Math.sqrt(a*a+v*v),nt=Math.atan2(v,a)+r;for(t=g*Math.cos(nt)+e,i=g*Math.sin(nt)+o,y=f.pathSegList,c=y.numberOfItems;c;)(c-=1,n=y.getItem(c),p=n.pathSegType,p!=1)&&(w=h(n.x,n.y),l=[w.x,w.y],n.x1!=null&&n.x2!=null&&(b=h(n.x1,n.y1),k=h(n.x2,n.y2),l.splice(l.length,0,b.x,b.y,k.x,k.y)),svgedit.path.replacePathSeg(p,c,l));u=svgedit.utilities.getBBox(f);d=svgroot.createSVGTransform();tt=svgedit.transformlist.getTransformList(f);d.setRotate(r*180/Math.PI,t,i);tt.replaceItem(d,0)}};svgedit.path.clearData=function(){f={}}})();
var svgedit=svgedit||{};(function(){window.initContextmenu=function(){var n=this;svgedit.contextmenu||(svgedit.contextmenu={}),n.contextMenuExtensions={};var e=function(n){return n&&n.id&&n.label&&n.action&&"function"==typeof n.action},t=function(t){return e(t)?t.id in n.contextMenuExtensions?void console.error('Cannot add extension "'+t.id+'", an extension by that name already exists"'):(console.log("Registed contextmenu item: {id:"+t.id+", label:"+t.label+"}"),void(n.contextMenuExtensions[t.id]=t)):void console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")},o=function(e){return n.contextMenuExtensions[e]&&!0},i=function(e){return n.contextMenuExtensions[e].action},s=function(n){};svgEditor.ready(function(){var n;for(n in contextMenuExtensions)s(contextMenuExtensions[n])}),svgedit.contextmenu.resetCustomMenus=function(){n.contextMenuExtensions={}},svgedit.contextmenu.add=t,svgedit.contextmenu.hasCustomHandler=o,svgedit.contextmenu.getCustomHandler=i}})();
var mysvgcanvas={initSvgCanvas:function(t){window.console||(window.console={},window.console.log=function(t){},window.console.dir=function(t){}),window.opera&&(window.console.log=function(t){opera.postError(t)},window.console.dir=function(t){})}};$.SvgCanvas=function(t,e){function i(){Nt();var t=[],e={feGaussianBlur:X.exportNoBlur,foreignObject:X.exportNoforeignObject,"[stroke-dasharray]":X.exportNoDashArray},i=$(g);return"font"in $("<canvas>")[0].getContext("2d")||(e.text=X.exportNoText),$.each(e,function(e,r){i.find(e).length&&t.push(r)}),t}function r(t,e){var i,r=svgedit.utilities.getBBox(t);for(i=0;i<2;i++){var n=0===i?"fill":"stroke",a=t.getAttribute(n);if(a&&0===a.indexOf("url(")){var s=svgedit.utilities.getRefElem(a);if("linearGradient"===s.tagName){var o=s.getAttribute("x1")||0,l=s.getAttribute("y1")||0,d=s.getAttribute("x2")||1,u=s.getAttribute("y2")||0;o=r.width*o+r.x,l=r.height*l+r.y,d=r.width*d+r.x,u=r.height*u+r.y;var g=svgedit.math.transformPoint(o,l,e),h=svgedit.math.transformPoint(d,u,e),m={};m.x1=(g.x-r.x)/r.width,m.y1=(g.y-r.y)/r.height,m.x2=(h.x-r.x)/r.width,m.y2=(h.y-r.y)/r.height;var c=s.cloneNode(!0);$(c).attr(m),c.id=gt(),svgedit.utilities.findDefs().appendChild(c),t.setAttribute(n,"url(#"+c.id+")")}}}}var n=svgedit.NS,a={show_outside_canvas:!0,selectNew:!0,dimensions:[640,480]};e&&$.extend(a,e);var s=a.dimensions,o=this,l=[],d=t.ownerDocument,u=d.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+n.SVG+'" xlinkns="'+n.XLINK+'" width="'+s[0]+'" height="'+s[1]+'" x="'+s[0]+'" y="'+s[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,!0);t.appendChild(u);var g=d.createElementNS(n.SVG,"svg"),h=o.clearSvgContentElement=function(){for(;g.firstChild;)g.removeChild(g.firstChild);$(g).attr({id:"svgcontent",width:s[0],height:s[1],x:s[0],y:s[1],overflow:a.show_outside_canvas?"visible":"hidden",xmlns:n.SVG,"xmlns:se":n.SE,"xmlns:xlink":n.XLINK}).appendTo(u);var t=d.createComment(" Created with wux-editor ");g.appendChild(t)};h();var m="svg_";o.setIdPrefix=function(t){m=t},o.current_drawing_=new svgedit.draw.Drawing(g,m);var c=o.getCurrentDrawing=function(){return o.current_drawing_},v=1,p=null,f={shape:{fill:("none"==a.initFill.color?"":"#")+a.initFill.color,fill_paint:null,fill_opacity:a.initFill.opacity,stroke:"#"+a.initStroke.color,stroke_paint:null,stroke_opacity:a.initStroke.opacity,stroke_width:a.initStroke.width,stroke_dasharray:"none",stroke_linejoin:"miter",stroke_linecap:"butt",opacity:a.initOpacity}};f.text=$.extend(!0,{},f.shape),$.extend(f.text,{fill:"#000000",stroke_width:0,font_size:14,font_family:"sans-serif",text_anchor:"middle"});var b=f.shape,S=new Array(1),C=this.addSvgElementFromJson=function(t){var e=svgedit.utilities.getElem(t.attr.id),i=c().getCurrentLayer();return e&&t.element!=e.tagName&&(i.removeChild(e),e=null),e||(e=d.createElementNS(n.SVG,t.element),i&&(p||i).appendChild(e)),t.curStyles&&svgedit.utilities.assignAttributes(e,{fill:b.fill,stroke:b.stroke,"stroke-width":b.stroke_width,"stroke-dasharray":b.stroke_dasharray,"stroke-linejoin":b.stroke_linejoin,"stroke-linecap":b.stroke_linecap,"stroke-opacity":b.stroke_opacity,"fill-opacity":b.fill_opacity,opacity:b.opacity/2,style:"pointer-events:inherit"},100),svgedit.utilities.assignAttributes(e,t.attr,100),svgedit.utilities.cleanupElement(e),e},w=this.addSvgGroupFromJson=function(t){var e=svgedit.utilities.getElem(t.id),i=c().getCurrentLayer();e&&t.group!=e.tagName&&(i.removeChild(e),e=null),e||(e=d.createElementNS(n.SVG,t.group),e.setAttribute("id",t.id),e.setAttribute("type",t.type),i&&(p||i).appendChild(e));for(var r=0;r<t.elements.length;r++){var a=d.createElementNS(n.SVG,t.elements[r].type);if(svgedit.utilities.assignAttributes(a,{"stroke-width":b.stroke_width,"stroke-dasharray":b.stroke_dasharray,"stroke-linejoin":b.stroke_linejoin,"stroke-linecap":b.stroke_linecap,style:"pointer-events:inherit"},100),svgedit.utilities.assignAttributes(a,t.elements[r].attr),"text"===t.elements[r].type)a.textContent=t.elements[r].content;else if("foreignObject"===t.elements[r].type){var s=t.elements[r].content;if(s)for(var o=0;o<s.length;o++){var l=document.createElement(s[o].tag);if(l.tagName=l.tagName.toLowerCase(),"select"===l.tagName.toLowerCase()){var u=document.createElement("option");u.setAttribute("test"," "),l.appendChild(u)}else"button"===l.tagName.toLowerCase()?l.innerHTML="button":"span"===l.tagName.toLowerCase()&&(s[o].value&&(l.innerHTML=s[o].value),s[o].attr&&svgedit.utilities.assignAttributes(l,s[o].attr));svgedit.utilities.assignAttributes(l,s[o].attr),s[o].style&&l.setAttribute("style",s[o].style),"input"===l.tagName.toLowerCase()&&(l.style.backgroundColor=b.fill,l.style.color=b.stroke),a.appendChild(l)}}e.appendChild(a)}return t.curStyles&&svgedit.utilities.assignAttributes(e,{fill:b.fill,stroke:b.stroke,"stroke-width":b.stroke_width,"stroke-dasharray":b.stroke_dasharray,"stroke-linejoin":b.stroke_linejoin,"stroke-linecap":b.stroke_linecap,style:"pointer-events:inherit"},100),svgedit.utilities.assignAttributes(e,t.attr,100),svgedit.utilities.cleanupElement(e),D("onGaugeAdded",{id:t.id,type:t.type}),e},_=(o.getTransformList=svgedit.transformlist.getTransformList,svgedit.math.transformPoint),N=o.matrixMultiply=svgedit.math.matrixMultiply,A=o.hasMatrixTransform=svgedit.math.hasMatrixTransform,k=o.transformListToTransform=svgedit.math.transformListToTransform;svgedit.math.snapToAngle,svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return a.baseUnit},getElement:svgedit.utilities.getElem,getHeight:function(){return g.getAttribute("height")/v},getWidth:function(){return g.getAttribute("width")/v},getRoundDigits:function(){return save_options.round_digits}});o.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return d},getDOMContainer:function(){return t},getSVGRoot:function(){return u},getSelectedElements:function(){return S},getSVGContent:function(){return g},getBaseUnit:function(){return a.baseUnit},getSnappingStep:function(){return a.snappingStep}});var E=o.findDefs=svgedit.utilities.findDefs,B=o.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,T=o.getHref=svgedit.utilities.getHref,I=o.setHref=svgedit.utilities.setHref,G=svgedit.utilities.getPathBBox,M=(o.getBBox=svgedit.utilities.getBBox,o.getRotationAngle=svgedit.utilities.getRotationAngle,o.getElem=svgedit.utilities.getElem),L=(o.getRefElem=svgedit.utilities.getRefElem,o.assignAttributes=svgedit.utilities.assignAttributes),P=this.cleanupElement=svgedit.utilities.cleanupElement;svgedit.coords.init({getDrawing:function(){return c()},getGridSnapping:function(){return a.gridSnapping}});var O=this.remapElement=svgedit.coords.remapElement;svgedit.recalculate.init({getSVGRoot:function(){return u},getStartTransform:function(){return startTransform},setStartTransform:function(t){startTransform=t}});var D,V=this.recalculateDimensions=svgedit.recalculate.recalculateDimensions,R=svgedit.getReverseNS(),U=o.sanitizeSvg=svgedit.sanitize.sanitizeSvg,z=svgedit.history.MoveElementCommand,F=svgedit.history.InsertElementCommand,j=svgedit.history.RemoveElementCommand,H=svgedit.history.ChangeElementCommand,q=svgedit.history.BatchCommand;o.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(t,e){var i=svgedit.history.HistoryEventTypes;if(t==i.BEFORE_UNAPPLY||t==i.BEFORE_APPLY)o.clearSelection();else if(t==i.AFTER_APPLY||t==i.AFTER_UNAPPLY){var r=e.elements();o.pathActions.clear(),D("changed",r);var n=e.type(),a=t==i.AFTER_APPLY;if(n==z.type()){var s=a?e.newParent:e.oldParent;s==g&&o.identifyLayers()}else if(n==F.type()||n==j.type())e.parent==g&&o.identifyLayers(),n==F.type()?a&&tt(e.elem):a||tt(e.elem),"use"===e.elem.tagName&&Gt(e.elem);else if(n==H.type()){"title"==e.elem.tagName&&e.elem.parentNode.parentNode==g&&o.identifyLayers();var l=a?e.newValues:e.oldValues;l.stdDeviation&&o.setBlurOffsets(e.elem.parentNode,l.stdDeviation)}}}});var W=function(t){o.undoMgr.addCommandToHistory(t)};svgedit.select.init(a,{createSVGElement:function(t){return o.addSvgElementFromJson(t)},svgRoot:function(){return u},svgContent:function(){return g},currentZoom:function(){return v},getStrokedBBox:function(t){return o.getStrokedBBox([t])}});var K=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return v},getSVGRoot:function(){return u}});var X={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},Y="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",Z=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],J=$.data,Q=document.createElementNS(n.SVG,"animate");$(Q).attr({attributeName:"opacity",begin:"indefinite",dur:1,fill:"freeze"}).appendTo(u);var tt=function(t){var e,i,r,n=$(t).attr(Z);for(e in n){var a=n[e];if(a&&0===a.indexOf("url(")){var s=svgedit.utilities.getUrlFromAttr(a).substr(1),o=M(s);o||(svgedit.utilities.findDefs().appendChild(removedElements[s]),delete removedElements[s])}}var l=t.getElementsByTagName("*");if(l.length)for(i=0,r=l.length;i<r;i++)tt(l[i])},et={},it=a.imgPath+"logo.png",rt="";disabled_elems=[],save_options={round_digits:5},started=!1,startTransform=null,current_mode="select",current_resize_mode="none",import_ids={},cur_text=f.text,cur_properties=b,justSelected=null,rubberBox=null,curBBoxes=[],extensions={},lastClickPoint=null,removedElements={},o.clipBoard=[];var nt=this.runExtensions=function(t,e,i){var r=!!i&&[];return $.each(extensions,function(n,a){a&&t in a&&(i?r.push(a[t](e)):(r=a[t](e),"mouseMove"!==t&&"mouseUp"!==t||!r||D("onGaugeResized",{id:r})))}),r},at=this.setSpecialsIds=function(t,e){l=t,e},st=this.runGetExtensions=function(t,e){var i=!1;return $.each(extensions,function(r,n){if(n&&t in n){let r=n[t](e);r&&(i=r)}}),i},ot=this.runExtension=function(t,e,i){var r=!1;return extensions[t]&&(r=extensions[t][e](i)),r};this.addExtension=function(t,e){var i;t in extensions?console.log('Cannot add extension "'+t+'", an extension by that name already exists.'):(i=$.isFunction(e)?e($.extend(o.getPrivateMethods(),{svgroot:u,svgcontent:g,nonce:c().getNonce(),selectorManager:K})):e,extensions[t]=i,D("extension_added",i))},this.clickExtension=function(t){if(t in extensions){var e=extensions[t];e.buttons&&e.buttons[0]&&e.buttons[0].events&&e.buttons[0].events.click()}};var lt=this.round=function(t){return parseInt(t*v,10)/v},dt=this.getIntersectionList=function(t){if(null==rubberBox)return null;var e=p||c().getCurrentLayer();curBBoxes.length||(curBBoxes=ft(e));var i=null;try{i=e.getIntersectionList(t,null)}catch(t){}if(null==i||"function"!=typeof i.item){var r;if(i=[],t)r=t;else{r=rubberBox.getBBox();var n,a={};for(n in r)a[n]=r[n]/v;r=a}for(var s=curBBoxes.length;s--;)r.width&&svgedit.math.rectsIntersect(r,curBBoxes[s].bbox)&&i.push(curBBoxes[s].elem)}return i};getStrokedBBox=this.getStrokedBBox=function(t){if(t||(t=pt()),!t.length)return!1;var e,i=function(t){try{var e=svgedit.utilities.getBBox(t),i=svgedit.utilities.getRotationAngle(t);if(i&&i%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(t))){var r=!1,a=["ellipse","path","line","polyline","polygon"];if(a.indexOf(t.tagName)>=0)e=r=o.convertToPath(t,!0);else if("rect"==t.tagName){var s=t.getAttribute("rx"),l=t.getAttribute("ry");(s||l)&&(e=r=o.convertToPath(t,!0))}if(!r){var d=t.cloneNode(!0),u=document.createElementNS(n.SVG,"g"),g=t.parentNode;g.appendChild(u),u.appendChild(d),e=svgedit.utilities.bboxToObj(u.getBBox()),g.removeChild(u)}}return e}catch(e){return console.log(t,e),null}};if($.each(t,function(){e||this.parentNode&&(e=i(this))}),null==e)return null;var r=e.x+e.width,a=e.y+e.height,s=e.x,l=e.y,d=function(t){var e=t.getAttribute("stroke-width"),i=0;return"none"==t.getAttribute("stroke")||isNaN(e)||(i+=e/2),i},u=[];return $.each(t,function(t,e){var r=i(e);if(r){var n=d(e);s=Math.min(s,r.x-n),l=Math.min(l,r.y-n),u.push(r)}}),e.x=s,e.y=l,$.each(t,function(t,e){var i=u[t];if(i&&1==e.nodeType){var n=d(e);r=Math.max(r,i.x+i.width+n),a=Math.max(a,i.y+i.height+n)}}),e.width=r-s,e.height=a-l,e};var ut,gt,ht,mt,ct,vt,pt=this.getVisibleElements=function(t){t||(t=$(g).children());var e=[];return $(t).children().each(function(t,i){try{i.getBBox()&&e.push(i)}catch(t){}}),e.reverse()},ft=this.getVisibleElementsAndBBoxes=function(t){t||(t=$(g).children());var e=[];return $(t).children().each(function(t,i){try{i.getBBox()&&e.push({elem:i,bbox:getStrokedBBox([i])})}catch(t){}}),e.reverse()},yt=this.groupSvgElem=function(t){var e=document.createElementNS(n.SVG,"g");t.parentNode.replaceChild(e,t),$(e).append(t).data("gsvg",t)[0].id=gt()},xt=function(t){var e=document.createElementNS(t.namespaceURI,t.nodeName),i=t.parentNode;(i&&"foreignObject"===i.nodeName||i.parentNode&&"foreignObject"===i.parentNode.nodeName)&&(e=document.createElement(t.nodeName),e.tagName=e.tagName.toLowerCase()),$.each(t.attributes,function(t,i){"-moz-math-font-style"!=i.localName&&e.setAttribute(i.nodeName,i.value)});var r=e.getAttribute("id");if(r){var n=r.slice(0,1+r.indexOf("_"));e.removeAttribute("id"),e.id=gt(),n!==m&&(e.id=e.id.replace(m,n))}if(svgedit.browser.isWebkit()&&"path"==t.nodeName){var a=mt.convertPath(t);e.setAttribute("d",a)}if($.each(t.childNodes,function(t,i){switch(i.nodeType){case 1:e.appendChild(xt(i));break;case 3:e.textContent=i.nodeValue}}),$(t).data("gsvg"))$(e).data("gsvg",e.firstChild);else if($(t).data("symbol")){var s=$(t).data("symbol");$(e).data("ref",s).data("symbol",s)}else"image"==e.tagName&&Bt(e);return e};ct=o,vt={},ut=ct.getId=function(){return c().getId()},gt=ct.getNextId=function(){return c().getNextId()},D=ct.call=function(t,e){if(vt[t])return vt[t](this,e)},ct.bind=function(t,e){var i=vt[t];return vt[t]=e,i},this.prepareSvg=function(t){this.sanitizeSvg(t.documentElement);var e,i,r,a=t.getElementsByTagNameNS(n.SVG,"path");for(e=0,r=a.length;e<r;++e)i=a[e],i.setAttribute("d",mt.convertPath(i)),mt.fixEnd(i)};var bt=function(t){if(!svgedit.browser.isGecko())return t;var e=t.cloneNode(!0);return t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t),K.releaseSelector(t),S[0]=e,K.requestSelector(e).showGrips(!0),e};this.setRotationAngle=function(t,e){t=parseFloat(t);var i=S[0],r=i.getAttribute("transform"),n=svgedit.utilities.getBBox(i),a=n.x+n.width/2,s=n.y+n.height/2,o=svgedit.transformlist.getTransformList(i);if(o.numberOfItems>0){var l=o.getItem(0);4==l.type&&o.removeItem(0)}if(0!=t){var d=svgedit.math.transformPoint(a,s,svgedit.math.transformListToTransform(o).matrix),g=u.createSVGTransform();g.setRotate(t,d.x,d.y),o.numberOfItems?o.insertItemBefore(g,0):o.appendItem(g)}else 0==o.numberOfItems&&i.removeAttribute("transform");if(!e){var h=i.getAttribute("transform");i.setAttribute("transform",r),Ft("transform",h,S),D("changed",S)}svgedit.utilities.getElem("pathpointgrip_container");var m=K.requestSelector(S[0]);m.resize(),m.updateGripCursors(t)};var St=this.recalculateAllSelectedDimensions=function(){for(var t="none"==current_resize_mode?"position":"size",e=new svgedit.history.BatchCommand(t),i=S.length;i--;){var r=S[i],n=svgedit.recalculate.recalculateDimensions(r);n&&e.addSubCommand(n)}e.isEmpty()||(W(e),D("changed",S))},Ct=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],wt=function(t){console.log([t.a,t.b,t.c,t.d,t.e,t.f])},_t=null,Nt=this.clearSelection=function(t){if(null!=S[0]){var e,i,r=S.length;for(e=0;e<r&&(i=S[e],null!=i);++e)K.releaseSelector(i),S[e]=null}t||D("selected",S)},At=this.addToSelection=function(t,e){if(0!=t.length){for(var i=0;i<S.length&&null!=S[i];)++i;for(var r=t.length;r--;){var n=t[r];if(n&&svgedit.utilities.getBBox(n)&&("a"===n.tagName&&1===n.childNodes.length&&(n=n.firstChild),-1==S.indexOf(n))){S[i]=n,i++;var a=K.requestSelector(n);S.length>1&&a.showGrips(!1)}}for(D("selected",S),e||1==S.length?K.requestSelector(S[0]).showGrips(!0):K.requestSelector(S[0]).showGrips(!1),S.sort(function(t,e){return t&&e&&t.compareDocumentPosition?3-(6&e.compareDocumentPosition(t)):null==t?1:void 0});null==S[0];)S.shift(0)}},kt=this.selectOnly=function(t,e){Nt(!0),At(t,e)};this.removeFromSelection=function(t){if(null!=S[0]&&0!=t.length){var e,i=0,r=[],n=S.length;for(r.length=n,e=0;e<n;++e){var a=S[e];a&&(-1==t.indexOf(a)?(r[i]=a,i++):K.releaseSelector(a))}S=r}};this.selectAllInCurrentLayer=function(){var t=c().getCurrentLayer();t&&(current_mode="select",kt($(p||t).children()))};var Et=this.getMouseTarget=function(e){if(null==e)return null;var i=e.target;if(i.correspondingUseElement&&(i=i.correspondingUseElement),[n.MATH,n.HTML].indexOf(i.namespaceURI)>=0&&"svgcanvas"!=i.id)for(;"foreignObject"!=i.nodeName;)if(i=i.parentNode,!i)return u;var r=c().getCurrentLayer();if([u,t,g,r].indexOf(i)>=0)return u;var a=$(i);if(a.closest("#selectorParentGroup").length)return K.selectorParentGroup;for(;i.parentNode!==(p||r);)i=i.parentNode;return i};(function(){var e,i,r=null,n=null,s=null,l=null,d=null,g={},h={minx:null,miny:null,maxx:null,maxy:null},m=0,f={x:0,y:0},w={x:0,y:0},_={x:0,y:0},N={x:0,y:0},A={x:0,y:0},k={x:0,y:0},E=.8,B=10,T=function(t){var e={x:0,y:0},i=f,r=w,n=_,a=N,s=1/6,o=t*t,l=o*t,d=[[-1,3,-3,1],[3,-6,3,0],[-3,0,3,0],[1,4,1,0]];return e.x=s*((i.x*d[0][0]+r.x*d[0][1]+n.x*d[0][2]+a.x*d[0][3])*l+(i.x*d[1][0]+r.x*d[1][1]+n.x*d[1][2]+a.x*d[1][3])*o+(i.x*d[2][0]+r.x*d[2][1]+n.x*d[2][2]+a.x*d[2][3])*t+(i.x*d[3][0]+r.x*d[3][1]+n.x*d[3][2]+a.x*d[3][3])),e.y=s*((i.y*d[0][0]+r.y*d[0][1]+n.y*d[0][2]+a.y*d[0][3])*l+(i.y*d[1][0]+r.y*d[1][1]+n.y*d[1][2]+a.y*d[1][3])*o+(i.y*d[2][0]+r.y*d[2][1]+n.y*d[2][2]+a.y*d[2][3])*t+(i.y*d[3][0]+r.y*d[3][1]+n.y*d[3][2]+a.y*d[3][3])),{x:e.x,y:e.y}},G=function(t){if(!o.spaceKey&&1!==t.button){var e=2===t.button;_t=$("#svgcontent g")[0].getScreenCTM().inverse();var i=svgedit.math.transformPoint(t.pageX,t.pageY,_t),m=i.x*v,c=i.y*v;t.preventDefault(),e&&(current_mode="select",lastClickPoint=i);var p=m/v,f=c/v,y=Et(t);"a"===y.tagName&&1===y.childNodes.length&&(y=y.firstChild);var x=p;l=n=p;var w=f;if(d=s=f,a.gridSnapping&&(p=svgedit.utilities.snapToGrid(p),f=svgedit.utilities.snapToGrid(f),n=svgedit.utilities.snapToGrid(n),s=svgedit.utilities.snapToGrid(s)),y==K.selectorParentGroup&&null!=S[0]){var N=t.target,A=J(N,"type");"rotate"==A?current_mode="rotate":"resize"==A&&(current_mode="resize",current_resize_mode=J(N,"dir")),y=S[0]}startTransform=y.getAttribute("transform");var k,E,B=svgedit.transformlist.getTransformList(y);switch(current_mode){case"select":if(started=!0,current_resize_mode="none",e&&(started=!1),y!=u){if(-1==S.indexOf(y)&&(t.shiftKey||Nt(!0),At([y]),justSelected=y,mt.clear()),!e)for(k=0;k<S.length;++k)if(null!=S[k]){var T=svgedit.transformlist.getTransformList(S[k]);T.numberOfItems?T.insertItemBefore(u.createSVGTransform(),0):T.appendItem(u.createSVGTransform())}}else e||(Nt(),current_mode="multiselect",null==rubberBox&&(rubberBox=K.getRubberBandBox()),l*=v,d*=v,svgedit.utilities.assignAttributes(rubberBox,{x:l,y:d,width:0,height:0,display:"inline"},100));break;case"zoom":started=!0,null==rubberBox&&(rubberBox=K.getRubberBandBox()),svgedit.utilities.assignAttributes(rubberBox,{x:x*v,y:x*v,width:0,height:0,display:"inline"},100);break;case"resize":started=!0,n=p,s=f,g=svgedit.utilities.getBBox($("#selectedBox0")[0]);var G={};$.each(g,function(t,e){G[t]=e/v}),g=G;var M=svgedit.utilities.getRotationAngle(y)?1:0;if(svgedit.math.hasMatrixTransform(B))B.insertItemBefore(u.createSVGTransform(),M),B.insertItemBefore(u.createSVGTransform(),M),B.insertItemBefore(u.createSVGTransform(),M);else if(B.appendItem(u.createSVGTransform()),B.appendItem(u.createSVGTransform()),B.appendItem(u.createSVGTransform()),svgedit.browser.supportsNonScalingStroke()){var L=svgedit.browser.isWebkit();if(L)var P=function(t){var e=t.getAttributeNS(null,"stroke");t.removeAttributeNS(null,"stroke"),setTimeout(function(){t.setAttributeNS(null,"stroke",e)},0)};y.style.vectorEffect="non-scaling-stroke",L&&P(y);var O=y.getElementsByTagName("*"),D=O.length;for(k=0;k<D;k++)O[k].style.vectorEffect="non-scaling-stroke",L&&P(O[k])}break;case"fhellipse":case"fhrect":case"fhpath":_.x=x,_.y=w,started=!0,r=x+","+w+" ",E=0==b.stroke_width?1:b.stroke_width,C({element:"polyline",curStyles:!0,attr:{points:r,id:gt(),fill:"none",opacity:b.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}}),h.minx=x,h.maxx=x,h.miny=w,h.maxy=w;break;case"image":started=!0;var V=C({element:"image",attr:{x:p,y:f,width:0,height:0,id:gt(),opacity:b.opacity/2,style:"pointer-events:inherit"}});I(V,it),Bt(V);break;case"svg-image":started=!0,n=p,s=f;break;case"square":case"rect":started=!0,n=p,s=f,C({element:"rect",curStyles:!0,attr:{x:p,y:f,width:0,height:0,id:gt(),opacity:b.opacity/2}});break;case"line":started=!0,E=0==b.stroke_width?1:b.stroke_width,C({element:"line",curStyles:!0,attr:{x1:p,y1:f,x2:p,y2:f,id:gt(),stroke:b.stroke,"stroke-width":E,"stroke-dasharray":b.stroke_dasharray,"stroke-linejoin":b.stroke_linejoin,"stroke-linecap":b.stroke_linecap,"stroke-opacity":b.stroke_opacity,fill:"none",opacity:b.opacity/2,style:"pointer-events:none"}});break;case"circle":started=!0,C({element:"circle",curStyles:!0,attr:{cx:p,cy:f,r:0,id:gt(),opacity:b.opacity/2}});break;case"ellipse":started=!0,C({element:"ellipse",curStyles:!0,attr:{cx:p,cy:f,rx:0,ry:0,id:gt(),opacity:b.opacity/2}});break;case"text":started=!0;C({element:"text",curStyles:!0,attr:{x:p,y:f,id:gt(),fill:cur_text.fill,"stroke-width":cur_text.stroke_width,"font-size":cur_text.font_size,"font-family":cur_text.font_family,"text-anchor":"middle","xml:space":"preserve",opacity:b.opacity}});break;case"pipe":case"path":case"pathedit":n*=v,s*=v,mt.mouseDown(t,y,n,s),started=!0;break;case"textedit":n*=v,s*=v,ht.mouseDown(t,y,n,s),started=!0;break;case"rotate":started=!0,o.undoMgr.beginUndoableChange("transform",S)}var R=nt("mouseDown",{event:t,start_x:n,start_y:s,selectedElements:S},!0);$.each(R,function(t,e){e&&e.started&&(started=!0)})}},M=function(t){if(started&&1!==t.button&&!o.spaceKey){var c,p,b,C,I,G,M,L,P,O,V=S[0],R=svgedit.math.transformPoint(t.pageX,t.pageY,_t),U=R.x*v,z=R.y*v,F=svgedit.utilities.getElem(ut()),j=U/v;x=j;var H,q=z/v;switch(y=q,a.gridSnapping&&(x=svgedit.utilities.snapToGrid(x),y=svgedit.utilities.snapToGrid(y)),t.preventDefault(),current_mode){case"select":if(null!==S[0]&&(G=x-n,M=y-s,a.gridSnapping&&(G=svgedit.utilities.snapToGrid(G),M=svgedit.utilities.snapToGrid(M)),t.shiftKey&&(p=svgedit.math.snapToAngle(n,s,x,y),x=p.x,y=p.y),0!=G||0!=M)){for(L=S.length,c=0;c<L&&(V=S[c],null!=V);++c){var W=u.createSVGTransform();H=svgedit.transformlist.getTransformList(V),W.setTranslate(G,M),H.numberOfItems?H.replaceItem(W,0):H.appendItem(W),K.requestSelector(V).resize()}D("transition",S)}break;case"multiselect":j*=v,q*=v,svgedit.utilities.assignAttributes(rubberBox,{x:Math.min(l,j),y:Math.min(d,q),width:Math.abs(j-l),height:Math.abs(q-d)},100);var X=[],Y=[],Z=dt();for(L=S.length,c=0;c<L;++c){var J=Z.indexOf(S[c]);-1==J?X.push(S[c]):Z[J]=null}for(L=Z.length,c=0;c<L;++c)Z[c]&&Y.push(Z[c]);X.length>0&&o.removeFromSelection(X),Y.length>0&&At(Y);break;case"resize":H=svgedit.transformlist.getTransformList(V);var Q=svgedit.math.hasMatrixTransform(H);O=Q?g:svgedit.utilities.getBBox(V);var tt=O.x,et=O.y,it=O.width,rt=O.height;if(G=x-n,M=y-s,a.gridSnapping&&(G=svgedit.utilities.snapToGrid(G),M=svgedit.utilities.snapToGrid(M),rt=svgedit.utilities.snapToGrid(rt),it=svgedit.utilities.snapToGrid(it)),P=svgedit.utilities.getRotationAngle(V),P){var at=Math.sqrt(G*G+M*M),st=Math.atan2(M,G)-P*Math.PI/180;G=at*Math.cos(st),M=at*Math.sin(st)}-1==current_resize_mode.indexOf("n")&&-1==current_resize_mode.indexOf("s")&&(M=0),-1==current_resize_mode.indexOf("e")&&-1==current_resize_mode.indexOf("w")&&(G=0);var ot=0,lt=0,gt=rt?(rt+M)/rt:1,ct=it?(it+G)/it:1;current_resize_mode.indexOf("n")>=0&&(gt=rt?(rt-M)/rt:1,lt=rt),current_resize_mode.indexOf("w")>=0&&(ct=it?(it-G)/it:1,ot=it);var vt=u.createSVGTransform(),pt=u.createSVGTransform(),ft=u.createSVGTransform();if(a.gridSnapping&&(tt=svgedit.utilities.snapToGrid(tt),ot=svgedit.utilities.snapToGrid(ot),et=svgedit.utilities.snapToGrid(et),lt=svgedit.utilities.snapToGrid(lt)),vt.setTranslate(-(tt+ot),-(et+lt)),t.shiftKey&&(1==ct?ct=gt:gt=ct),pt.setScale(ct,gt),ft.setTranslate(tt+ot,et+lt),Q){var yt=P?1:0;H.replaceItem(vt,2+yt),H.replaceItem(pt,1+yt),H.replaceItem(ft,Number(yt))}else{var xt=H.numberOfItems;H.replaceItem(ft,xt-3),H.replaceItem(pt,xt-2),H.replaceItem(vt,xt-1)}K.requestSelector(V).resize(),D("transition",S);break;case"zoom":j*=v,q*=v,svgedit.utilities.assignAttributes(rubberBox,{x:Math.min(l*v,j),y:Math.min(d*v,q),width:Math.abs(j-l*v),height:Math.abs(q-d*v)},100);break;case"text":svgedit.utilities.assignAttributes(F,{x:x,y:y},1e3);break;case"line":var bt=null;window.opera||u.suspendRedraw(1e3),a.gridSnapping&&(x=svgedit.utilities.snapToGrid(x),y=svgedit.utilities.snapToGrid(y));var St=x,Ct=y;t.shiftKey&&(p=svgedit.math.snapToAngle(n,s,St,Ct),St=p.x,Ct=p.y),F.setAttributeNS(null,"x2",St),F.setAttributeNS(null,"y2",Ct),window.opera||u.unsuspendRedraw(bt);break;case"foreignObject":case"square":case"rect":case"image":var wt,Nt,kt="square"==current_mode||t.shiftKey,Et=Math.abs(x-n),Bt=Math.abs(y-s);kt?(Et=Bt=Math.max(Et,Bt),wt=n<x?n:n-Et,Nt=s<y?s:s-Bt):(wt=Math.min(n,x),Nt=Math.min(s,y)),a.gridSnapping&&(Et=svgedit.utilities.snapToGrid(Et),Bt=svgedit.utilities.snapToGrid(Bt),wt=svgedit.utilities.snapToGrid(wt),Nt=svgedit.utilities.snapToGrid(Nt)),svgedit.utilities.assignAttributes(F,{width:Et,height:Bt,x:wt,y:Nt},1e3);break;case"circle":b=$(F).attr(["cx","cy"]),C=b.cx,I=b.cy;var Tt=Math.sqrt((x-C)*(x-C)+(y-I)*(y-I));a.gridSnapping&&(Tt=svgedit.utilities.snapToGrid(Tt)),F.setAttributeNS(null,"r",Tt);break;case"ellipse":b=$(F).attr(["cx","cy"]),C=b.cx,I=b.cy,bt=null,window.opera||u.suspendRedraw(1e3),a.gridSnapping&&(x=svgedit.utilities.snapToGrid(x),C=svgedit.utilities.snapToGrid(C),y=svgedit.utilities.snapToGrid(y),I=svgedit.utilities.snapToGrid(I)),F.setAttributeNS(null,"rx",Math.abs(x-C));var It=Math.abs(t.shiftKey?x-C:y-I);F.setAttributeNS(null,"ry",It),window.opera||u.unsuspendRedraw(bt);break;case"fhellipse":case"fhrect":h.minx=Math.min(j,h.minx),h.maxx=Math.max(j,h.maxx),h.miny=Math.min(q,h.miny),h.maxy=Math.max(q,h.maxy);case"fhpath":if(N.x=j,N.y=q,f.x&&f.y)for(c=0;c<B-1;c++)e=c/B,i=(c+1)/B,A=T(i),k=A,A=T(e),m+=Math.sqrt((k.x-A.x)*(k.x-A.x)+(k.y-A.y)*(k.y-A.y)),m>E&&(r+=+A.x+","+A.y+" ",F.setAttributeNS(null,"points",r),m-=E);f={x:w.x,y:w.y},w={x:_.x,y:_.y},_={x:N.x,y:N.y};break;case"pipe":case"path":case"pathedit":if(x*=v,y*=v,a.gridSnapping&&(x=svgedit.utilities.snapToGrid(x),y=svgedit.utilities.snapToGrid(y),n=svgedit.utilities.snapToGrid(n),s=svgedit.utilities.snapToGrid(s)),t.shiftKey){var Gt,Mt,Lt=svgedit.path.path;Lt?(Gt=Lt.dragging?Lt.dragging[0]:n,Mt=Lt.dragging?Lt.dragging[1]:s):(Gt=n,Mt=s),p=svgedit.math.snapToAngle(Gt,Mt,x,y),x=p.x,y=p.y}rubberBox&&"none"!==rubberBox.getAttribute("display")&&(j*=v,q*=v,svgedit.utilities.assignAttributes(rubberBox,{x:Math.min(l*v,j),y:Math.min(d*v,q),width:Math.abs(j-l*v),height:Math.abs(q-d*v)},100)),mt.mouseMove(x,y);break;case"textedit":x*=v,y*=v,ht.mouseMove(U,z);break;case"rotate":O=svgedit.utilities.getBBox(V),C=O.x+O.width/2,I=O.y+O.height/2;var $t=svgedit.math.getMatrix(V),Pt=svgedit.math.transformPoint(C,I,$t);if(C=Pt.x,I=Pt.y,P=(Math.atan2(I-y,C-x)*(180/Math.PI)-90)%360,a.gridSnapping&&(P=svgedit.utilities.snapToGrid(P)),t.shiftKey){var Ot=45;P=Math.round(P/Ot)*Ot}o.setRotationAngle(P<-180?360+P:P,!0),D("transition",S)}nt("mouseMove",{event:t,mouse_x:U,mouse_y:z,selected:V})}},L=function(t){if(2!==t.button){var e=justSelected;if(justSelected=null,started){var i,r,u=svgedit.math.transformPoint(t.pageX,t.pageY,_t),g=u.x*v,p=u.y*v,y=g/v,x=p/v,A=svgedit.utilities.getElem(ut()),k=!1,E=y,B=x,T=!1;switch(started=!1,current_mode){case"resize":case"multiselect":null!=rubberBox&&(rubberBox.setAttribute("display","none"),curBBoxes=[]),current_mode="select";case"select":if(null!=S[0]){if(null==S[1]){var I=S[0];switch(I.tagName){case"g":case"use":case"image":case"foreignObject":break;default:var G=I.getAttribute("type");"svg-ext-pipe"!=G&&(cur_properties.fill=I.getAttribute("fill"),cur_properties.fill_opacity=I.getAttribute("fill-opacity"),cur_properties.stroke=I.getAttribute("stroke"),cur_properties.stroke_opacity=I.getAttribute("stroke-opacity"),cur_properties.stroke_width=I.getAttribute("stroke-width"),cur_properties.stroke_dasharray=I.getAttribute("stroke-dasharray"),cur_properties.stroke_linejoin=I.getAttribute("stroke-linejoin"),cur_properties.stroke_linecap=I.getAttribute("stroke-linecap"))}"text"==I.tagName&&(cur_text.font_size=I.getAttribute("font-size"),cur_text.font_family=I.getAttribute("font-family"),cur_text.text_anchor=I.getAttribute("text-anchor")),K.requestSelector(I).showGrips(!0)}if(St(),E!=l||B!=d){var M,L=S.length;for(M=0;M<L&&null!=S[M];++M)S[M].firstChild||K.requestSelector(S[M]).resize()}else r=t.target,"path"===S[0].nodeName&&null==S[1]?mt.select(S[0]):t.shiftKey&&e!=r&&o.removeFromSelection([r]);if(svgedit.browser.supportsNonScalingStroke()){var O=S[0];O&&(O.removeAttribute("style"),svgedit.utilities.walkTree(O,function(t){let e=t,i=!1;for(;e.parentNode;)"foreignObject"===e.parentNode.tagName&&(i=!0),e=e.parentNode;i||t.parentElement&&"foreignObject"===t.parentElement.nodeName||t.removeAttribute("style")}))}var V=nt("mouseUp",{event:t,mouse_x:g,mouse_y:p,selected:S[0]})}return;case"zoom":null!=rubberBox&&rubberBox.setAttribute("display","none");var R=t.shiftKey?.5:2;return void D("zoomed",{x:Math.min(l,E),y:Math.min(d,B),width:Math.abs(E-l),height:Math.abs(B-d),factor:R});case"fhpath":m=0,f={x:0,y:0},w={x:0,y:0},_={x:0,y:0},N={x:0,y:0};var U=A.getAttribute("points"),z=U.indexOf(",");k=z>=0?U.indexOf(",",z+1)>=0:U.indexOf(" ",U.indexOf(" ")+1)>=0,k&&(A=mt.smoothPolylineIntoPath(A));break;case"line":i=$(A).attr(["x1","x2","y1","y2"]),k=i.x1!=i.x2||i.y1!=i.y2;break;case"foreignObject":case"square":case"rect":case"image":case"svg-image":i=$(A).attr(["width","height"]),k=0!=i.width||0!=i.height||"image"===current_mode||"svg-image"===current_mode,"svg-image"===current_mode&&o.importSvgString(rt,{x:n,y:s});break;case"circle":k=0!=A.getAttribute("r");break;case"ellipse":i=$(A).attr(["rx","ry"]),k=null!=i.rx||null!=i.ry;break;case"fhellipse":h.maxx-h.minx>0&&h.maxy-h.miny>0&&(A=C({element:"ellipse",curStyles:!0,attr:{cx:(h.minx+h.maxx)/2,cy:(h.miny+h.maxy)/2,rx:(h.maxx-h.minx)/2,ry:(h.maxy-h.miny)/2,id:ut()}}),D("changed",[A]),k=!0);break;case"fhrect":h.maxx-h.minx>0&&h.maxy-h.miny>0&&(A=C({element:"rect",curStyles:!0,attr:{x:h.minx,y:h.miny,width:h.maxx-h.minx,height:h.maxy-h.miny,id:ut()}}),D("changed",[A]),k=!0);break;case"text":k=!0,kt([A]),ht.start(A);break;case"pipe":case"path":A=null,started=!0;var F=mt.mouseUp(t,A,g,p);A=F.element,k=F.keep;break;case"pathedit":k=!0,A=null,mt.mouseUp(t);break;case"textedit":k=!1,A=null,ht.mouseUp(t,g,p);break;case"rotate":k=!0,A=null,current_mode="select";var j=o.undoMgr.finishUndoableChange();j.isEmpty()||W(j),St(),D("changed",S)}V=nt("mouseUp",{event:t,mouse_x:g,mouse_y:p},!0);if($.each(V,function(t,e){e&&(k=e.keep||k,A=e.element,started=e.started||started)}),k||null==A){if(null!=A){o.addedNew=!0,T&&svgedit.units.convertAttrs(A);var H,q=.2;if(Q.beginElement&&A.getAttribute("opacity")!=b.opacity){H=$(Q).clone().attr({to:b.opacity,dur:q}).appendTo(A);try{H[0].beginElement()}catch(t){}}else q=0;setTimeout(function(){H&&H.remove(),A.setAttribute("opacity",b.opacity),A.setAttribute("style","pointer-events:inherit"),P(A),"path"===current_mode||"pipe"===current_mode?mt.toEditMode(A):a.selectNew&&kt([A],!0),
W(new svgedit.history.InsertElementCommand(A)),D("changed",[A])},1e3*q)}}else{for(c().releaseId(ut()),A.parentNode.removeChild(A),A=null,r=t.target;"g"==r.parentNode.parentNode.tagName;)r=r.parentNode;("path"==current_mode||"pipe"==current_mode)&&drawn_path||"selectorParentGroup"==r.parentNode.id||"svgcanvas"==r.id||"svgroot"==r.id||(o.setMode("select"),kt([r],!0))}startTransform=null}}},O=function(t){var e=t.target,i=e.parentNode;if(i!==p){var r=Et(t),n=r.tagName;if("text"===n&&"textedit"!==current_mode){var a=svgedit.math.transformPoint(t.pageX,t.pageY,_t);ht.select(r,a.x,a.y)}"g"!==n&&"a"!==n||!svgedit.utilities.getRotationAngle(r)||(jt(r),r=S[0],Nt(!0)),p&&Pt(),"g"!==i.tagName&&"a"!==i.tagName||i===c().getCurrentLayer()||r===K.selectorParentGroup||Ot(r)}},V=function(t){return t.preventDefault(),!1};$(t).mousedown(G).mousemove(M).click(V).dblclick(O).mouseup(L),$(t).bind("mousewheel DOMMouseScroll",function(t){if(!t.shiftKey)return;const e=v;t.preventDefault();var i=t.originalEvent;_t=$("#svgcontent g")[0].getScreenCTM().inverse();const r=$("#workarea"),n=0,a=0;var s=svgedit.math.transformPoint(i.pageX,i.pageY,_t);const o=r.width(),l=r.height(),d=o-n-a,u=l-n-a,g=d*_t.a,h=u*_t.d,m=r.offset(),c=m.left+a,p=m.top+a;var f=i.wheelDelta?i.wheelDelta:i.detail?-i.detail:0;if(!f)return;let y,x,b=Math.max(.9,Math.min(10/9,f));b>1?(y=Math.ceil(d/g*b*100)/100,x=Math.ceil(u/h*b*100)/100):(y=Math.floor(d/g*b*100)/100,x=Math.floor(u/h*b*100)/100);let S=Math.min(y,x);if(S===e)return;b=S/e;const C=svgedit.math.transformPoint(c,p,_t),w={x:s.x-(s.x-C.x)/b,y:s.y-(s.y-C.y)/b},_={x:w.x*S,y:w.y*S},N={x:_.x-a+o/2,y:_.y-a+l/2,width:0,height:0,factor:b};D("myZoomed",{center:!1,bbox:N})})})();var Bt=function(t){$(t).click(function(t){t.preventDefault()})};ht=o.textActions=function(){function t(t){var e,i=""===m.value;if($(m).focus(),!arguments.length)if(i)t=0;else{if(m.selectionEnd!==m.selectionStart)return;t=m.selectionEnd}if(e=_[t],e){i||m.setSelectionRange(t,t),c=svgedit.utilities.getElem("text_cursor"),c||(c=document.createElementNS(n.SVG,"line"),svgedit.utilities.assignAttributes(c,{id:"text_cursor",stroke:"#333","stroke-width":1}),c=svgedit.utilities.getElem("selectorParentGroup").appendChild(c)),f||(f=setInterval(function(){var t="none"===c.getAttribute("display");c.setAttribute("display",t?"inline":"none")},600));var r=l(e.x,y.y),a=l(e.x,y.y+y.height);svgedit.utilities.assignAttributes(c,{x1:r.x,y1:r.y,x2:a.x,y2:a.y,visibility:"visible",display:"inline"}),p&&p.setAttribute("d","")}}function e(e,i,r){if(e!==i){r||m.setSelectionRange(e,i),p=svgedit.utilities.getElem("text_selectblock"),p||(p=document.createElementNS(n.SVG,"path"),svgedit.utilities.assignAttributes(p,{id:"text_selectblock",fill:"green",opacity:.5,style:"pointer-events:none"}),svgedit.utilities.getElem("selectorParentGroup").appendChild(p));var a=_[e],s=_[i];c.setAttribute("visibility","hidden");var o=l(a.x,y.y),d=l(a.x+(s.x-a.x),y.y),u=l(a.x,y.y+y.height),g=l(a.x+(s.x-a.x),y.y+y.height),h="M"+o.x+","+o.y+" L"+d.x+","+d.y+" "+g.x+","+g.y+" "+u.x+","+u.y+"z";svgedit.utilities.assignAttributes(p,{d:h,display:"inline"})}else t(i)}function i(t,e){var i=u.createSVGPoint();if(i.x=t,i.y=e,1==_.length)return 0;var r=h.getCharNumAtPosition(i);r<0?(r=_.length-2,t<=_[0].x&&(r=0)):r>=_.length-2&&(r=_.length-2);var n=_[r],a=n.x+n.width/2;return t>a&&r++,r}function r(e,r){t(i(e,r))}function a(t,r,n){var a=m.selectionStart,s=i(t,r),o=Math.min(a,s),l=Math.max(a,s);e(o,l,!n)}function s(t,e){var i={x:t,y:e};if(i.x/=v,i.y/=v,x){var r=svgedit.math.transformPoint(i.x,i.y,x.inverse());i.x=r.x,i.y=r.y}return i}function l(t,e){var i={x:t,y:e};if(x){var r=svgedit.math.transformPoint(i.x,i.y,x);i.x=r.x,i.y=r.y}return i.x*=v,i.y*=v,i}function d(t){e(0,h.textContent.length),$(this).unbind(t)}function g(t){if(w&&h){var r=svgedit.math.transformPoint(t.pageX,t.pageY,_t),n=r.x*v,a=r.y*v,o=s(n,a),l=i(o.x,o.y),u=h.textContent,g=u.substr(0,l).replace(/[a-z0-9]+$/i,"").length,m=u.substr(l).match(/^[a-z0-9]+/i),c=(m?m[0].length:0)+l;e(g,c),$(t.target).click(d),setTimeout(function(){$(t.target).unbind("click",d)},300)}}var h,m,c,p,f,y,x,b,C,w,_=[];return{select:function(t,e,i){h=t,ht.toEditMode(e,i)},start:function(t){h=t,ht.toEditMode()},mouseDown:function(t,e,i,n){var a=s(i,n);m.focus(),r(a.x,a.y),b=i,C=n},mouseMove:function(t,e){var i=s(t,e);a(i.x,i.y)},mouseUp:function(t,e,i){var r=s(e,i);a(r.x,r.y,!0),t.target!==h&&e<b+2&&e>b-2&&i<C+2&&i>C-2&&ht.toSelectMode(!0)},setCursor:t,toEditMode:function(e,i){w=!1,current_mode="textedit",K.requestSelector(h).showGrips(!1);K.requestSelector(h).selectorRect;if(ht.init(),$(h).css("cursor","text"),arguments.length){var n=s(e,i);r(n.x,n.y)}else t();setTimeout(function(){w=!0},300)},toSelectMode:function(t){current_mode="select",clearInterval(f),f=null,p&&$(p).attr("display","none"),c&&$(c).attr("visibility","hidden"),$(h).css("cursor","move"),t&&(Nt(),$(h).css("cursor","move"),D("selected",[h]),At([h],!0)),h&&!h.textContent.length&&o.deleteSelectedElements(),$(m).blur(),h=!1},setInputElem:function(t){m=t},clear:function(){"textedit"==current_mode&&ht.toSelectMode()},init:function(t){if(h){var i,r;h.parentNode||(h=S[0],K.requestSelector(h).showGrips(!1));var n=h.textContent,a=n.length,s=h.getAttribute("transform");for(y=svgedit.utilities.getBBox(h),x=s?svgedit.math.getMatrix(h):null,_=[],_.length=a,m.focus(),$(h).unbind("dblclick",g).dblclick(g),a||(r={x:y.x+y.width/2,width:0}),i=0;i<a;i++){var l=h.getStartPositionOfChar(i);if(r=h.getEndPositionOfChar(i),!svgedit.browser.supportsGoodTextCharPos()){var d=o.contentW*v;l.x-=d,r.x-=d,l.x/=v,r.x/=v}_[i]={x:l.x,y:y.y,width:r.x-l.x,height:y.height}}_.push({x:r.x,width:0}),e(m.selectionStart,m.selectionEnd,!0)}}}}(),mt=o.pathActions=function(){function e(t){t.setAttribute("d",mt.convertPath(t))}var i,s,l,d=!1;svgedit.path.Path.prototype.endChanges=function(t){svgedit.browser.isWebkit()&&e(this.elem);var i=new svgedit.history.ChangeElementCommand(this.elem,{d:this.last_d},t);W(i),D("changed",[this.elem])},svgedit.path.Path.prototype.addPtsToSelection=function(t){var e,i;for($.isArray(t)||(t=[t]),e=0;e<t.length;e++){var r=t[e];i=this.segs[r],i.ptgrip&&-1==this.selected_pts.indexOf(r)&&r>=0&&this.selected_pts.push(r)}this.selected_pts.sort(),e=this.selected_pts.length;var n=[];for(n.length=e;e--;){var a=this.selected_pts[e];i=this.segs[a],i.select(!0),n[e]=i.ptgrip}mt.canDeleteNodes=!0,mt.closed_subpath=this.subpathIsClosed(this.selected_pts[0]),D("selected",n)},i=null;var u=null,g=!1,h=function(t){var e,i=t.points,r=i.numberOfItems;if(r>=4){var n=i.getItem(0),a=null,s=[];for(s.push(["M",n.x,",",n.y," C"].join("")),e=1;e<=r-4;e+=3){var o=i.getItem(e),l=i.getItem(e+1),d=i.getItem(e+2);if(a){var u=svgedit.path.smoothControlPoints(a,o,n);if(u&&2==u.length){var g=s[s.length-1].split(",");g[2]=u[0].x,g[3]=u[0].y,s[s.length-1]=g.join(","),o=u[1]}}s.push([o.x,o.y,l.x,l.y,d.x,d.y].join(",")),n=d,a=l}for(s.push("L");e<r;){var h=i.getItem(e);s.push([h.x,h.y].join(",")),e++}s=s.join(" "),t=C({element:"path",curStyles:!0,attr:{id:ut(),d:s,fill:"none"}})}return t};return{mouseDown:function(e,i,r,o){var l;if("path"!==current_mode&&"pipe"!==current_mode){if(svgedit.path.path){var g;if(svgedit.path.path.storeD(),l=e.target.id,"pathpointgrip_"==l.substr(0,14)){g=svgedit.path.path.cur_pt=parseInt(l.substr(14)),svgedit.path.path.dragging=[r,o];var h=svgedit.path.path.segs[g];e.shiftKey?h.selected?svgedit.path.path.removePtFromSelection(g):svgedit.path.path.addPtsToSelection(g):((svgedit.path.path.selected_pts.length<=1||!h.selected)&&svgedit.path.path.clearSelection(),svgedit.path.path.addPtsToSelection(g))}else if(0==l.indexOf("ctrlpointgrip_")){svgedit.path.path.dragging=[r,o];var m=l.split("_")[1].split("c");g=Number(m[0]);var c=Number(m[1]);svgedit.path.path.selectPt(g,c)}svgedit.path.path.dragging||(null==rubberBox&&(rubberBox=K.getRubberBandBox()),svgedit.utilities.assignAttributes(rubberBox,{x:r*v,y:o*v,width:0,height:0,display:"inline"},100))}}else{mouse_x=r,mouse_y=o;var p=mouse_x/v,f=mouse_y/v,y=svgedit.utilities.getElem("path_stretch_line");s=[p,f],a.gridSnapping&&(p=svgedit.utilities.snapToGrid(p),f=svgedit.utilities.snapToGrid(f),mouse_x=svgedit.utilities.snapToGrid(mouse_x),mouse_y=svgedit.utilities.snapToGrid(mouse_y)),y||(y=document.createElementNS(n.SVG,"path"),svgedit.utilities.assignAttributes(y,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"}),y=svgedit.utilities.getElem("selectorParentGroup").appendChild(y)),y.setAttribute("display","inline");var x,S=null;if(u){for(var w=u.pathSegList,_=w.numberOfItems,N=6/v,A=!1;_;){_--;var k=w.getItem(_),E=k.x,B=k.y;if(p>=E-N&&p<=E+N&&f>=B-N&&f<=B+N){A=!0;break}}l=ut(),svgedit.path.removePath_(l);var T,I,G=svgedit.utilities.getElem(l),M=w.numberOfItems;if(A){if(_<=1&&M>=2&&"pipe"!==current_mode){var L=w.getItem(0).x,P=w.getItem(0).y;I=y.pathSegList.getItem(1),T=4===I.pathSegType?u.createSVGPathSegLinetoAbs(L,P):u.createSVGPathSegCurvetoCubicAbs(L,P,I.x1/v,I.y1/v,L,P);var O=u.createSVGPathSegClosePath();w.appendItem(T),w.appendItem(O)}else if(M<3&&"pipe"!==current_mode)return S=!1,S;if($(y).remove(),element=G,u=null,started=!1,d){svgedit.path.path.matrix&&svgedit.coords.remapElement(G,{},svgedit.path.path.matrix.inverse());var D=G.getAttribute("d"),V=$(svgedit.path.path.elem).attr("d");return $(svgedit.path.path.elem).attr("d",V+D),$(G).remove(),svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath(),svgedit.path.path.init(),mt.toEditMode(svgedit.path.path.elem),svgedit.path.path.selectPt(),!1}}else{if(!$.contains(t,Et(e)))return console.log("Clicked outside canvas"),!1;var R=u.pathSegList.numberOfItems,U=u.pathSegList.getItem(R-1),z=U.x,F=U.y;if(e.shiftKey){var j=svgedit.math.snapToAngle(z,F,p,f);p=j.x,f=j.y}I=y.pathSegList.getItem(1),T=4===I.pathSegType?u.createSVGPathSegLinetoAbs(lt(p),lt(f)):u.createSVGPathSegCurvetoCubicAbs(lt(p),lt(f),I.x1/v,I.y1/v,I.x2/v,I.y2/v),u.pathSegList.appendItem(T),p*=v,f*=v,y.setAttribute("d",["M",p,f,p,f].join(" ")),x=R,d&&(x+=svgedit.path.path.segs.length),svgedit.path.addPointGrip(x,p,f)}}else{if(d_attr="M"+p+","+f+" ",path_attr={d:d_attr,id:gt(),opacity:b.opacity/2},"pipe"===current_mode){var H=gt().replace("svg_","PIE_");path_attr={d:d_attr,id:H,type:"svg-ext-pipe",fill:"rgba(0,0,0,0)",stroke:"rgba(41,171,226,1)","stroke-width":10,opacity:b.opacity/2}}u=C({element:"path",curStyles:!0,attr:path_attr}),y.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" ")),x=d?svgedit.path.path.segs.length:0,svgedit.path.addPointGrip(x,mouse_x,mouse_y)}}},mouseMove:function(t,e){if(g=!0,"path"!==current_mode&&"pipe"!==current_mode)if(svgedit.path.path.dragging){var i=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path),r=svgedit.path.getPointFromGrip({x:t,y:e},svgedit.path.path),n=r.x-i.x,a=r.y-i.y;svgedit.path.path.dragging=[t,e],svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(n,a):svgedit.path.path.movePts(n,a)}else svgedit.path.path.selected_pts=[],svgedit.path.path.eachSeg(function(t){var e=this;if(e.next||e.prev){e.item;var i=rubberBox.getBBox(),r=svgedit.path.getGripPt(e),n={x:r.x,y:r.y,width:0,height:0},a=svgedit.math.rectsIntersect(i,n);this.select(a),a&&svgedit.path.path.selected_pts.push(e.index)}});else{if(!u)return;var o=u.pathSegList,d=o.numberOfItems-1;if(s){var h=svgedit.path.addCtrlGrip("1c1"),m=svgedit.path.addCtrlGrip("0c2");h.setAttribute("cx",t),h.setAttribute("cy",e),h.setAttribute("display","inline");var c=s[0],p=s[1],f=(o.getItem(d),t/v),y=e/v,x=c+(c-f),b=p+(p-y);m.setAttribute("cx",x*v),m.setAttribute("cy",b*v),m.setAttribute("display","inline");var S=svgedit.path.getCtrlLine(1);if(svgedit.utilities.assignAttributes(S,{x1:t,y1:e,x2:x*v,y2:b*v,display:"inline"}),0===d)l=[t,e];else{var C=o.getItem(d-1),w=C.x,_=C.y;6===C.pathSegType?(w+=w-C.x2,_+=_-C.y2):l&&(w=l[0]/v,_=l[1]/v),svgedit.path.replacePathSeg(6,d,[c,p,w,_,x,b],u)}}else{var N=svgedit.utilities.getElem("path_stretch_line");if(N){var A=o.getItem(d);if(6===A.pathSegType){var k=A.x+(A.x-A.x2),E=A.y+(A.y-A.y2);svgedit.path.replacePathSeg(6,1,[t,e,k*v,E*v,t,e],N)}else l?svgedit.path.replacePathSeg(6,1,[t,e,l[0],l[1],t,e],N):svgedit.path.replacePathSeg(4,1,[t,e],N)}}}},mouseUp:function(t,e,i,r){if("path"===current_mode||"pipe"===current_mode){if(s=null,!u){var n=ut();"pipe"===current_mode&&(n=n.replace("svg_","PIE_")),e=svgedit.utilities.getElem(n),started=!1,l=null}return{keep:!0,element:e}}if(svgedit.path.path.dragging){var a=svgedit.path.path.cur_pt;svgedit.path.path.dragging=!1,svgedit.path.path.dragctrl=!1,svgedit.path.path.update(),g&&svgedit.path.path.endChanges("Move path point(s)"),t.shiftKey||g||svgedit.path.path.selectPt(a)}else rubberBox&&"none"!=rubberBox.getAttribute("display")?(rubberBox.setAttribute("display","none"),rubberBox.getAttribute("width")<=2&&rubberBox.getAttribute("height")<=2&&mt.toSelectMode(t.target)):mt.toSelectMode(t.target);g=!1},toEditMode:function(t){svgedit.path.path=svgedit.path.getPath_(t),current_mode="pathedit",Nt(),svgedit.path.path.show(!0).update(),svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem),d=!1},toSelectMode:function(t){var e=t==svgedit.path.path.elem;current_mode="select",svgedit.path.path.show(!1),i=!1,Nt(),svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath(),e&&(D("selected",[t]),At([t],!0))},addSubPath:function(t){t?(current_mode="path",d=!0):(mt.clear(!0),mt.toEditMode(svgedit.path.path.elem))},select:function(t){i===t?(mt.toEditMode(t),current_mode="pathedit"):i=t},reorient:function(){var t=S[0];if(t){var e=svgedit.utilities.getRotationAngle(t);if(0!=e){var i=new svgedit.history.BatchCommand("Reorient path"),r={d:t.getAttribute("d"),transform:t.getAttribute("transform")};i.addSubCommand(new svgedit.history.ChangeElementCommand(t,r)),Nt(),this.resetOrientation(t),W(i),svgedit.path.getPath_(t).show(!1).matrix=null,this.clear(),At([t],!0),D("changed",S)}}},clear:function(t){if(i=null,u){var e=svgedit.utilities.getElem(ut());$(svgedit.utilities.getElem("path_stretch_line")).remove(),$(e).remove(),$(svgedit.utilities.getElem("pathpointgrip_container")).find("*").attr("display","none"),u=l=null,started=!1}else"pathedit"==current_mode&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(!1)},resetOrientation:function(t){if(null==t||"path"!=t.nodeName)return!1;var e=svgedit.transformlist.getTransformList(t),i=svgedit.math.transformListToTransform(e).matrix;e.clear(),t.removeAttribute("transform");var n,a=t.pathSegList,s=a.numberOfItems;for(n=0;n<s;++n){var o=a.getItem(n),l=o.pathSegType;if(1!=l){var d=[];$.each(["",1,2],function(t,e){var r=o["x"+e],n=o["y"+e];if(void 0!==r&&void 0!==n){var a=svgedit.math.transformPoint(r,n,i);d.splice(d.length,0,a.x,a.y)}}),svgedit.path.replacePathSeg(l,n,d,t)}}r(t,i)},zoomChange:function(){"pathedit"==current_mode&&svgedit.path.path.update()},getNodePoint:function(){var t=svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1,e=svgedit.path.path.segs[t];return{x:e.item.x,y:e.item.y,type:e.type}},linkControlPoints:function(t){svgedit.path.setLinkControlPoints(t)},clonePathNode:function(){svgedit.path.path.storeD();for(var t=svgedit.path.path.selected_pts,e=(svgedit.path.path.segs,t.length),i=[];e--;){var r=t[e];svgedit.path.path.addSeg(r),i.push(r+e),i.push(r+e+1)}svgedit.path.path.init().addPtsToSelection(i),svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var t=svgedit.path.path.selected_pts;if(1===t.length){var e=svgedit.path.path.elem,i=e.pathSegList,r=(i.numberOfItems,t[0]),n=null,a=null;if(svgedit.path.path.eachSeg(function(t){return 2===this.type&&t<=r&&(a=this.item),t<=r||(2===this.type?(n=t,!1):1===this.type?(n=!1,!1):void 0)}),null==n&&(n=svgedit.path.path.segs.length-1),!1!==n){var s=e.createSVGPathSegLinetoAbs(a.x,a.y),o=e.createSVGPathSegClosePath();return n==svgedit.path.path.segs.length-1?(i.appendItem(s),i.appendItem(o)):(svgedit.path.insertItemBefore(e,o,n),svgedit.path.insertItemBefore(e,s,n)),void svgedit.path.path.init().selectPt(n+1)}var l,d,u,g=svgedit.path.path.segs[r];if(g.mate)return i.removeItem(r),i.removeItem(r),void svgedit.path.path.init().selectPt(r-1);for(l=0;l<i.numberOfItems;l++){var h=i.getItem(l);if(2===h.pathSegType)d=l;else if(l===r)i.removeItem(d);else if(1===h.pathSegType&&r<l){u=l-1,i.removeItem(l);break}}for(var m=r-d-1;m--;)svgedit.path.insertItemBefore(e,i.getItem(d),u);var c=i.getItem(d);svgedit.path.replacePathSeg(2,d,[c.x,c.y]),l=r,svgedit.path.path.init().selectPt(0)}},deletePathNode:function(){if(mt.canDeleteNodes){svgedit.path.path.storeD();for(var t=svgedit.path.path.selected_pts,e=t.length;e--;){var i=t[e];svgedit.path.path.deleteSeg(i)}var r=function(){var t=svgedit.path.path.elem.pathSegList,e=t.numberOfItems,i=function(e,i){for(;i--;)t.removeItem(e)};if(e<=1)return!0;for(;e--;){var n=t.getItem(e);if(1===n.pathSegType){var a=t.getItem(e-1),s=t.getItem(e-2);if(2===a.pathSegType){i(e-1,2),r();break}if(2===s.pathSegType){i(e-2,3),r();break}}else if(2===n.pathSegType&&e>0){var o=t.getItem(e-1).pathSegType;if(2===o){i(e-1,1),r();break}if(1===o&&t.numberOfItems-1===e){i(e,1),r();break}}}return!1};if(r(),svgedit.path.path.elem.pathSegList.numberOfItems<=1)return mt.toSelectMode(svgedit.path.path.elem),void o.deleteSelectedElements();if(svgedit.path.path.init(),svgedit.path.path.clearSelection(),window.opera){var n=$(svgedit.path.path.elem);n.attr("d",n.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}},smoothPolylineIntoPath:h,setSegType:function(t){svgedit.path.path.setSegType(t)},moveNode:function(t,e){var i=svgedit.path.path.selected_pts;if(i.length){svgedit.path.path.storeD();var r=svgedit.path.path.segs[i[0]],n={x:0,y:0};n[t]=e-r.item[t],r.move(n.x,n.y),svgedit.path.path.endChanges("Move path point")}},fixEnd:function(t){var i,r,n=t.pathSegList,a=n.numberOfItems;for(i=0;i<a;++i){var s=n.getItem(i);if(2===s.pathSegType&&(r=s),1===s.pathSegType){var o=n.getItem(i-1);if(o.x!=r.x||o.y!=r.y){var l=t.createSVGPathSegLinetoAbs(r.x,r.y);svgedit.path.insertItemBefore(t,l,i),mt.fixEnd(t);break}}}svgedit.browser.isWebkit()&&e(t)},convertPath:function(t,e){var i,r=t.pathSegList,n=r.numberOfItems,a=0,s=0,o="",l=null;for(i=0;i<n;++i){var d=r.getItem(i),u=d.x||0,g=d.y||0,h=d.x1||0,m=d.y1||0,c=d.x2||0,v=d.y2||0,p=d.pathSegType,f=Ct[p]["to"+(e?"Lower":"Upper")+"Case"](),y=function(t,e,i){e=e?" "+e.join(" "):"",i=i?" "+svgedit.units.shortFloat(i):"",$.each(t,function(e,i){t[e]=svgedit.units.shortFloat(i)}),o+=f+t.join(" ")+e+i};switch(p){case 1:o+="z";break;case 12:u-=a;case 13:e?(a+=u,f="l"):(u+=a,a=u,f="L"),y([[u,s]]);break;case 14:g-=s;case 15:e?(s+=g,f="l"):(g+=s,s=g,f="L"),y([[a,g]]);break;case 2:case 4:case 18:u-=a,g-=s;case 5:case 3:l&&1===r.getItem(i-1).pathSegType&&!e&&(a=l[0],s=l[1]);case 19:e?(a+=u,s+=g):(u+=a,g+=s,a=u,s=g),3===p&&(l=[a,s]),y([[u,g]]);break;case 6:u-=a,h-=a,c-=a,g-=s,m-=s,v-=s;case 7:e?(a+=u,s+=g):(u+=a,h+=a,c+=a,g+=s,m+=s,v+=s,a=u,s=g),y([[h,m],[c,v],[u,g]]);break;case 8:u-=a,h-=a,g-=s,m-=s;case 9:e?(a+=u,s+=g):(u+=a,h+=a,g+=s,m+=s,a=u,s=g),y([[h,m],[u,g]]);break;case 10:u-=a,g-=s;case 11:e?(a+=u,s+=g):(u+=a,g+=s,a=u,s=g),y([[d.r1,d.r2]],[d.angle,d.largeArcFlag?1:0,d.sweepFlag?1:0],[u,g]);break;case 16:u-=a,c-=a,g-=s,v-=s;case 17:e?(a+=u,s+=g):(u+=a,c+=a,g+=s,v+=s,a=u,s=g),y([[c,v],[u,g]])}}return o}}}();var Tt=this.removeUnusedDefElems=function(){var t=g.getElementsByTagNameNS(n.SVG,"defs");if(!t||!t.length)return 0;var e,i,r=[],a=0,s=["fill","stroke","filter","marker-start","marker-mid","marker-end"],o=s.length,l=g.getElementsByTagNameNS(n.SVG,"*"),d=l.length;for(e=0;e<d;e++){var u=l[e];for(i=0;i<o;i++){var h=svgedit.utilities.getUrlFromAttr(u.getAttribute(s[i]));h&&r.push(h.substr(1))}var m=T(u);m&&0===m.indexOf("#")&&r.push(m.substr(1))}var c=$(t).find("linearGradient, radialGradient, filter, marker, svg, symbol");for(e=c.length;e--;){var v=c[e],p=v.id;r.indexOf(p)<0&&(removedElements[p]=v,v.parentNode.removeChild(v),a++)}return a};this.svgCanvasToString=function(){for(;Tt()>0;);mt.clear(!0),$.each(g.childNodes,function(t,e){t&&8===e.nodeType&&e.data.indexOf("Created with")>=0&&g.insertBefore(e,g.firstChild)}),p&&(Pt(),kt([p]));var t=[];$(g).find("g:data(gsvg)").each(function(){var e,i=this.attributes,r=i.length;for(e=0;e<r;e++)"id"!=i[e].nodeName&&"style"!=i[e].nodeName||r--;if(r<=0){var n=this.firstChild;t.push(n),$(this).replaceWith(n)}});var e=this.svgToString(g,0);return t.length&&$(t).each(function(){yt(this)}),e},this.svgToString=function(t,e){var i=[],r=svgedit.utilities.toXml,s=a.baseUnit,o=new RegExp("^-?[\\d\\.]+"+s+"$"),l=["ngx-dygraphs"];if(t){if(l.indexOf(t.nodeName.toLowerCase())>=0)return i.join("");P(t);var d,u,g=t.attributes,h=t.childNodes;for(u=0;u<e;u++)i.push(" ");if(i.push("<"),i.push(t.nodeName),"svgcontent"===t.id){var m=Dt(),c="";"px"!==s&&(m.w=svgedit.units.convertUnit(m.w,s)+s,m.h=svgedit.units.convertUnit(m.h,s)+s),i.push(' width="'+m.w+'" height="'+m.h+'"'+c+' xmlns="'+n.SVG+'"');var v={};$(t).find("*").andSelf().each(function(){var t=this.namespaceURI;t&&!v[t]&&R[t]&&"xmlns"!==R[t]&&"xml"!==R[t]&&(v[t]=!0,i.push(" xmlns:"+R[t]+'="'+t+'"')),$.each(this.attributes,function(t,e){var r=e.namespaceURI;r&&!v[r]&&"xmlns"!==R[r]&&"xml"!==R[r]&&(v[r]=!0,i.push(" xmlns:"+R[r]+'="'+r+'"'))})}),u=g.length;for(var p=["width","height","xmlns","x","y","viewBox","id","overflow"];u--;){d=g.item(u);var f=r(d.value);0!==d.nodeName.indexOf("xmlns:")&&(""!=f&&-1==p.indexOf(d.localName)&&(d.namespaceURI&&!R[d.namespaceURI]||(i.push(" "),i.push(d.nodeName),i.push('="'),i.push(f),i.push('"'))))}}else{if("defs"===t.nodeName&&!t.firstChild)return;var y=["-moz-math-font-style","_moz-math-font-style"];for(u=g.length-1;u>=0;u--){d=g.item(u);f=r(d.value);if(!(y.indexOf(d.localName)>=0)&&""!=f){if(0===f.indexOf("pointer-events"))continue;if("class"===d.localName&&0===f.indexOf("se_"))continue;if(i.push(" "),"d"===d.localName&&(f=mt.convertPath(t,!1)),isNaN(f)?o.test(f)&&(f=svgedit.units.shortFloat(f)+s):f=svgedit.units.shortFloat(f),save_options.apply&&"image"===t.nodeName&&"href"===d.localName&&save_options.images&&"embed"===save_options.images){var x=et[f];x&&(f=x)}d.namespaceURI&&d.namespaceURI!=n.SVG&&!R[d.namespaceURI]||(i.push(d.nodeName),i.push('="'),i.push(f),i.push('"'))}}}if(t.hasChildNodes()){i.push(">"),e++;var b=!1;for(u=0;u<h.length;u++){var S=h.item(u);switch(S.nodeType){case 1:i.push("\n"),i.push(this.svgToString(h.item(u),e));break;case 3:var C=S.nodeValue.replace(/^\s+|\s+$/g,"");""!=C&&(b=!0,i.push(String(r(C))));break;case 4:i.push("\n"),i.push(new Array(e+1).join(" ")),i.push("<![CDATA["),i.push(S.nodeValue),i.push("]]>");break;case 8:i.push("\n"),i.push(new Array(e+1).join(" ")),i.push("<!--"),i.push(S.data),i.push("-->")}}if(e--,!b)for(i.push("\n"),u=0;u<e;u++)i.push(" ");i.push("</"),i.push(t.nodeName),i.push(">")}else"div"===t.nodeName.toLowerCase()||"span"===t.nodeName.toLowerCase()?(i.push(">"),i.push("</"),i.push(t.nodeName),i.push(">")):i.push("/>")}return i.join("")},this.embedImage=function(t,e){$(new Image).load(function(){var i=document.createElement("canvas");i.width=this.width,i.height=this.height,i.getContext("2d").drawImage(this,0,0);try{var r=";svgedit_url="+encodeURIComponent(t);r=i.toDataURL().replace(";base64",r+";base64"),et[t]=r}catch(e){et[t]=!1}it=t,e&&e(et[t])}).attr("src",t)},this.setGoodImage=function(t){it=t},this.setGoodSvgImageContent=function(t){rt=t},this.open=function(){},this.save=function(t){Nt(),t&&$.extend(save_options,t),save_options.apply=!0;var e=this.svgCanvasToString();D("saved",e)},this.rasterExport=function(t,e,r){var n="image/"+t.toLowerCase(),a=i(),s=this.svgCanvasToString();svgedit.utilities.buildCanvgCallback(function(){var i=t||"PNG";$("#export_canvas").length||$("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var o=$("#export_canvas")[0];o.width=svgCanvas.contentW,o.height=svgCanvas.contentH,canvg(o,s,{renderCallback:function(){var l=("ICO"===i?"BMP":i).toLowerCase(),d=e?o.toDataURL("image/"+l,e):o.toDataURL("image/"+l);D("exported",{datauri:d,svg:s,issues:a,type:t,mimeType:n,quality:e,exportWindowName:r})}})})()},this.exportPDF=function(t,e){var r=this;svgedit.utilities.buildJSPDFCallback(function(){var n=Dt(),a=n.w>n.h?"landscape":"portrait",s="pt",o=jsPDF({orientation:a,unit:s,format:[n.w,n.h]}),l=Vt();o.setProperties({title:l});var d=i(),u=r.svgCanvasToString();o.addSVG(u,0,0);var g={svg:u,issues:d,exportWindowName:t},h=e||"dataurlstring";g[h]=o.output(h),D("exportedPDF",g)})()},this.getSvgString=function(){return save_options.apply=!1,this.svgCanvasToString()},this.randomizeIds=function(t){arguments.length>0&&0==t?svgedit.draw.randomizeIds(!1,c()):svgedit.draw.randomizeIds(!0,c())};var It=this.uniquifyElems=function(t){var e,i={},r=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];for(e in svgedit.utilities.walkTree(t,function(t){if(1==t.nodeType){t.id&&(t.id in i||(i[t.id]={elem:null,attrs:[],hrefs:[]}),i[t.id].elem=t),$.each(Z,function(e,r){var n=t.getAttributeNode(r);if(n){var a=svgedit.utilities.getUrlFromAttr(n.value),s=a?a.substr(1):null;s&&(s in i||(i[s]={elem:null,attrs:[],hrefs:[]}),i[s].attrs.push(n))}});var e=svgedit.utilities.getHref(t);if(e&&r.indexOf(t.nodeName)>=0){var n=e.substr(1);n&&(n in i||(i[n]={elem:null,attrs:[],hrefs:[]}),i[n].hrefs.push(t))}}}),i)if(e){var n=i[e].elem;if(n){var a=gt();n.id=a;for(var s=i[e].attrs,o=s.length;o--;){var l=s[o];l.ownerElement.setAttribute(l.name,"url(#"+a+")")}for(var d=i[e].hrefs,u=d.length;u--;){var g=d[u];svgedit.utilities.setHref(g,"#"+a)}}}},Gt=this.setUseData=function(t){var e=$(t);"use"!==t.tagName&&(e=e.find("use")),e.each(function(){var t=T(this).substr(1),e=svgedit.utilities.getElem(t);e&&($(this).data("ref",e),"symbol"!=e.tagName&&"svg"!=e.tagName||$(this).data("symbol",e).data("ref",e))})},Mt=this.convertGradients=function(t){var e=$(t).find("linearGradient, radialGradient");!e.length&&svgedit.browser.isWebkit()&&(e=$(t).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0})),e.each(function(){var t=this;if("userSpaceOnUse"===$(t).attr("gradientUnits")){var e=$(g).find('[fill="url(#'+t.id+')"],[stroke="url(#'+t.id+')"]');if(!e.length)return;var i=svgedit.utilities.getBBox(e[0]);if(!i)return;if("linearGradient"===t.tagName){var r=$(t).attr(["x1","y1","x2","y2"]),n=t.gradientTransform.baseVal;if(n&&n.numberOfItems>0){var a=svgedit.math.transformListToTransform(n).matrix,s=svgedit.math.transformPoint(r.x1,r.y1,a),o=svgedit.math.transformPoint(r.x2,r.y2,a);r.x1=s.x,r.y1=s.y,r.x2=o.x,r.y2=o.y,t.removeAttribute("gradientTransform")}$(t).attr({x1:(r.x1-i.x)/i.width,y1:(r.y1-i.y)/i.height,x2:(r.x2-i.x)/i.width,y2:(r.y2-i.y)/i.height}),t.removeAttribute("gradientUnits")}}})},Lt=this.convertToGroup=function(t){t||(t=S[0]);var e,i=$(t),r=new svgedit.history.BatchCommand;if(i.data("gsvg")){var a=t.firstChild,s=$(a).attr(["x","y"]);$(t.firstChild.firstChild).unwrap(),$(t).removeData("gsvg");var o=svgedit.transformlist.getTransformList(t),l=u.createSVGTransform();l.setTranslate(s.x,s.y),o.appendItem(l),svgedit.recalculate.recalculateDimensions(t),D("selected",[t])}else if(i.data("symbol")){t=i.data("symbol"),e=i.attr("transform");var h=i.attr(["x","y"]),m=t.getAttribute("viewBox");if(m){var c=m.split(" ");h.x-=+c[0],h.y-=+c[1]}e+=" translate("+(h.x||0)+","+(h.y||0)+")";var v=i.prev();r.addSubCommand(new svgedit.history.RemoveElementCommand(i[0],i[0].nextSibling,i[0].parentNode)),i.remove();var p,f=$(g).find("use:data(symbol)").length,y=d.createElementNS(n.SVG,"g"),x=t.childNodes;for(p=0;p<x.length;p++)y.appendChild(x[p].cloneNode(!0));if(svgedit.browser.isGecko()){var b=$(svgedit.utilities.findDefs()).children("linearGradient,radialGradient,pattern").clone();$(y).append(b)}e&&y.setAttribute("transform",e);var C=t.parentNode;if(It(y),svgedit.browser.isGecko()&&$(E()).append($(y).find("linearGradient,radialGradient,pattern")),y.id=gt(),v.after(y),C){if(!f){var w=t.nextSibling;C.removeChild(t),r.addSubCommand(new svgedit.history.RemoveElementCommand(t,w,C))}r.addSubCommand(new svgedit.history.InsertElementCommand(y))}Gt(y),svgedit.browser.isGecko()?Mt(svgedit.utilities.findDefs()):Mt(y),svgedit.utilities.walkTreePost(y,function(t){try{svgedit.recalculate.recalculateDimensions(t)}catch(t){console.log(t)}}),$(y).find(Y).each(function(){this.id||(this.id=gt())}),kt([y]);var _=jt(y,!0);_&&r.addSubCommand(_),W(r)}else console.log("Unexpected element to ungroup:",t)};this.setSvgString=function(t){try{var e=svgedit.utilities.text2xml(t);this.prepareSvg(e);var i=new svgedit.history.BatchCommand("Change Source"),r=g.nextSibling,s=u.removeChild(g);i.addSubCommand(new svgedit.history.RemoveElementCommand(s,r,u)),g=d.adoptNode?d.adoptNode(e.documentElement):d.importNode(e.documentElement,!0),u.appendChild(g);var l=$(g);o.current_drawing_=new svgedit.draw.Drawing(g,m);var h=c().getNonce();h?D("setnonce",h):D("unsetnonce"),l.find("image").each(function(){var t=this;Bt(t);var e=T(this);if(e){if(0===e.indexOf("data:")){var i=e.match(/svgedit_url=(.*?);/);if(i){var r=decodeURIComponent(i[1]);$(new Image).load(function(){t.setAttributeNS(n.XLINK,"xlink:href",r)}).attr("src",r)}}o.embedImage(e)}}),l.find("svg").each(function(){if(!$(this).closest("defs").length){It(this);var t=this.parentNode;1===t.childNodes.length&&"g"===t.nodeName?($(t).data("gsvg",this),t.id=t.id||gt()):yt(this)}}),svgedit.browser.isGecko()&&l.find("linearGradient, radialGradient, pattern").appendTo(svgedit.utilities.findDefs()),Gt(l),Mt(l[0]),svgedit.utilities.walkTreePost(g,function(t){try{svgedit.recalculate.recalculateDimensions(t)}catch(t){console.log(t)}});var p={id:"svgcontent",overflow:a.show_outside_canvas?"visible":"hidden"},f=!1;if(l.attr("viewBox")){var y=l.attr("viewBox").split(" ");p.width=y[2],p.height=y[3]}else $.each(["width","height"],function(t,e){var i=l.attr(e);i||(i="100%"),"%"===String(i).substr(-1)?f=!0:p[e]=svgedit.units.convertToNum(e,i)});if($t(),l.children().find(Y).each(function(){this.id||(this.id=gt())}),f){var x=getStrokedBBox();p.width=x.width+x.x,p.height=x.height+x.y}p.width<=0&&(p.width=100),p.height<=0&&(p.height=100),l.attr(p),this.contentW=p.width,this.contentH=p.height,i.addSubCommand(new svgedit.history.InsertElementCommand(g));var b=l.attr(["width","height"]);i.addSubCommand(new svgedit.history.ChangeElementCommand(u,b)),v=1,svgedit.transformlist.resetListMap(),Nt(),svgedit.path.clearData(),u.appendChild(K.selectorParentGroup),W(i),D("changed",[g])}catch(t){return console.log(t),!1}return!0},this._importSvgString=function(t){var e,i;try{var r=svgedit.utilities.encode64(t.length+t).substr(0,32),a=!1;import_ids[r]&&$(import_ids[r].symbol).parents("#svgroot").length&&(a=!0);var s,o=new svgedit.history.BatchCommand("Import Image");if(a)s=import_ids[r].symbol,i=import_ids[r].xform;else{var l,u=svgedit.utilities.text2xml(t);this.prepareSvg(u),l=d.adoptNode?d.adoptNode(u.documentElement):d.importNode(u.documentElement,!0),It(l);var h=svgedit.units.convertToNum("width",l.getAttribute("width")),m=svgedit.units.convertToNum("height",l.getAttribute("height")),v=l.getAttribute("viewBox"),f=v?v.split(" "):[0,0,h,m];for(e=0;e<4;++e)f[e]=+f[e];g.getAttribute("width");var y=+g.getAttribute("height");i=m>h?"scale("+y/3/f[3]+")":"scale("+y/3/f[2]+")",i="translate(0) "+i+" translate(0)",s=d.createElementNS(n.SVG,"symbol");var x=svgedit.utilities.findDefs();for(svgedit.browser.isGecko()&&$(l).find("linearGradient, radialGradient, pattern").appendTo(x);l.firstChild;){var b=l.firstChild;s.appendChild(b)}var S,C=l.attributes;for(S=0;S<C.length;S++){var w=C[S];s.setAttribute(w.nodeName,w.value)}s.id=gt(),import_ids[r]={symbol:s,xform:i},svgedit.utilities.findDefs().appendChild(s),o.addSubCommand(new svgedit.history.InsertElementCommand(s))}var _=d.createElementNS(n.SVG,"use");_.id=gt(),I(_,"#"+s.id),(p||c().getCurrentLayer()).appendChild(_),o.addSubCommand(new svgedit.history.InsertElementCommand(_)),Nt(),_.setAttribute("transform",i),
svgedit.recalculate.recalculateDimensions(_),$(_).data("symbol",s).data("ref",s),At([_]),W(o),D("changed",[g])}catch(t){return console.log(t),!1}return!0},this.importSvgString=function(t,e){var i;try{var r,a,s=svgedit.utilities.encode64(t.length+t).substr(0,32),o=new svgedit.history.BatchCommand("Import Image"),l=svgedit.utilities.text2xml(t);for(this.prepareSvg(l),a=d.adoptNode?d.adoptNode(l.documentElement):d.importNode(l.documentElement,!0),It(a),r=d.createElementNS(n.SVG,"g");a.firstChild;){var u=a.firstChild;svgedit.utilities.walkTree(u,function(t){t.id=gt()}),r.appendChild(u)}r.id=gt(),r.setAttribute("type","svg-ext-shapes-image"),import_ids[s]={symbol:r,xform:i},(p||c().getCurrentLayer()).appendChild(r),o.addSubCommand(new svgedit.history.InsertElementCommand(r)),e&&e.x>0&&e.y>0&&r.setAttribute("transform","translate("+e.x+","+e.y+")"),setTimeout(function(){kt([r],!0)},500),W(o),D("changed",[g])}catch(t){return console.log(t),!1}return!0};var $t=o.identifyLayers=function(){Pt(),c().identifyLayers()};this.createLayer=function(t){var e=new svgedit.history.BatchCommand("Create Layer"),i=c().createLayer(t);e.addSubCommand(new svgedit.history.InsertElementCommand(i)),W(e),Nt(),D("changed",[i])},this.cloneLayer=function(t){var e=new svgedit.history.BatchCommand("Duplicate Layer"),i=d.createElementNS(n.SVG,"g"),r=d.createElementNS(n.SVG,"title");r.textContent=t,i.appendChild(r);var a=c().getCurrentLayer();$(a).after(i);var s,l=a.childNodes;for(s=0;s<l.length;s++){var u=l[s];"title"!=u.localName&&i.appendChild(xt(u))}Nt(),$t(),e.addSubCommand(new svgedit.history.InsertElementCommand(i)),W(e),o.setCurrentLayer(t),D("changed",[i])},this.deleteCurrentLayer=function(){var t=c().getCurrentLayer(),e=t.nextSibling,i=t.parentNode;if(t=c().deleteCurrentLayer(),t){var r=new svgedit.history.BatchCommand("Delete Layer");return r.addSubCommand(new svgedit.history.RemoveElementCommand(t,e,i)),W(r),Nt(),D("changed",[i]),!0}return!1},this.setCurrentLayer=function(t){var e=c().setCurrentLayer(svgedit.utilities.toXml(t));return e&&Nt(),e},this.renameCurrentLayer=function(t){var e,i=c();if(i.current_layer){var r=i.current_layer;if(!o.setCurrentLayer(t)){var n=new svgedit.history.BatchCommand("Rename Layer");for(e=0;e<i.getNumLayers()&&i.all_layers[e][1]!=r;++e);var a=i.getLayerName(e);i.all_layers[e][0]=svgedit.utilities.toXml(t);var s=r.childNodes.length;for(e=0;e<s;++e){var l=r.childNodes.item(e);if(l&&"title"==l.tagName){for(;l.firstChild;)l.removeChild(l.firstChild);return l.textContent=t,n.addSubCommand(new svgedit.history.ChangeElementCommand(l,{"#text":a})),W(n),D("changed",[r]),!0}}}i.current_layer=r}return!1},this.setCurrentLayerPosition=function(t){var e,i=c();if(i.current_layer&&t>=0&&t<i.getNumLayers()){for(e=0;e<i.getNumLayers()&&i.all_layers[e][1]!=i.current_layer;++e);if(e==i.getNumLayers())return!1;if(e!=t){var r=null,n=i.current_layer.nextSibling;return t>e?t<i.getNumLayers()-1&&(r=i.all_layers[t+1][1]):r=i.all_layers[t][1],g.insertBefore(i.current_layer,r),W(new svgedit.history.MoveElementCommand(i.current_layer,n,g)),$t(),o.setCurrentLayer(i.getLayerName(t)),!0}}return!1},this.setLayerVisibility=function(t,e){var i=c(),r=i.getLayerVisibility(t),n=i.setLayerVisibility(t,e);if(!n)return!1;var a=r?"inline":"none";return W(new svgedit.history.ChangeElementCommand(n,{display:a},"Layer Visibility")),n==i.getCurrentLayer()&&(Nt(),mt.clear()),!0},this.moveSelectedToLayer=function(t){var e,i=null,r=c();for(e=0;e<r.getNumLayers();++e)if(r.getLayerName(e)==t){i=r.all_layers[e][1];break}if(!i)return!1;var n=new svgedit.history.BatchCommand("Move Elements to Layer"),a=S;for(e=a.length;e--;){var s=a[e];if(s){var o=s.nextSibling,l=s.parentNode;i.appendChild(s),n.addSubCommand(new svgedit.history.MoveElementCommand(s,o,l))}}return W(n),!0},this.mergeLayer=function(t){var e=new svgedit.history.BatchCommand("Merge Layer"),i=c(),r=$(i.current_layer).prev()[0];if(r){var n=i.current_layer.childNodes,a=(n.length,i.current_layer.nextSibling);for(e.addSubCommand(new svgedit.history.RemoveElementCommand(i.current_layer,a,g));i.current_layer.firstChild;){var s=i.current_layer.firstChild;if("title"!=s.localName){var o=s.nextSibling;r.appendChild(s),e.addSubCommand(new svgedit.history.MoveElementCommand(s,o,i.current_layer))}else{var l=s.nextSibling;e.addSubCommand(new svgedit.history.RemoveElementCommand(s,l,i.current_layer)),i.current_layer.removeChild(s)}}return g.removeChild(i.current_layer),t||(Nt(),$t(),D("changed",[g]),W(e)),i.current_layer=r,e}},this.mergeAllLayers=function(){var t=new svgedit.history.BatchCommand("Merge all Layers"),e=c();for(e.current_layer=e.all_layers[e.getNumLayers()-1][1];$(g).children("g").length>1;)t.addSubCommand(o.mergeLayer(!0));Nt(),$t(),D("changed",[g]),W(t)};var Pt=this.leaveContext=function(){var t,e=disabled_elems.length;if(e){for(t=0;t<e;t++){var i=disabled_elems[t],r=J(i,"orig_opac");1!==r?i.setAttribute("opacity",r):i.removeAttribute("opacity"),i.setAttribute("style","pointer-events: inherit")}disabled_elems=[],Nt(!0),D("contextset",null)}p=null},Ot=this.setContext=function(t){Pt(),"string"==typeof t&&(t=svgedit.utilities.getElem(t)),p=t,$(t).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var t=this.getAttribute("opacity")||1;J(this,"orig_opac",t),this.setAttribute("opacity",.33*t),this.setAttribute("style","pointer-events: none"),disabled_elems.push(this)}),Nt(),D("contextset",p)};this.clear=function(){mt.clear(),Nt(),o.clearSvgContentElement(),o.current_drawing_=new svgedit.draw.Drawing(g),o.createLayer("Layer 1"),o.undoMgr.resetUndoStack(),K.initGroup(),rubberBox=K.getRubberBandBox(),D("cleared")},this.linkControlPoints=mt.linkControlPoints,this.getContentElem=function(){return g},this.getRootElem=function(){return u},this.getSelectedElems=function(){return S};var Dt=this.getResolution=function(){var t=g.getAttribute("width")/v,e=g.getAttribute("height")/v;return{w:t,h:e,zoom:v}};this.getZoom=function(){return v},this.getVersion=function(){return"svgcanvas.js ($Rev$)"},this.setUiStrings=function(t){$.extend(X,t.notification)},this.setConfig=function(t){$.extend(a,t)},this.getTitle=function(t){var e;if(t=t||S[0],t){t=$(t).data("gsvg")||$(t).data("symbol")||t;var i=t.childNodes;for(e=0;e<i.length;e++)if("title"==i[e].nodeName)return i[e].textContent;return""}},this.setGroupTitle=function(t){var e=S[0];e=$(e).data("gsvg")||e;var i=$(e).children("title"),r=new svgedit.history.BatchCommand("Set Label");if(t.length)if(i.length){var a=i[0];r.addSubCommand(new svgedit.history.ChangeElementCommand(a,{"#text":a.textContent})),a.textContent=t}else a=d.createElementNS(n.SVG,"title"),a.textContent=t,$(e).prepend(a),r.addSubCommand(new svgedit.history.InsertElementCommand(a));else{var s=i.nextSibling;r.addSubCommand(new svgedit.history.RemoveElementCommand(i[0],s,e)),i.remove()}W(r)};var Vt=this.getDocumentTitle=function(){return o.getTitle(g)};this.setDocumentTitle=function(t){var e,i=g.childNodes,r=!1,a="",s=new svgedit.history.BatchCommand("Change Image Title");for(e=0;e<i.length;e++)if("title"==i[e].nodeName){r=i[e],a=r.textContent;break}r||(r=d.createElementNS(n.SVG,"title"),g.insertBefore(r,g.firstChild)),t.length?r.textContent=t:r.parentNode.removeChild(r),s.addSubCommand(new svgedit.history.ChangeElementCommand(r,{"#text":a})),W(s)},this.getEditorNS=function(t){return t&&g.setAttribute("xmlns:se",n.SE),n.SE},this.setResolution=function(t,e){var i,r=Dt(),n=r.w,a=r.h;if("fit"==t){var s=getStrokedBBox();if(!s)return!1;i=new svgedit.history.BatchCommand("Fit Canvas to Content");var l=pt();At(l);var d=[],h=[];$.each(l,function(t,e){d.push(-1*s.x),h.push(-1*s.y)});var m=o.moveSelectedElements(d,h,!0);i.addSubCommand(m),Nt(),t=Math.round(s.width),e=Math.round(s.height)}if(t!=n||e!=a){var c=u.suspendRedraw(1e3);i||(i=new svgedit.history.BatchCommand("Change Image Dimensions")),t=svgedit.units.convertToNum("width",t),e=svgedit.units.convertToNum("height",e),g.setAttribute("width",t),g.setAttribute("height",e),this.contentW=t,this.contentH=e,i.addSubCommand(new svgedit.history.ChangeElementCommand(g,{width:n,height:a})),g.setAttribute("viewBox",[0,0,t/v,e/v].join(" ")),i.addSubCommand(new svgedit.history.ChangeElementCommand(g,{viewBox:["0 0",n,a].join(" ")})),W(i),u.unsuspendRedraw(c),D("changed",[g])}return!0},this.getOffset=function(){return $(g).attr(["x","y"])},this.setBBoxZoom=function(t,e,i){var r,n=.85,a=function(t){if(!t)return!1;var r=Math.round(e/t.width*100*n)/100,a=Math.round(i/t.height*100*n)/100,s=Math.min(r,a);return o.setZoom(s),{zoom:s,bbox:t}};if("object"==typeof t){if(r=t,0==r.width||0==r.height){var s=r.zoom?r.zoom:v*r.factor;return o.setZoom(s),{zoom:v,bbox:r}}return a(r)}switch(t){case"selection":if(!S[0])return;var l=$.map(S,function(t){if(t)return t});r=getStrokedBBox(l);break;case"canvas":var d=Dt();n=.95,r={width:d.w,height:d.h,x:0,y:0};break;case"content":r=getStrokedBBox();break;case"layer":r=getStrokedBBox(pt(c().getCurrentLayer()));break;default:return}return a(r)},this.setZoom=function(t){var e=Dt();g.setAttribute("viewBox","0 0 "+e.w/t+" "+e.h/t),v=t,$.each(S,function(t,e){e&&K.requestSelector(e).resize()}),mt.zoomChange(),nt("zoomChanged",t)},this.getMode=function(){return current_mode},this.setMode=function(t){mt.clear(!0),ht.clear(),cur_properties=S[0]&&"text"==S[0].nodeName?cur_text:b,current_mode=t},this.getColor=function(t){return cur_properties[t]},this.setColor=function(t,e,i){function r(t){"g"!=t.nodeName&&n.push(t)}b[t]=e,cur_properties[t+"_paint"]={type:"solidColor"};for(var n=[],a=S.length;a--;){var s=S[a];if(s)if("g"==s.tagName){var o=s.id.substr(0,3);if("GXP"===o)continue;"MTR"===o?svgedit.utilities.walkTree(s,function(e){e.hasAttribute(t)&&"sMTR"!=e.id.substr(0,4)&&n.push(e)}):["CPS","VLA","EHS","SHE"].includes(o)?svgedit.utilities.walkTree(s,function(e){e.hasAttribute(t)&&n.push(e)}):svgedit.utilities.walkTree(s,r)}else"fill"==t?"polyline"!=s.tagName&&"line"!=s.tagName&&n.push(s):n.push(s)}n.length>0&&(i?zt(t,e,n):(Ft(t,e,n),D("changed",n)))};var Rt=this.setGradient=function(t){if(cur_properties[t+"_paint"]&&"solidColor"!=cur_properties[t+"_paint"].type){var e=o[t+"Grad"],i=Ut(e),r=svgedit.utilities.findDefs();if(i)e=i;else{e=r.appendChild(d.importNode(e,!0)),e.id=gt()}o.setColor(t,"url(#"+e.id+")")}},Ut=function(t){for(var e=svgedit.utilities.findDefs(),i=$(e).find("linearGradient, radialGradient"),r=i.length,a=["r","cx","cy","fx","fy"];r--;){var s=i[r];if("linearGradient"==t.tagName){if(t.getAttribute("x1")!=s.getAttribute("x1")||t.getAttribute("y1")!=s.getAttribute("y1")||t.getAttribute("x2")!=s.getAttribute("x2")||t.getAttribute("y2")!=s.getAttribute("y2"))continue}else{var o=$(t).attr(a),l=$(s).attr(a),d=!1;if($.each(a,function(t,e){o[e]!=l[e]&&(d=!0)}),d)continue}var u=t.getElementsByTagNameNS(n.SVG,"stop"),g=s.getElementsByTagNameNS(n.SVG,"stop");if(u.length==g.length){for(var h=u.length;h--;){var m=u[h],c=g[h];if(m.getAttribute("offset")!=c.getAttribute("offset")||m.getAttribute("stop-opacity")!=c.getAttribute("stop-opacity")||m.getAttribute("stop-color")!=c.getAttribute("stop-color"))break}if(-1==h)return s}}return null};this.setPaint=function(t,e){var i=new $.jGraduate.Paint(e);switch(this.setPaintOpacity(t,i.alpha/100,!0),cur_properties[t+"_paint"]=i,i.type){case"solidColor":-1===i.solidColor.indexOf("rgb")?this.setColor(t,"none"!=i.solidColor?"#"+i.solidColor:"none"):this.setColor(t,i.solidColor);break;case"linearGradient":case"radialGradient":o[t+"Grad"]=i[i.type],Rt(t)}},this.setStrokePaint=function(t){this.setPaint("stroke",t)},this.setFillPaint=function(t){this.setPaint("fill",t)},this.getStrokeWidth=function(){return cur_properties.stroke_width},this.setStrokeWidth=function(t){function e(t){"g"!=t.nodeName&&i.push(t)}if(0==t&&["line","path"].indexOf(current_mode)>=0)o.setStrokeWidth(1);else{cur_properties.stroke_width=t;for(var i=[],r=S.length;r--;){var n=S[r];n&&("g"==n.tagName?svgedit.utilities.walkTree(n,e):i.push(n))}i.length>0&&(Ft("stroke-width",t,i),D("changed",S))}},this.setStrokeAttr=function(t,e){b[t.replace("-","_")]=e;for(var i=[],r=S.length;r--;){var n=S[r];n&&("g"==n.tagName?svgedit.utilities.walkTree(n,function(t){"g"!=t.nodeName&&i.push(t)}):i.push(n))}i.length>0&&(Ft(t,e,i),D("changed",S))},this.getStyle=function(){return b},this.getOpacity=function(){return b.opacity},this.setOpacity=function(t){b.opacity=t,Ft("opacity",t)},this.getFillOpacity=function(){return b.fill_opacity},this.getStrokeOpacity=function(){return b.stroke_opacity},this.setPaintOpacity=function(t,e,i){b[t+"_opacity"]=e,i?zt(t+"-opacity",e):Ft(t+"-opacity",e)},this.getPaintOpacity=function(t){return"fill"===t?this.getFillOpacity():this.getStrokeOpacity()},this.getBlur=function(t){var e=0;if(t){var i=t.getAttribute("filter");if(i){var r=svgedit.utilities.getElem(t.id+"_blur");r&&(e=r.firstChild.getAttribute("stdDeviation"))}}return e},function(){function t(){var t=o.undoMgr.finishUndoableChange();e.addSubCommand(t),W(e),e=null,i=null}var e=null,i=null,r=!1;o.setBlurNoUndo=function(t){if(i)if(0===t)zt("filter",""),r=!0;else{var e=S[0];r&&zt("filter","url(#"+e.id+"_blur)"),svgedit.browser.isWebkit()&&(console.log("e",e),e.removeAttribute("filter"),e.setAttribute("filter","url(#"+e.id+"_blur)")),zt("stdDeviation",t,[i.firstChild]),o.setBlurOffsets(i,t)}else o.setBlur(t)},o.setBlurOffsets=function(t,e){e>3?svgedit.utilities.assignAttributes(t,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100):svgedit.browser.isWebkit()||(t.removeAttribute("x"),t.removeAttribute("y"),t.removeAttribute("width"),t.removeAttribute("height"))},o.setBlur=function(r,n){if(e)t();else{var a=S[0],s=a.id;i=svgedit.utilities.getElem(s+"_blur"),r-=0;var l=new svgedit.history.BatchCommand;if(i)0===r&&(i=null);else{var d=C({element:"feGaussianBlur",attr:{in:"SourceGraphic",stdDeviation:r}});i=C({element:"filter",attr:{id:s+"_blur"}}),i.appendChild(d),svgedit.utilities.findDefs().appendChild(i),l.addSubCommand(new svgedit.history.InsertElementCommand(i))}var u={filter:a.getAttribute("filter")};if(0===r)return a.removeAttribute("filter"),void l.addSubCommand(new svgedit.history.ChangeElementCommand(a,u));Ft("filter","url(#"+s+"_blur)"),l.addSubCommand(new svgedit.history.ChangeElementCommand(a,u)),o.setBlurOffsets(i,r),e=l,o.undoMgr.beginUndoableChange("stdDeviation",[i?i.firstChild:null]),n&&(o.setBlurNoUndo(r),t())}}}(),this.getBold=function(){var t=S[0];return null!=t&&"text"==t.tagName&&null==S[1]&&"bold"==t.getAttribute("font-weight")},this.setBold=function(t){var e=S[0];null!=e&&"text"==e.tagName&&null==S[1]&&Ft("font-weight",t?"bold":"normal"),S[0].textContent||ht.setCursor()},this.getItalic=function(){var t=S[0];return null!=t&&"text"==t.tagName&&null==S[1]&&"italic"==t.getAttribute("font-style")},this.setItalic=function(t){var e=S[0];null!=e&&"text"==e.tagName&&null==S[1]&&Ft("font-style",t?"italic":"normal"),S[0].textContent||ht.setCursor()},this.getFontFamily=function(){return cur_text.font_family},this.setFontFamily=function(t){cur_text.font_family=t,Ft("font-family",t),S[0]&&!S[0].textContent&&ht.setCursor(),nt("setFontAttribute",{elem:S[0],attr:"font-family",value:t})},this.setTextAlign=function(t){cur_text.text_anchor=t,Ft("text-anchor",t),S[0]&&!S[0].textContent&&ht.setCursor(),nt("setFontAttribute",{elem:S[0],attr:"text-anchor",value:t})},this.setFontColor=function(t){cur_text.fill=t,Ft("fill",t)},this.getFontColor=function(){return cur_text.fill},this.getFontSize=function(){return cur_text.font_size},this.setFontSize=function(t){cur_text.font_size=t,Ft("font-size",t),S[0].textContent||ht.setCursor(),nt("setFontAttribute",{elem:S[0],attr:"font-size",value:t+"px"})},this.getExtensionFont=function(t){return st("getFontAttribute",{elem:t})},this.getText=function(){var t=S[0];return null==t?"":t.textContent},this.setTextContent=function(t){Ft("#text",t),ht.init(t),ht.setCursor()},this.setImageURL=function(t){var e=S[0];if(e){var i=$(e).attr(["width","height"]),r=!i.width||!i.height,n=T(e);if(n!==t)r=!0;else if(!r)return;var a=new svgedit.history.BatchCommand("Change Image URL");I(e,t),a.addSubCommand(new svgedit.history.ChangeElementCommand(e,{"#href":n})),r?$(new Image).load(function(){var t=$(e).attr(["width","height"]);$(e).attr({width:this.width,height:this.height}),K.requestSelector(e).resize(),a.addSubCommand(new svgedit.history.ChangeElementCommand(e,t)),W(a),D("changed",[e])}).attr("src",t):W(a)}},this.setLinkURL=function(t){var e=S[0];if(e){if("a"!==e.tagName){var i=$(e).parents("a");if(!i.length)return;e=i[0]}var r=T(e);if(r!==t){var n=new svgedit.history.BatchCommand("Change Link URL");I(e,t),n.addSubCommand(new svgedit.history.ChangeElementCommand(e,{"#href":r})),W(n)}}},this.setRectRadius=function(t){var e=S[0];if(null!=e&&"rect"==e.tagName){var i=e.getAttribute("rx");i!=t&&(e.setAttribute("rx",t),e.setAttribute("ry",t),W(new svgedit.history.ChangeElementCommand(e,{rx:i,ry:i},"Radius")),D("changed",[e]))}},this.makeHyperlink=function(t){o.groupSelectedElements("a",t)},this.removeHyperlink=function(){o.ungroupSelectedElement()},this.setSegType=function(t){mt.setSegType(t)},this.convertToPath=function(t,e){if(null!=t){if(!e)var i=new svgedit.history.BatchCommand("Convert element to Path");var r=e?{}:{fill:b.fill,"fill-opacity":b.fill_opacity,stroke:b.stroke,"stroke-width":b.stroke_width,"stroke-dasharray":b.stroke_dasharray,"stroke-linejoin":b.stroke_linejoin,"stroke-linecap":b.stroke_linecap,"stroke-opacity":b.stroke_opacity,opacity:b.opacity,visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){t.getAttribute(this)&&(r[this]=t.getAttribute(this))});var n=C({element:"path",attr:r}),a=t.getAttribute("transform");a&&n.setAttribute("transform",a);var s=t.id,l=t.parentNode;t.nextSibling?l.insertBefore(n,t):l.appendChild(n);var d,u,g="",h=function(t){$.each(t,function(t,e){var i,r=e[0],n=e[1];for(g+=r,i=0;i<n.length;i+=2)g+=n[i]+","+n[i+1]+" "})},m=1.81;switch(t.tagName){case"ellipse":case"circle":d=$(t).attr(["rx","ry","cx","cy"]);var c=d.cx,v=d.cy;u=d.rx,ry=d.ry,"circle"==t.tagName&&(u=ry=$(t).attr("r")),h([["M",[c-u,v]],["C",[c-u,v-ry/m,c-u/m,v-ry,c,v-ry]],["C",[c+u/m,v-ry,c+u,v-ry/m,c+u,v]],["C",[c+u,v+ry/m,c+u/m,v+ry,c,v+ry]],["C",[c-u/m,v+ry,c-u,v+ry/m,c-u,v]],["Z",[]]]);break;case"path":g=t.getAttribute("d");break;case"line":d=$(t).attr(["x1","y1","x2","y2"]),g="M"+d.x1+","+d.y1+"L"+d.x2+","+d.y2;break;case"polyline":case"polygon":g="M"+t.getAttribute("points");break;case"rect":var p=$(t).attr(["rx","ry"]);u=p.rx,ry=p.ry;var f=t.getBBox(),y=f.x,x=f.y,w=f.width,_=f.height;m=4-m,u||ry?h([["M",[y,x+ry]],["C",[y,x+ry/m,y+u/m,x,y+u,x]],["L",[y+w-u,x]],["C",[y+w-u/m,x,y+w,x+ry/m,y+w,x+ry]],["L",[y+w,x+_-ry]],["C",[y+w,x+_-ry/m,y+w-u/m,x+_,y+w-u,x+_]],["L",[y+u,x+_]],["C",[y+u/m,x+_,y,x+_-ry/m,y,x+_-ry]],["L",[y,x+ry]],["Z",[]]]):h([["M",[y,x]],["L",[y+w,x]],["L",[y+w,x+_]],["L",[y,x+_]],["L",[y,x]],["Z",[]]]);break;default:n.parentNode.removeChild(n)}if(g&&n.setAttribute("d",g),e){mt.resetOrientation(n);var N=!1;try{N=n.getBBox()}catch(t){}return n.parentNode.removeChild(n),N}if(a){var A=svgedit.transformlist.getTransformList(n);svgedit.math.hasMatrixTransform(A)&&mt.resetOrientation(n)}var k=t.nextSibling;i.addSubCommand(new svgedit.history.RemoveElementCommand(t,k,l)),i.addSubCommand(new svgedit.history.InsertElementCommand(n)),Nt(),t.parentNode.removeChild(t),n.setAttribute("id",s),n.removeAttribute("visibility"),At([n],!0),W(i)}else{$.each(S,function(t,e){e&&o.convertToPath(e)})}};var zt=function(t,e,i){var r=u.suspendRedraw(1e3);"pathedit"==current_mode&&mt.moveNode(t,e),i=i||S;for(var n=i.length,a=["g","polyline","path"],s=["transform","opacity","filter"];n--;){var l=i[n];if(null!=l)if(("x"===t||"y"===t)&&a.indexOf(l.tagName)>=0){var d=getStrokedBBox([l]),g="x"===t?e-d.x:0,h="y"===t?e-d.y:0;o.moveSelectedElements(g*v,h*v,!0)}else{"g"===l.tagName&&s.indexOf(t);var m="#text"===t?l.textContent:l.getAttribute(t);if(null==m&&(m=""),m!==String(e)){if("#text"==t){svgedit.utilities.getBBox(l).width;l.textContent=e,/rotate/.test(l.getAttribute("transform"))&&(l=bt(l))}else"#href"==t?I(l,e):(l.setAttribute(t,e),nt("setGaugeAttribute",{elem:l,attr:t,value:e}));"textedit"===current_mode&&"#text"!==t&&l.textContent.length&&ht.toSelectMode(l),svgedit.browser.isGecko()&&"text"===l.nodeName&&/rotate/.test(l.getAttribute("transform"))&&(0===String(e).indexOf("url")||["font-size","font-family","x","y"].indexOf(t)>=0&&l.textContent)&&(l=bt(l)),S.indexOf(l)>=0&&setTimeout(function(){l.parentNode&&K.requestSelector(l).resize()},0);var c=svgedit.utilities.getRotationAngle(l);if(0!=c&&"transform"!=t)for(var p=svgedit.transformlist.getTransformList(l),f=p.numberOfItems;f--;){var y=p.getItem(f);if(4==y.type){p.removeItem(f);var x=svgedit.utilities.getBBox(l),b=svgedit.math.transformPoint(x.x+x.width/2,x.y+x.height/2,svgedit.math.transformListToTransform(p).matrix),C=b.x,w=b.y,_=u.createSVGTransform();_.setRotate(c,C,w),p.insertItemBefore(_,f);break}}}}}u.unsuspendRedraw(r)},Ft=this.changeSelectedAttribute=function(t,e,i){i=i||S,1===i.length&&l&&l.indexOf(i[0].id.substr(0,4))>=0&&(i=i[0].childNodes),o.undoMgr.beginUndoableChange(t,i);i.length;zt(t,e,i);var r=o.undoMgr.finishUndoableChange();r.isEmpty()||W(r)};this.deleteSelectedElements=function(){var t,e=new svgedit.history.BatchCommand("Delete Elements"),i=S.length,r=[];for(t=0;t<i;++t){var n=S[t];if(null==n)break;var a=n.parentNode,s=n;K.releaseSelector(s),svgedit.path.removePath_(s.id),"a"===a.tagName&&1===a.childNodes.length&&(s=a,a=a.parentNode);var o=s.nextSibling,l=a.removeChild(s);r.push(n),S[t]=null,e.addSubCommand(new j(l,o,a))}return e.isEmpty()||W(e),D("changed",r),Nt(),r},this.cutSelectedElements=function(){var t,e=new svgedit.history.BatchCommand("Cut Elements"),i=S.length,r=[];for(t=0;t<i;++t){var n=S[t];if(null==n)break;var a=n.parentNode,s=n;K.releaseSelector(s),svgedit.path.removePath_(s.id);var l=s.nextSibling,d=a.removeChild(s);r.push(n),S[t]=null,e.addSubCommand(new j(d,l,a))}e.isEmpty()||W(e),D("changed",r),Nt(),o.clipBoard=r},this.copySelectedElements=function(){o.clipBoard=$.merge([],S)},this.pasteElements=function(t,e,i){var r=o.clipBoard,n=r.length;if(n){for(var a=[],s=new svgedit.history.BatchCommand("Paste elements");n--;){var l=r[n];if(l){var d=xt(l);a.push(d),(p||c().getCurrentLayer()).appendChild(d),s.addSubCommand(new svgedit.history.InsertElementCommand(d))}}if(kt(a),"in_place"!==t){var u,g;t?"point"===t&&(u=e,g=i):(u=lastClickPoint.x,g=lastClickPoint.y);var h=getStrokedBBox(a),m=u-(h.x+h.width/2),v=g-(h.y+h.height/2),f=[],y=[];$.each(a,function(t,e){f.push(m),y.push(v)});var x=o.moveSelectedElements(f,y,!1);s.addSubCommand(x)}W(s),D("onGaugeCopyPaste",{copy:r,past:a.reverse()}),D("changed",a)}},this.groupSelectedElements=function(t,e){t||(t="g");var i="";switch(t){case"a":i="Make hyperlink";var r="";arguments.length>1&&(r=e);break;default:t="g",i="Group Elements"}var n=new svgedit.history.BatchCommand(i),a=C({element:t,attr:{id:gt()}});"a"===t&&I(a,r),n.addSubCommand(new svgedit.history.InsertElementCommand(a));for(var s=S.length;s--;){var o=S[s];if(null!=o){"a"===o.parentNode.tagName&&1===o.parentNode.childNodes.length&&(o=o.parentNode);var l=o.nextSibling,d=o.parentNode;a.appendChild(o),n.addSubCommand(new svgedit.history.MoveElementCommand(o,l,d))}}n.isEmpty()||W(n),kt([a],!0)};var jt=this.pushGroupProperties=function(t,e){var i,r,n,a=t.childNodes,s=a.length,l=t.getAttribute("transform"),d=svgedit.transformlist.getTransformList(t),g=svgedit.math.transformListToTransform(d).matrix,h=new svgedit.history.BatchCommand("Push group properties"),m=0,c=svgedit.utilities.getRotationAngle(t),v=$(t).attr(["filter","opacity"]);for(m=0;m<s;m++){var p=a[m];if(1===p.nodeType){if(null!==v.opacity&&1!==v.opacity){p.getAttribute("opacity");var f=Math.round((p.getAttribute("opacity")||1)*v.opacity*100)/100;Ft("opacity",f,[p])}if(v.filter){var y=this.getBlur(p),x=y;r||(r=this.getBlur(t)),y?y=Number(r)+Number(y):0===y&&(y=r),x?i=svgedit.utilities.getRefElem(p.getAttribute("filter")):i?(i=xt(i),svgedit.utilities.findDefs().appendChild(i)):i=svgedit.utilities.getRefElem(v.filter);var b="feGaussianBlur"===i.firstChild.tagName?"blur":"filter";i.id=p.id+"_"+b,Ft("filter","url(#"+i.id+")",[p]),y&&(Ft("stdDeviation",y,[i.firstChild]),o.setBlurOffsets(i,y))}var S=svgedit.transformlist.getTransformList(p);if(~p.tagName.indexOf("Gradient")&&(S=null),S&&"defs"!==p.tagName&&d.numberOfItems){if(c&&1==d.numberOfItems){var C=d.getItem(0).matrix,w=u.createSVGMatrix(),_=svgedit.utilities.getRotationAngle(p);_&&(w=S.getItem(0).matrix);var N=svgedit.utilities.getBBox(p),A=svgedit.math.transformListToTransform(S).matrix,k=svgedit.math.transformPoint(N.x+N.width/2,N.y+N.height/2,A),E=c+_,B=u.createSVGTransform();B.setRotate(E,k.x,k.y);var T=svgedit.math.matrixMultiply(C,w,B.matrix.inverse());if(_&&S.removeItem(0),E&&(S.numberOfItems?S.insertItemBefore(B,0):S.appendItem(B)),T.e||T.f){var I=u.createSVGTransform();I.setTranslate(T.e,T.f),S.numberOfItems?S.insertItemBefore(I,0):S.appendItem(I)}}else{var G=p.getAttribute("transform");n={},n.transform=G||"";var M=u.createSVGTransform(),L=svgedit.math.transformListToTransform(S).matrix,P=L.inverse(),O=svgedit.math.matrixMultiply(P,g,L);M.setMatrix(O),S.appendItem(M)}var D=svgedit.recalculate.recalculateDimensions(p);D&&h.addSubCommand(D)}}}if(l&&(n={},n.transform=l,t.setAttribute("transform",""),t.removeAttribute("transform"),h.addSubCommand(new svgedit.history.ChangeElementCommand(t,n))),e&&!h.isEmpty())return h};this.ungroupSelectedElement=function(){var t=S[0];if(t)if($(t).data("gsvg")||$(t).data("symbol"))Lt(t);else{if("use"===t.tagName){var e=svgedit.utilities.getElem(T(t).substr(1));return $(t).data("symbol",e).data("ref",e),void Lt(t)}var i=$(t).parents("a");if(i.length&&(t=i[0]),"g"===t.tagName||"a"===t.tagName){var r=new svgedit.history.BatchCommand("Ungroup Elements"),n=jt(t,!0);n&&r.addSubCommand(n);for(var a=t.parentNode,s=t.nextSibling,o=new Array(t.childNodes.length),l=0;t.firstChild;){var d=t.firstChild,u=d.nextSibling,g=d.parentNode;if("title"!==d.tagName)o[l++]=d=a.insertBefore(d,s),r.addSubCommand(new svgedit.history.MoveElementCommand(d,u,g));else{var h=d.nextSibling;r.addSubCommand(new svgedit.history.RemoveElementCommand(d,h,g)),g.removeChild(d)}}Nt();var m=t.nextSibling;t=a.removeChild(t),r.addSubCommand(new svgedit.history.RemoveElementCommand(t,m,a)),r.isEmpty()||W(r),At(o)}}},this.moveToTopSelectedElement=function(){var t=S[0];if(null!=t){var e=t,i=e.parentNode,r=e.nextSibling;e=e.parentNode.appendChild(e),r!=e.nextSibling&&(W(new svgedit.history.MoveElementCommand(e,r,i,"top")),D("changed",[e]))}},this.moveToBottomSelectedElement=function(){var t=S[0];if(null!=t){var e=t,i=e.parentNode,r=e.nextSibling,n=e.parentNode.firstChild;"title"==n.tagName&&(n=n.nextSibling),"defs"==n.tagName&&(n=n.nextSibling),e=e.parentNode.insertBefore(e,n),r!=e.nextSibling&&(W(new svgedit.history.MoveElementCommand(e,r,i,"bottom")),D("changed",[e]))}},this.moveUpDownSelected=function(t){var e=S[0];if(e){var i,r;curBBoxes=[];var n=$(dt(getStrokedBBox([e]))).toArray();if("Down"==t&&n.reverse(),$.each(n,function(){if(r)return i=this,!1;this==e&&(r=!0)}),i){var a=e,s=a.parentNode,o=a.nextSibling;$(i)["Down"==t?"before":"after"](a),o!=a.nextSibling&&(W(new svgedit.history.MoveElementCommand(a,o,s,"Move "+t)),D("changed",[a]))}}},this.moveSelectedElements=function(t,e,i){t.constructor!=Array&&(t/=v,e/=v),i=i||!0;for(var r=new svgedit.history.BatchCommand("position"),n=S.length;n--;){var a=S[n];if(null!=a){var s=u.createSVGTransform(),o=svgedit.transformlist.getTransformList(a);t.constructor==Array?s.setTranslate(t[n],e[n]):s.setTranslate(t,e),o.numberOfItems?o.insertItemBefore(s,0):o.appendItem(s);var l=svgedit.recalculate.recalculateDimensions(a);l&&r.addSubCommand(l),K.requestSelector(a).resize()}}if(!r.isEmpty())return i&&W(r),D("changed",S),r},this.setFilterShadow=function(t){if(!(S.length<=0)){var e=S[0];if(t){var i=svgedit.utilities.findDefs();if(i){var r=$(i).find("filter");r&&r.length||(r=d.createElementNS(n.SVG,"filter"),i.appendChild(r),r.setAttribute("id","shadow-box"));var a=$(r).find("feDropShadow");a&&a.length||(a=d.createElementNS(n.SVG,"feDropShadow"),a.setAttribute("dx","2"),a.setAttribute("dy","2"),a.setAttribute("stdDeviation","2"),r.appendChild(a)),e.setAttribute("filter","url(#shadow-box)")}}else e.removeAttribute("filter")}},this.cloneSelectedElements=function(t,e){function i(t,e){return $(e).index()-$(t).index()}var r,n,a=new svgedit.history.BatchCommand("Clone Elements"),s=S.length;for(S.sort(i),r=0;r<s&&(n=S[r],null!=n);++r);var o=S.slice(0,r);for(this.clearSelection(!0),r=o.length;r--;)n=o[r]=xt(o[r]),(p||c().getCurrentLayer()).appendChild(n),a.addSubCommand(new svgedit.history.InsertElementCommand(n));a.isEmpty()||(At(o.reverse()),this.moveSelectedElements(t,e,!1),W(a)),D("onGaugeCopyPaste",{copy:S,past:o})},this.alignSelectedElements=function(t,e){var i,r,n=[],a=Number.MAX_VALUE,s=Number.MIN_VALUE,l=Number.MAX_VALUE,d=Number.MIN_VALUE,u=Number.MIN_VALUE,g=Number.MIN_VALUE,h=S.length;if(h){for(i=0;i<h&&null!=S[i];++i)switch(r=S[i],n[i]=getStrokedBBox([r]),e){case"smallest":(("l"==t||"c"==t||"r"==t)&&(u==Number.MIN_VALUE||u>n[i].width)||("t"==t||"m"==t||"b"==t)&&(g==Number.MIN_VALUE||g>n[i].height))&&(a=n[i].x,l=n[i].y,s=n[i].x+n[i].width,d=n[i].y+n[i].height,u=n[i].width,g=n[i].height);break;case"largest":(("l"==t||"c"==t||"r"==t)&&(u==Number.MIN_VALUE||u<n[i].width)||("t"==t||"m"==t||"b"==t)&&(g==Number.MIN_VALUE||g<n[i].height))&&(a=n[i].x,l=n[i].y,s=n[i].x+n[i].width,d=n[i].y+n[i].height,u=n[i].width,g=n[i].height);break;default:n[i].x<a&&(a=n[i].x),n[i].y<l&&(l=n[i].y),n[i].x+n[i].width>s&&(s=n[i].x+n[i].width),n[i].y+n[i].height>d&&(d=n[i].y+n[i].height)}"page"==e&&(a=0,l=0,s=o.contentW,d=o.contentH);var m=new Array(h),c=new Array(h);for(i=0;i<h&&null!=S[i];++i){r=S[i];var v=n[i];switch(m[i]=0,c[i]=0,t){case"l":m[i]=a-v.x;break;case"c":m[i]=(a+s)/2-(v.x+v.width/2);break;case"r":m[i]=s-(v.x+v.width);break;case"t":c[i]=l-v.y;break;case"m":c[i]=(l+d)/2-(v.y+v.height/2);break;case"b":c[i]=d-(v.y+v.height)}}this.moveSelectedElements(m,c)}},this.divideSelectedElements=function(t){var e,i,r=[],n=Number.MAX_VALUE,a=Number.MIN_VALUE,s=Number.MAX_VALUE,o=Number.MIN_VALUE,l=0,d=0,u=0,g=S.length;if(g&&!(g<3)){for(e=0;e<g&&null!=S[e];++e)i=S[e],u++,r[e]=getStrokedBBox([i]),r[e].index=e,r[e].x<n&&(n=r[e].x),r[e].y<s&&(s=r[e].y),r[e].x+r[e].width>a&&(a=r[e].x+r[e].width),r[e].y+r[e].height>o&&(o=r[e].y+r[e].height),d+=r[e].height,l+=r[e].width;"h"===t?r.sort((t,e)=>t.x>e.x?1:-1):"v"===t&&r.sort((t,e)=>t.y>e.y?1:-1),u--;var h=new Array(r.length),m=new Array(r.length),c=(a-n-l)/u,v=(o-s-d)/u,p=n,f=s;for(e=0;e<r.length;++e){var y=r[e];switch(h[e]={x:y.x,i:y.index},m[e]={y:y.y,i:y.index},t){case"h":h[e].x=e>0?p>y.x?p-y.x:-(y.x-p):0,p+=y.width+c,m[e].y=0;break;case"v":m[e].y=e>0?f>y.y?f-y.y:-(y.y-f):0,f+=y.height+v,h[e].x=0}}h.sort((t,e)=>t.i>e.i?1:-1),m.sort((t,e)=>t.i>e.i?1:-1),h=h.map(t=>Math.round(100*t.x)/100),m=m.map(t=>Math.round(100*t.y)/100),this.moveSelectedElements(h,m)}},this.contentW=Dt().w,this.contentH=Dt().h,this.updateCanvas=function(t,e){u.setAttribute("width",t),u.setAttribute("height",e);var i=$("#canvasBackground")[0],r=g.getAttribute("x"),n=g.getAttribute("y"),a=t/2-this.contentW*v/2,s=e/2-this.contentH*v/2;svgedit.utilities.assignAttributes(g,{width:this.contentW*v,height:this.contentH*v,x:a,y:s,viewBox:"0 0 "+this.contentW+" "+this.contentH}),svgedit.utilities.assignAttributes(i,{width:g.getAttribute("width"),height:g.getAttribute("height"),x:a,y:s});var o=svgedit.utilities.getElem("background_image");return o&&svgedit.utilities.assignAttributes(o,{width:"100%",height:"100%"}),K.selectorParentGroup.setAttribute("transform","translate("+a+","+s+")"),nt("canvasUpdated",{new_x:a,new_y:s,old_x:r,old_y:n,d_x:a-r,d_y:s-n}),{x:a,y:s,old_x:r,old_y:n,d_x:a-r,d_y:s-n}},this.setBackground=function(t,e){
var i=svgedit.utilities.getElem("canvasBackground"),r=$(i).find("rect")[0],a=svgedit.utilities.getElem("background_image");r.setAttribute("fill",t),e?(a||(a=d.createElementNS(n.SVG,"image"),svgedit.utilities.assignAttributes(a,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})),I(a,e),i.appendChild(a)):a&&a.parentNode.removeChild(a)},this.cycleElement=function(t){var e,i=S[0],r=!1,n=pt(p||c().getCurrentLayer());if(n.length){if(null==i)e=t?n.length-1:0,r=n[e];else for(var a=n.length;a--;)if(n[a]==i){e=t?a-1:a+1,e>=n.length?e=0:e<0&&(e=n.length-1),r=n[e];break}kt([r],!0),D("selected",S)}},this.clear(),this.getExtensionMember=function(t,e){var i=[];return $.each(extensions,function(r,n){n&&t in n&&i.push(n[t](e))}),i},this.getPrivateMethods=function(){var t={addCommandToHistory:W,setGradient:Rt,addSvgElementFromJson:C,addSvgGroupFromJson:w,assignAttributes:L,BatchCommand:q,call:D,ChangeElementCommand:H,copyElem:xt,ffClone:bt,findDefs:E,findDuplicateGradient:Ut,getElem:M,getId:ut,getIntersectionList:dt,getMouseTarget:Et,getNextId:gt,getPathBBox:G,getUrlFromAttr:B,hasMatrixTransform:A,identifyLayers:$t,InsertElementCommand:F,isIdentity:svgedit.math.isIdentity,logMatrix:wt,matrixMultiply:N,MoveElementCommand:z,preventClickDefault:Bt,recalculateAllSelectedDimensions:St,recalculateDimensions:V,remapElement:O,RemoveElementCommand:j,removeUnusedDefElems:Tt,round:lt,runExtensions:nt,setSpecialsIds:at,runGetExtensions:st,runExtension:ot,sanitizeSvg:U,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:k,transformPoint:_,walkTree:svgedit.utilities.walkTree};return t}};
var mysvgeditor={initSvgEditor:function(e,t,n,o,i,a,r,l){window.svgEditor=function(e){function s(t,n){var o=!1!==u.setSvgString(t);n=n||e.noop,o?n(!0):e.alert(uiStrings.notification.errorLoadingSVG,function(){n(!1)})}var c={};e(document).unbind("keydown"),c.tool_scale=1,c.exportWindowCt=0,c.langChanged=!1,c.showSaveWarning=!1,c.storagePromptClosed=!1,c.extensionLoadedCallback=n,c.onSelectedElement=t,c.changeColor=o,c.onGaugeAdded=i,c.onGaugeResized=r,c.onGaugeRemoved=a,c.onGaugeCopyPaste=l,c.currentExtensionsInteractivityType=[],c.currentExtensionsPrefixIdType=[],c.shapesGrps={},c.shapesList=[],c.baseSvgTags=["path","line","rect","circle","ellipse","text","image"];var u,d,f=["VAL_","HXI_","HXB_","HXS_"],p=["HXI_","HXB_","HXS_","GXP_","HXC_","BAG_","SLI_","HXT_"],g=["SHE_"],v=svgedit.utilities,h=svgedit.shapes;return isReady=!1,customExportImage=!1,customExportPDF=!1,callbacks=[],defaultPrefs={lang:"",iconsize:"",bkgd_color:"#FFF",bkgd_url:"",img_save:"embed",save_notice_done:!1,export_notice_done:!1},curPrefs={},curConfig={extensions:[],allowedOrigins:[]},defaultExtensions=["ext-overview_window.js","ext-markers.js","ext-connector.js","ext-eyedropper.js","ext-imagelib.js","ext-grid.js","ext-polygon.js","ext-panning.js","ext-storage.js"],defaultConfig={canvasName:"default",canvas_expansion:3,initFill:{color:"FF0000",opacity:1},initStroke:{width:1,color:"000000",opacity:1},initOpacity:1,colorPickerCSS:null,initTool:"select",exportWindowType:"new",wireframe:!1,showlayers:!1,no_save_warning:!1,imgPath:"images/",langPath:"locale/",extPath:"extensions/",jGraduatePath:"jgraduate/images/",shapesPath:"assets/lib/svgeditor/shapes/",dimensions:[640,480],gridSnapping:!0,gridColor:"#000",baseUnit:"px",snappingStep:2,showRulers:!0,preventAllURLConfig:!1,preventURLContentLoading:!1,lockExtensions:!1,noDefaultExtensions:!1,showGrid:!1,noStorageOnLoad:!1,forceStorage:!1,emptyStorageOnDecline:!1},uiStrings=c.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:"Move selected elements to layer '%s'?",QwantToClear:"Do you want to clear the drawing?\nThis will also erase your undo history!",QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history!",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",saveFromBrowser:"Select 'Save As...' in your browser to save this image as a %s file.",noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:"Retrieving '%s' ..."}},e.pref=function(e,t){return t?(curPrefs[e]=t,void(c.curPrefs=curPrefs)):e in curPrefs?curPrefs[e]:defaultPrefs[e]},c.loadContentAndPrefs=function(){if(curConfig.forceStorage||!curConfig.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=(?:prefsAndContent|prefsOnly)/)){if(c.storage&&(curConfig.forceStorage||!curConfig.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=prefsAndContent/))){var e="svgedit-"+curConfig.canvasName,t=c.storage.getItem(e);t&&c.loadFromString(t)}var n;for(n in defaultPrefs)if(defaultPrefs.hasOwnProperty(n)){var o="web-edit-"+n;if(c.storage){var i=c.storage.getItem(o);i&&(defaultPrefs[n]=String(i))}else if(window.widget)defaultPrefs[n]=widget.preferenceForKey(o);else{var a=document.cookie.match(new RegExp("(?:^|;\\s*)"+v.preg_quote(encodeURIComponent(o))+"=([^;]+)"));defaultPrefs[n]=a?decodeURIComponent(a[1]):""}}}},c.setConfig=function(t,n){function o(t,n,o){t[n]&&"object"==typeof t[n]?e.extend(!0,t[n],o):t[n]=o}n=n||{},e.each(t,function(i,a){if(t.hasOwnProperty(i))if(defaultPrefs.hasOwnProperty(i)){if(!1===n.overwrite&&(curConfig.preventAllURLConfig||curPrefs.hasOwnProperty(i)))return;!0===n.allowInitialUserOverride?defaultPrefs[i]=a:e.pref(i,a)}else if(["extensions","allowedOrigins"].indexOf(i)>-1){if(!1===n.overwrite&&(curConfig.preventAllURLConfig||"allowedOrigins"===i||"extensions"===i&&curConfig.lockExtensions))return;curConfig[i]=curConfig[i].concat(a)}else if(defaultConfig.hasOwnProperty(i)){if(!1===n.overwrite&&(curConfig.preventAllURLConfig||curConfig.hasOwnProperty(i)))return;if(curConfig.hasOwnProperty(i)){if(!1===n.overwrite)return;o(curConfig,i,a)}else!0===n.allowInitialUserOverride?o(defaultConfig,i,a):defaultConfig[i]&&"object"==typeof defaultConfig[i]?(curConfig[i]={},e.extend(!0,curConfig[i],a)):curConfig[i]=a}}),c.curConfig=curConfig},c.setCustomHandlers=function(t){c.ready(function(){t.open&&(e('#tool_open > input[type="file"]').remove(),e("#tool_open").show(),u.open=t.open),t.save&&(c.showSaveWarning=!1,u.bind("saved",t.save)),t.exportImage&&(customExportImage=t.exportImage,u.bind("exported",customExportImage)),t.exportPDF&&(customExportPDF=t.exportPDF,u.bind("exportedPDF",customExportPDF))})},c.randomizeIds=function(){u.randomizeIds(arguments)},c.init=function(t){function n(){curPrefs=e.extend(!0,{},defaultPrefs,curPrefs),c.curPrefs=curPrefs}function o(){curConfig=e.extend(!0,{},defaultConfig,curConfig),curConfig.noDefaultExtensions||(curConfig.extensions=curConfig.extensions.concat(defaultExtensions)),e.each(["extensions","allowedOrigins"],function(t,n){curConfig[n]=e.grep(curConfig[n],function(e,t){return t===curConfig[n].indexOf(e)})}),c.curConfig=curConfig}function i(t,n){var o=t.id,i=o.split("_"),a=i[0],r=i[1];n&&u.setStrokeAttr("stroke-"+a,r),pe(),P("#cur_"+a,o,20),e(t).addClass("current").siblings().removeClass("current")}function r(t,n){e.pref("bkgd_color",t),e.pref("bkgd_url",n),u.setBackground(t,n)}function l(){var t=u.getHref(K);if(t=0===t.indexOf("data:")?"":t,c.promptImgURLcallback){var n=c.promptImgURLcallback;n&&he(n)}else e.prompt(uiStrings.notification.enterNewImgURL,t,function(e){e&&he(e)})}function m(t,n){var o,i;n||(n=u.getZoom()),t||(t=e("#svgcanvas"));var a=3e4,r=u.getContentElem(),l=svgedit.units.getTypeMap(),s=l[curConfig.baseUnit];for(o=0;o<2;o++){var c=0===o,d=c?"x":"y",f=c?"width":"height",p=Number(r.getAttribute(d)),g=e("#ruler_"+d+" canvas:first"),v=g.clone();g.replaceWith(v);var h=v[0],m=t[f](),_=m;h.parentNode.style[f]=_+"px";var w,y,b,C=0,x=h.getContext("2d");if(x.fillStyle="#666666",x.fillRect(0,0,h.width,h.height),v.siblings().remove(),m>=a){var k;for(b=parseInt(m/a,10)+1,w=[],w[0]=x,i=1;i<b;i++)h[f]=a,k=h.cloneNode(!0),h.parentNode.appendChild(k),w[i]=k.getContext("2d");k[f]=m%a,m=a}h[f]=m;var S=s*n,E=50/S,F=1;for(i=0;i<re.length&&(y=re[i],F=y,!(E<=y));i++);var P=F*S;x.font="8px sans-serif";for(var A=p/S%F*S,L=A-P;A<_;){L+=P,x.fillStyle="#CACACA";var T,D=Math.round(A)+.5;if(c?(x.moveTo(D,15),x.lineTo(D,0)):(x.moveTo(15,D),x.lineTo(0,D)),y=(L-p)/S,F>=1)T=Math.round(y);else{var I=String(F).split(".")[1].length;T=y.toFixed(I)}if(0!==T&&1e3!==T&&T%1e3==0&&(T=T/1e3+"K"),c)x.fillText(T,A+2,8);else{var N=String(T).split("");for(i=0;i<N.length;i++)x.fillText(N[i],1,A+9+9*i)}var B=P/10;for(i=1;i<10;i++){var O=Math.round(A+B*i)+.5;if(w&&O>m){if(C++,x.stroke(),C>=b){i=10,A=_;continue}x=w[C],A-=a,O=Math.round(A+B*i)+.5}var U=i%2?12:10;c?(x.moveTo(O,15),x.lineTo(O,U)):(x.moveTo(15,O),x.lineTo(U,O))}A+=P}x.strokeStyle="#666666",x.stroke()}}function _(){u.deleteCurrentLayer()&&(ye(),se(),e("#layerlist tr.layer").removeClass("layersel"),e("#layerlist tr.layer:first").addClass("layersel"))}function w(){var t=u.getCurrentDrawing().getCurrentLayerName()+" copy";e.prompt(uiStrings.notification.enterUniqueLayerName,t,function(t){t&&(u.getCurrentDrawing().hasLayer(t)?e.alert(uiStrings.notification.dupeLayerName):(u.cloneLayer(t),ye(),se()))})}function y(){e("#layerlist tr.layersel").index()!=u.getCurrentDrawing().getNumLayers()-1&&(u.mergeLayer(),ye(),se())}function b(t){var n=e("#layerlist tr.layersel").index(),o=u.getCurrentDrawing().getNumLayers();(n>0||n<o-1)&&(n+=t,u.setCurrentLayerPosition(o-n-1),se())}function C(e,t){var n=Number(e.value),o=n+t,i=o>=n;return 0===t?n:n>=24?i?Math.round(1.1*n):Math.round(n/1.1):n<=1?i?2*n:n/2:o}function x(e,t){var n=Number(e.value);if(0===n)return 100;var o=n+t;return 0===t?n:n>=100?o:o>=n?2*n:n/2}function k(e){e.stopPropagation(),e.preventDefault()}function S(e){e.stopPropagation(),e.preventDefault()}function E(e){e.stopPropagation(),e.preventDefault()}try{"localStorage"in window&&(c.storage=localStorage)}catch(e){}var F=[];e("#lang_select option").each(function(){F.push(this.value)}),function(){var t,i;if(d=e.deparam.querystring(!0),e.isEmptyObject(d))o(),c.loadContentAndPrefs(),n();else{if(d.dimensions&&(d.dimensions=d.dimensions.split(",")),d.bkgd_color&&(d.bkgd_color="#"+d.bkgd_color),d.extensions&&(d.extensions=d.extensions.match(/[:\/\\]/)?"":d.extensions.split(",")),e.each(["extPath","imgPath","langPath","jGraduatePath"],function(e){d[e]&&delete d[e]}),c.setConfig(d,{overwrite:!1}),o(),!curConfig.preventURLContentLoading){if(t=d.source,i=e.param.querystring(),t||i.indexOf("source=data:")>=0&&(t=i.match(/source=(data:[^&]*)/)[1]),t)return void(0===t.indexOf("data:")?c.loadFromDataURI(t):c.loadFromString(t));if(d.url)return void c.loadFromURL(d.url)}d.noStorageOnLoad&&!curConfig.forceStorage||c.loadContentAndPrefs(),n()}}(),function(){var e,n=window.opener;if(n)try{e=n.document.createEvent("Event"),e.initEvent("svgEditorReady",!0,!0),n.document.documentElement.dispatchEvent(e)}catch(e){}t&&setTimeout(t,2e3)}();var P=c.setIcon=function(t,n,o){var i="string"==typeof n?e.getSvgIcon(n,!0):n.clone();i&&e(t).empty().append(i)},A=function(){window.extOverview&&window.extOverview(),window.extMarkers&&window.extMarkers(),window.extEyedropper&&window.extEyedropper(),window.extImagelib&&window.extImagelib(),window.extGrid&&window.extGrid(),window.extPanning&&window.extPanning(),window.extStorage&&window.extStorage(),window.extSwitch&&window.extSwitch(),window.extValue&&window.extValue(),window.extHtmlInput&&window.extHtmlInput(),window.extHtmlChart&&window.extHtmlChart(),window.extHtmlSelect&&window.extHtmlSelect(),window.extHtmlButton&&window.extHtmlButton(),window.extGaugeProgress&&window.extGaugeProgress(),window.extGaugeSemaphore&&window.extGaugeSemaphore(),window.extHtmlBag&&window.extHtmlBag(),window.extLinear&&window.extLinear(),window.extPipe&&window.extPipe(),window.extHtmlSlider&&window.extHtmlSlider(),window.extHtmlSwitch&&window.extHtmlSwitch(),c.putLocale&&c.putLocale(null,F)},L=function(e){h.load(curConfig.shapesPath,function(){Object.values(c.shapesGrps).forEach(e=>{for(var t=0;t<e.length;t++)c.shapesList.push(e[t])}),window.extShapes&&window.extShapes(),e&&e()})};"file:"===document.location.protocol&&setTimeout(A,100),c.canvas=u=new e.SvgCanvas(document.getElementById("svgcanvas"),curConfig);var T,D,I,N,B=["#FFFFFF","#000000","#333333","#4D4D4D","#666666","#808080","#999999","#B3B3B3","#CCCCCC","#E6E6E6","#ECECEC","#F9F9F9","#05285B","#073984","#094BAC","#0B5CD5","#0D6EFD","#3485FD","#5A9CFE","#81B4FE","#A8CBFE","#250657","#35087E","#450BA5","#560DCB","#6610F2","#7E36F4","#975CF6","#AF83F8","#C8A9FA","#281845","#3A2264","#4B2D83","#5D37A2","#6F42C1","#8660CB","#9D7ED5","#B49DDF","#CBBBE9","#4D1230","#6F1B45","#92235A","#B42B6F","#D63384","#DD5498","#E374AB","#EA95BF","#F0B6D3","#4F1319","#721C24","#96242F","#B92D3A","#DC3545","#E25563","#E77681","#ED969E","#F2B6BC","#5B2D07","#84420A","#AC560E","#D56A11","#FD7E14","#FD933A","#FEA75F","#FEBC85","#FED1AA","#5C4503","#856404","#AD8305","#D6A206","#FFC107","#FFCB2F","#FFD556","#FFDF7E","#FFE9A6","#0E3C19","#155724","#1B722F","#228C3A","#28A745","#4AB563","#6DC381","#8FD19E","#B2DFBC","#0C4836","#11694F","#168967","#1BA97F","#20C997","#44D2A8","#67DAB8","#8BE3C9","#AFECDA","#083A42","#0C5460","#106E7D","#13889B","#17A2B8","#3CB1C3","#61C0CF","#86CFDA","#ABDEE5"],O=svgedit.browser.isMac()?"meta+":"ctrl+",U=u.pathActions,R=u.undoMgr,M=curConfig.imgPath+"logo.png",G=e("#workarea"),z=e("#cmenu_canvas"),j=null,H="crosshair",W="crosshair",V="toolbars",X="",Z={fill:null,stroke:null};(function(){e("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var t=e("#dialog_box"),n=e("#dialog_buttons"),o=e("#dialog_content"),i=function(i,a,r,l,s,c,u){var d,f,p;if(o.html("<p>"+a.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt","prompt"==i),n.empty(),d=e('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(n),"alert"!==i&&e('<input type="button" value="'+uiStrings.common.cancel+'">').appendTo(n).click(function(){t.hide(),r&&r(!1)}),"prompt"===i)f=e('<input type="text">').prependTo(n),f.val(l||""),f.bind("keydown","return",function(){d.click()});else if("select"===i){var g=e('<div style="text-align:center;">');if(f=e("<select>").appendTo(g),u){var v=e("<label>").text(u.label);p=e('<input type="checkbox">').appendTo(v),p.val(u.value),u.tooltip&&v.attr("title",u.tooltip),p.prop("checked",!!u.checked),g.append(e("<div>").append(v))}e.each(s||[],function(t,n){"object"==typeof n?f.append(e("<option>").val(n.value).html(n.text)):f.append(e("<option>").html(n))}),o.append(g),l&&f.val(l),c&&f.bind("change","return",c),f.bind("keydown","return",function(){d.click()})}else"process"===i&&d.hide();t.show(),d.click(function(){t.hide();var e="prompt"!==i&&"select"!==i||f.val();r&&(p?r(e,p.prop("checked")):r(e))}).focus(),"prompt"!==i&&"select"!==i||f.focus()};e.alert=function(e,t){i("alert",e,t)},e.confirm=function(e,t){i("confirm",e,t)},e.process_cancel=function(e,t){i("process",e,t)},e.prompt=function(e,t,n){i("prompt",e,n,t)},e.select=function(e,t,n,o,a,r){i("select",e,n,a,t,o,r)}})();var q,Q=function(){var t=e(".tool_button_current");t.length&&"tool_select"!==t[0].id&&(t.removeClass("tool_button_current").addClass("tool_button"),e("#tool_select").addClass("tool_button_current").removeClass("tool_button"),e("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all} #svgcanvas svg{cursor:default}")),u.setMode("select"),G.css("cursor","auto")},K=null,Y=!1,J=!1,$=!1,ee=!1,te=!1,ne=!1,oe=!1,ie="",ae=e("title:first").text(),re=[];for(q=.1;q<1e5;q*=10)re.push(q),re.push(2*q),re.push(5*q);var le=function(e){var t,n=[],o=u.getCurrentDrawing().getNumLayers();for(t=0;t<o;t++)n[t]=u.getCurrentDrawing().getLayerName(t);if(e)for(t=0;t<o;++t)n[t]!=e&&u.getCurrentDrawing().setLayerOpacity(n[t],.5);else for(t=0;t<o;++t)u.getCurrentDrawing().setLayerOpacity(n[t],1)},se=function(){u.clearSelection();for(var t=e("#layerlist tbody").empty(),n=e("#selLayerNames").empty(),o=u.getCurrentDrawing(),i=o.getCurrentLayerName(),a=u.getCurrentDrawing().getNumLayers(),r=e.getSvgIcon("eye");a--;){var l=o.getLayerName(a),s=e('<tr class="layer">').toggleClass("layersel",l===i),c=e('<td class="layervis">').toggleClass("layerinvis",!o.getLayerVisibility(l)),d=e('<td class="layername">'+l+"</td>");t.append(s.append(c,d)),n.append('<option value="'+l+'">'+l+"</option>")}if(void 0!==r){var f=r.clone();e("td.layervis",t).append(f),e.resizeSvgIcons({"td.layervis .svg_icon":14})}e("#layerlist td.layername").mouseup(function(t){e("#layerlist tr.layer").removeClass("layersel"),e(this.parentNode).addClass("layersel"),u.setCurrentLayer(this.textContent),t.preventDefault()}).mouseover(function(){le(this.textContent)}).mouseout(function(){le()}),e("#layerlist td.layervis").click(function(){var t=e(this.parentNode).prevAll().length,n=e("#layerlist tr.layer:eq("+t+") td.layername").text(),o=e(this).hasClass("layerinvis");u.setLayerVisibility(n,o),e(this).toggleClass("layerinvis")});for(var p=5-e("#layerlist tr.layer").size();p-- >0;)t.append('<tr><td style="color:white">_</td><td/></tr>')},ce=function(t,n){te||(te=!0,X=u.getSvgString(),e("#save_output_btns").toggle(!!n),e("#tool_source_back").toggle(!n),e("#svg_source_textarea").val(X),e("#svg_source_editor").fadeIn(),e("#svg_source_textarea").focus())},ue=function(t,n){e("#path_node_panel").toggle(t),e("#tools_bottom_2,#tools_bottom_3").toggle(!t),t?(e(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),e("#tool_select").addClass("tool_button_current").removeClass("tool_button"),P("#tool_select","select_node"),Y=!1,J=!1,n.length&&(K=n[0])):setTimeout(function(){P("#tool_select","select")},1e3)},de=function(t,n){if(c.showSaveWarning=!1,n='<?xml version="1.0"?>\n'+n,svgedit.browser.isIE())ce(0,!0);else{var o=t.open("data:image/svg+xml;base64,"+v.encode64(n)),i=e.pref("save_notice_done");if("all"!==i){var a=uiStrings.notification.saveFromBrowser.replace("%s","SVG");svgedit.browser.isGecko()?-1!==n.indexOf("<defs")?(a+="\n\n"+uiStrings.notification.defsFailOnSave,e.pref("save_notice_done","all"),i="all"):e.pref("save_notice_done","part"):e.pref("save_notice_done","all"),"part"!==i&&o.alert(a)}}},fe=function(t,n){var o=n.issues,i=n.exportWindowName;i&&(j=window.open("",i)),j.location.href=n.datauri;var a=e.pref("export_notice_done");if("all"!==a){var r=uiStrings.notification.saveFromBrowser.replace("%s",n.type);if(o.length){var l="\n  ";r+="\n\n"+uiStrings.notification.noteTheseIssues+l+o.join(l)}e.pref("export_notice_done","all"),j.alert(r)}},pe=function(){window.opera&&e("<p/>").hide().appendTo("body").remove()},ge=c.toolButtonClick=function(t,n){if(e(t).hasClass("disabled"))return!1;if(e(t).parent().hasClass("tools_flyout"))return!0;var o="normal";return n||e(".tools_flyout").fadeOut(o),e("#styleoverrides").text(""),G.css("cursor","auto"),e(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),e(t).addClass("tool_button_current").removeClass("tool_button"),!0},ve=c.clickSelect=function(){ge("#tool_select")&&(u.setMode("select"),e("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all}, #svgcanvas svg{cursor:default}"))},he=c.setImageURL=function(t){t||(t=M),u.setImageURL(t),e("#image_url").val(t),0===t.indexOf("data:")?(e("#image_url").hide(),e("#change_image_url").hide()):(u.embedImage(t,function(n){e("#url_notice").toggle(!n),M=t}),e("#image_url").hide(),e("#change_image_url").hide())};c.promptImgURLcallback=null;var me=c.updateCanvas=function(t,n){var o=G.width(),i=G.height(),a=o,r=i,l=u.getZoom(),s=G,f=e("#svgcanvas"),p={x:s[0].scrollLeft+a/2,y:s[0].scrollTop+r/2},g=curConfig.canvas_expansion;o=Math.max(a,u.contentW*l*g),i=Math.max(r,u.contentH*l*g),o==a&&i==r?G.css("overflow","hidden"):G.css("overflow","scroll");var v=f.height()/2,h=f.width()/2;f.width(o).height(i);var _=i/2,w=o/2,y=u.updateCanvas(o,i),b=w/h,C=o/2-a/2,x=i/2-r/2;if(n)n.x+=y.x,n.y+=y.y;else{var k=p.x-h,S=w+k*b,E=p.y-v,F=_+E*b;n={x:S,y:F}}t?u.contentW>s.width()?(G[0].scrollLeft=y.x-10,G[0].scrollTop=y.y-10):(s[0].scrollLeft=C,s[0].scrollTop=x):(s[0].scrollLeft=n.x-a/2,s[0].scrollTop=n.y-r/2),curConfig.showRulers&&(m(f,l),G.scroll()),!0===d.storagePrompt||c.storagePromptClosed||e("#dialog_box").hide()},_e=function(){var t,n,o="none"==u.getColor("fill"),i="none"==u.getColor("stroke"),a=["#tool_fhpath","#tool_line"],r=["#tools_rect .tool_button","#tools_ellipse .tool_button","#tool_text","#tool_path"];if(i)for(t in a)n=a[t],e(n).hasClass("tool_button_current")&&ve(),e(n).addClass("disabled");else for(t in a)n=a[t],e(n).removeClass("disabled");if(i&&o)for(t in r)n=r[t],e(n).hasClass("tool_button_current")&&ve(),e(n).addClass("disabled");else for(t in r)n=r[t],e(n).removeClass("disabled");u.runExtensions("toolButtonStateUpdate",{nofill:o,nostroke:i}),e(".tools_flyout").each(function(){var t=e("#"+this.id+"_show"),n=!1;e(this).children().each(function(){e(this).hasClass("disabled")||(n=!0)}),t.toggleClass("disabled",!n)}),pe()},we=function(){var t,n;if(null!=K)switch(K.tagName){case"use":case"image":case"foreignObject":break;case"g":case"a":var o=null,a=K.getElementsByTagName("*");for(t=0,n=a.length;t<n;t++){var r=a[t].getAttribute("stroke-width");0===t?o=r:o!==r&&(o=null)}e("#stroke_width").val(null===o?"1":o),Z.fill.update(!0);break;default:Z.fill.update(!0),Z.stroke.update(!0);var l=K.getAttribute("stroke-width");e("#stroke_width").val(null===l||"null"===l?"1":l),e("#stroke_style").val(K.getAttribute("stroke-dasharray")||"none");var s=K.getAttribute("stroke-linejoin")||"miter";0!=e("#linejoin_"+s).length&&i(e("#linejoin_"+s)[0]),s=K.getAttribute("stroke-linecap")||"butt",0!=e("#linecap_"+s).length&&i(e("#linecap_"+s)[0])}if(null!=K){var c=100*(K.getAttribute("opacity")||1);e("#group_opacity").val(c),e("#opac_slider").slider("option","value",c),e("#elem_id").val(K.id),e("#elem_class").val(K.getAttribute("class"))}_e()},ye=function(){var t=K;null==t||t.parentNode||(t=null);var n=u.getCurrentDrawing().getCurrentLayerName(),o=u.getMode(),i="px"!==curConfig.baseUnit?curConfig.baseUnit:null,a="pathedit"==o,r=e("#cmenu_canvas li");if(e("#selected_panel, #multiselected_panel, #threemoreselected_panel, #g_panel, #rect_panel, #circle_panel,#ellipse_panel, #line_panel, #text_panel, #image_panel, #container_panel, #use_panel, #a_panel, #xy_panel, #marker_panel, #htmlctrl_panel, #tool_stroke, #tool_angle, #shape_panel").hide(),$||ee||a||e("#tool_stroke").show(),null!=t){var s=t.nodeName;e("#tool_angle").show();var d=u.getRotationAngle(t);e("#angle").val(d);var g=u.getBlur(t);if(e("#blur").val(g),e("#blur_slider").slider("option","value",g),u.addedNew&&"image"===s&&0!==u.getHref(t).indexOf("data:")&&l(),a||"pathedit"==o){var v=U.getNodePoint();if(e("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button"),e("#tool_node_delete").toggleClass("disabled",!U.canDeleteNodes),P("#tool_openclose_path",U.closed_subpath?"open_path":"close_path"),v){var h=e("#seg_type");i&&(v.x=svgedit.units.convertUnit(v.x),v.y=svgedit.units.convertUnit(v.y)),e("#path_node_x").val(v.x),e("#path_node_y").val(v.y),v.type?h.val(v.type).removeAttr("disabled"):h.val(4).attr("disabled","disabled")}return}if(e("#selected_panel").show(),["line","circle","ellipse"].indexOf(s)>=0)e("#xy_panel").hide();else{var m,_;if(["g","polyline","path"].indexOf(s)>=0){var w=u.getStrokedBBox([t]);w&&(m=w.x,_=w.y)}else m=t.getAttribute("x"),_=t.getAttribute("y");if(i&&(m=svgedit.units.convertUnit(m),_=svgedit.units.convertUnit(_)),t.getAttribute("width"),t.getAttribute("heght"),m=Number.parseFloat(m),m=m.toFixed(Number.isInteger(m)?0:2),_=Number.parseFloat(_),_=_.toFixed(Number.isInteger(_)?0:2),e("#selected_x").val(m||0),e("#selected_y").val(_||0),e("#xy_panel").show(),p.indexOf(t.id.substr(0,4))>=0){var y=svgedit.utilities.getBBox(t);e("#htmlctrl_panel").show(),e("#htmlctrl_width").val(y.width||0),e("#htmlctrl_height").val(y.height||0)}}var b=-1==["image","text","path","g","use"].indexOf(s);e("#tool_topath").toggle(b),e("#tool_reorient").toggle("path"===s),e("#tool_reorient").toggleClass("disabled",0===d);var C={g:[],a:[],rect:["rx","width","height"],image:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:[],use:[]},x=t.tagName,k=null;"a"===x&&(k=u.getHref(t),e("#g_panel").show()),"a"===t.parentNode.tagName&&(e(t).siblings().length||(e("#a_panel").show(),k=u.getHref(t.parentNode))),e("#tool_make_link, #tool_make_link").toggle(!k),k&&e("#link_url").val(k);var S=!1;if(C[x]){var E=C[x],F=t.getAttribute("type");F&&0===F.indexOf("svg-ext")?S=!0:e("#"+x+"_panel").show(),e.each(E,function(n,o){var i=t.getAttribute(o);if("px"!==curConfig.baseUnit&&t[o]){var a=t[o].baseVal.value;i=svgedit.units.convertUnit(a)}e("#"+x+"_"+o).val(i||0)});var A="g"===x&&f.indexOf(t.id.substr(0,4))>=0;if("text"==x||A){if(e("#text_panel").css("display","inline"),u.getItalic()?e("#tool_italic").addClass("push_button_pressed").removeClass("tool_button"):e("#tool_italic").removeClass("push_button_pressed").addClass("tool_button"),u.getBold()?e("#tool_bold").addClass("push_button_pressed").removeClass("tool_button"):e("#tool_bold").removeClass("push_button_pressed").addClass("tool_button"),e("#font_family").val(t.getAttribute("font-family")),e("#font_size").val(t.getAttribute("font-size")),e("#text_anchor").val(t.getAttribute("text-anchor")),A){var L=u.getExtensionFont(t);L&&(L.fontFamily&&e("#font_family").val(L.fontFamily),L.fontSize&&e("#font_size").val(L.fontSize.replace("px","")),L.textAnchor&&e("#text_anchor").val(L.textAnchor))}e("#text").val(t.textContent),u.addedNew&&!A&&setTimeout(function(){e("#text").focus().select()},100)}else"image"==x?he(u.getHref(t)):"g"===x||"use"===x?(e("#container_panel").show(),u.getTitle()):"line"===x&&e("#marker_panel").show()}r[("g"===x?"en":"dis")+"ableContextMenuItems"]("#ungroup"),r[("g"!==x&&Y?"en":"dis")+"ableContextMenuItems"]("#group"),S&&r.disableContextMenuItems("#ungroup")}else Y?(e("#multiselected_panel").show(),r.enableContextMenuItems("#group").disableContextMenuItems("#ungroup"),J&&e("#threemoreselected_panel").show()):r.disableContextMenuItems("#interactivity,#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");!$&&!ee||Y||(r.disableContextMenuItems("#ungroup"),e("#g_panel").hide()),e("#tool_undo").toggleClass("disabled",0===R.getUndoStackSize()),e("#tool_redo").toggleClass("disabled",0===R.getRedoStackSize()),u.addedNew=!1,t&&!a||Y?(e("#selLayerNames").removeAttr("disabled").val(n),z.enableContextMenuItems("#delete,#deselect,#cut,#copy,#move_front,#move_up,#move_down,#move_back")):e("#selLayerNames").attr("disabled","disabled"),r.disableContextMenuItems("#interactivity"),t&&!Y&&(F=t.getAttribute("type"),(F&&F.startsWith("svg-ext-")||c.baseSvgTags.indexOf(t.tagName)>-1)&&r.enableContextMenuItems("#interactivity"))},be=function(){if(!T){var t="#workarea.wireframe #svgcontent * { stroke-width: "+1/u.getZoom()+"px; }";e("#wireframe_rules").text(G.hasClass("wireframe")?t:"")}},Ce=function(t){t=t||u.getDocumentTitle();var n=ae+(t?": "+t:"");e("title:first").text(n)},xe=function(e,t){c.onGaugeAdded&&c.onGaugeAdded(t)},ke=function(e,t){c.onGaugeResized&&c.onGaugeResized(t)},Se=function(e,t){c.onGaugeCopyPaste&&c.onGaugeCopyPaste(t)},Ee=function(t,n){var o=u.getMode();"select"===o&&Q();var i="pathedit"==o;K=1===n.length||null==n[1]?n[0]:null,Y=n.length>=2&&null!=n[1],J=n.length>=3&&null!=n[2],$=!1,ee=!1;for(var a=0;a<n.length;a++)n[a]&&n[a].id&&(0===n[a].id.indexOf("HX")?$=!0:0===n[a].id.indexOf("PIE")&&(ee=!0));null!=K&&(i||ee||we()),ue(i,n),ye(),u.runExtensions("selectedChanged",{elems:n,selectedElement:K,multiselected:Y}),ee&&e("#marker_panel").hide();var r=[];if(Y){for(a=0;a<n.length;a++)n[a]&&r.push({id:n[a].id,type:n[a].getAttribute("type")});c.onSelectedElement(r)}else K?(r.push({id:K.id,type:K.getAttribute("type")}),c.onSelectedElement(r)):c.onSelectedElement(null)},Fe=function(t,n){var o=u.getMode(),i=n[0];if(i){if(Y=n.length>=2&&null!=n[1],J=n.length>=3&&null!=n[2],!Y)switch(o){case"rotate":var a=u.getRotationAngle(i);e("#angle").val(a),e("#tool_reorient").toggleClass("disabled",0===a)}u.runExtensions("elementTransition",{elems:n})}},Pe=function(e,t){var n,o=u.getMode();for("select"===o&&Q(),n=0;n<t.length;++n){var i=t[n];i&&"svg"===i.tagName?(se(),me()):i&&K&&null==K.parentNode&&(K=i)}c.showSaveWarning=!0,ye(),K&&"select"===o&&(Z.fill.update(),Z.stroke.update()),u.runExtensions("elementChanged",{elems:t})},Ae=function(){be()},Le=u.zoomChanged=function(t,n,o){var i=0,a=G,r=u.setBBoxZoom(n,a.width()-i,a.height()-i);if(r){var l=r.zoom,s=r.bbox;l<.001?D({value:.1}):(e("#zoom").val((100*l).toFixed(1)),o?me():me(!1,{x:s.x*l+s.width*l/2,y:s.y*l+s.height*l/2}),"zoom"==u.getMode()&&s.width&&Q(),Ae())}},Te=u.myZoomed=function(t,n){const o=0;w_area=G;var i=u.setBBoxZoom(n.bbox,w_area.width()-o,w_area.height()-o);if(i){var a=i.zoom;a<.001?D({value:.1}):(e("#zoom").val((100*a).toFixed(1)),n.center?me():me(!1,n.bbox),Ae())}};D=function(e){var t=e.value/100;if(t<.001)e.value=.1;else{var n=u.getZoom(),o=G;Le(window,{width:0,height:0,x:(o[0].scrollLeft+o.width()/2)/n,y:(o[0].scrollTop+o.height()/2)/n,zoom:t},!0)}},e("#cur_context_panel").delegate("a","click",function(){var t=e(this);return t.attr("data-root")?u.leaveContext():u.setContext(t.text()),u.clearSelection(),!1});var De=function(t,n){var o="";if(n){var i="";o='<a href="#" data-root="y">'+u.getCurrentDrawing().getCurrentLayerName()+"</a>",e(n).parentsUntil("#svgcontent > g").andSelf().each(function(){this.id&&(i+=" > "+this.id,o+=this!==n?' > <a href="#">'+this.id+"</a>":" > "+this.id)}),ie=i}else ie=null;e("#cur_context_panel").toggle(!!n).html(o),Ce()},Ie=function(){Z.fill.prep(),Z.stroke.prep()},Ne={},Be=function(){e(".tools_flyout").each(function(){var t=e("#"+this.id+"_show");if(!t.data("isLibrary")){var n=[];e(this).children().each(function(){n.push(this.title)}),t[0]&&(t[0].title=n.join(" / "))}})},Oe=function(){e(".tools_flyout").each(function(){var t=e("#"+this.id+"_show"),n=t.offset(),o=t.outerWidth();n&&e(this).css({left:(n.left+o)*c.tool_scale,top:n.top})})},Ue=function(t){e.each(t,function(n,o){var i,a=e(n).children(),r=n+"_show",l=e(r),s=!1;a.addClass("tool_button").unbind("click mousedown mouseup").each(function(n){var i=o[n];Ne[i.sel]=i.fn,i.isDefault&&(s=n);var a=function(n){var o,a=i;if("keydown"===n.type){var s=e(a.parent+"_show").hasClass("tool_button_current"),c=e(a.parent+"_show").attr("data-curopt");e.each(t[i.parent],function(e,o){o.sel==c&&(a=n.shiftKey&&s?t[i.parent][e+1]||t[i.parent][0]:o)})}if(e(this).hasClass("disabled"))return!1;ge(r)&&a.fn(),o=a.icon?e.getSvgIcon(a.icon,!0):e(a.sel).children().eq(0).clone(),o[0].setAttribute("width",l.width()),o[0].setAttribute("height",l.height()),l.children(":not(.flyout_arrow_horiz)").remove(),l.append(o).attr("data-curopt",a.sel)};e(this).mouseup(a),i.key&&e(document).bind("keydown",i.key[0]+" shift+"+i.key[0],a)}),s?l.attr("data-curopt",o[s].sel):l.attr("data-curopt")||l.attr("data-curopt",o[0].sel);var c=e(r).position();l.mousedown(function(t){if(l.hasClass("disabled"))return!1;var o=e(n),a=c.left+34,r=-1*o.width(),s=o.data("shown_popop")?200:0;i=setTimeout(function(){l.data("isLibrary")?o.css("left",a).show():o.css("left",r).show().animate({left:a},150),o.data("shown_popop",!0)},s),t.preventDefault()}).mouseup(function(t){clearTimeout(i);var n=e(this).attr("data-curopt");l.data("isLibrary")&&e(r.replace("_show","")).is(":visible")?ge(r,!0):ge(r)&&Ne[n]&&Ne[n]()})}),Be(),Oe()},Re=function(t,n){var o=e("<div>",{class:"tools_flyout",id:t}).appendTo("#svg_editor").append(n);return o},Me=function(){var e,t=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,n=document.getElementsByTagName("script")[0];for(e in n.style)if(t.test(e))return e.match(t)[0];return"WebkitOpacity"in n.style?"Webkit":"KhtmlOpacity"in n.style?"Khtml":""}(),Ge=function(t,n){var o=["top","left","bottom","right"];t.each(function(){var t,i=e(this),a=i.outerWidth()*(n-1),r=i.outerHeight()*(n-1);for(t=0;t<4;t++){var l=o[t],s=i.data("orig_margin-"+l);null==s&&(s=parseInt(i.css("margin-"+l),10),i.data("orig_margin-"+l,s));var c=s*n;"right"===l?c+=a:"bottom"===l&&(c+=r),i.css("margin-"+l,c)}})},ze=c.setIconSize=function(t){var n="#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout",o=e(n),i=1;if("number"==typeof t)i=t;else{var a={s:.75,m:1,l:1.25,xl:1.5};i=a[t]}c.tool_scale=i,Oe();var r=o.parents(":hidden");r.css("visibility","hidden").show(),Ge(o,i),r.css("visibility","visible").hide(),e.pref("iconsize",t),e("#iconsize").val(t);var l={"#tools_top":{left:50+e("#main_button").width(),height:72},"#tools_left":{width:31,top:74},"div#workarea":{left:38,top:74}},s=e("#tool_size_rules")
;if(s.length?s.empty():s=e('<style id="tool_size_rules"></style>').appendTo("head"),"m"!==t){var u="";e.each(l,function(n,o){n="#svg_editor "+n.replace(/,/g,", #svg_editor"),u+=n+"{",e.each(o,function(e,n){var o;"number"==typeof n?o=n*i+"px":(n[t]||n.all)&&(o=n[t]||n.all),u+=e+":"+o+";"}),u+="}"});var d="-"+Me.toLowerCase()+"-";u+=n+"{"+d+"transform: scale("+i+");} #svg_editor div.toolset .toolset {"+d+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+d+"transform: scale("+1/i+");}",s.text(u)}Oe()},je=function(t,n,o,i){var a=e(t);n=e(n);var r=!1,l=i.dropUp;l&&e(t).addClass("dropup"),n.find("li").bind("mouseup",function(){i.seticon&&(P("#cur_"+a[0].id,e(this).children()),e(this).addClass("current").siblings().removeClass("current")),o.apply(this,arguments)}),e(window).mouseup(function(e){r||(a.removeClass("down"),n.hide(),n.css({top:0,left:0})),r=!1}),a.bind("mousedown",function(){var e=a.offset();l?(e.top-=n.height(),e.left+=8):e.top+=a.height(),n.offset(e),a.hasClass("down")?(n.hide(),n.css({top:0,left:0})):(n.show(),r=!0),a.toggleClass("down")}).hover(function(){r=!0}).mouseout(function(){r=!1}),i.multiclick&&n.mousedown(function(){r=!0})},He=[],We=function(t,n){if(n){var o=!1,i=!0;if(n.langReady)if(c.langChanged){var a=e.pref("lang");n.langReady({lang:a,uiStrings:uiStrings})}else He.push(n);var r=function(){n.callback&&!o&&i&&(o=!0,n.callback())},l=[];n.context_tools&&e.each(n.context_tools,function(t,n){var o,i=n.container_id?' id="'+n.container_id+'"':"",a=e("#"+n.panel);switch(a.length||(a=e("<div>",{id:n.panel}).appendTo("#tools_top")),n.type){case"tool_button":o='<div class="tool_button">'+n.id+"</div>";var r=e(o).appendTo(a);n.events&&e.each(n.events,function(t,n){e(r).bind(t,n)});break;case"select":o="<label"+i+'><select id="'+n.id+'">',e.each(n.options,function(e,t){var i=e==n.defval?" selected":"";o+='<option value="'+e+'"'+i+">"+t+"</option>"}),o+="</select></label>";var s=e(o).appendTo(a).find("select");e.each(n.events,function(t,n){e(s).bind(t,n)});break;case"button-select":o='<div id="'+n.id+'" class="dropdown toolset" title="'+n.title+'"><div id="cur_'+n.id+'" class="icon_label"></div><button></button></div>';var c=e('<ul id="'+n.id+'_opts"></ul>').appendTo("#option_lists");n.colnum&&c.addClass("optcols"+n.colnum),e(o).appendTo(a).children(),l.push({elem:"#"+n.id,list:"#"+n.id+"_opts",title:n.title,callback:n.events.change,cur:"#cur_"+n.id});break;case"input":o="<label"+i+'><span id="'+n.id+'_label">'+n.label+':</span><input id="'+n.id+'" title="'+n.title+'" size="'+(n.size||"4")+'" value="'+(n.defval||"")+'" type="text"/></label>';var u=e(o).appendTo(a).find("input");n.spindata&&u.SpinButton(n.spindata),n.events&&e.each(n.events,function(e,t){u.bind(e,t)})}}),n.mySetMarker&&(c.setMarker=n.mySetMarker),r()}},Ve=function(t,n,o){var i={alpha:n};if(0===t.indexOf("url(#")){var a=u.getRefElem(t);a=a?a.cloneNode(!0):e("#"+o+"_color defs *")[0],i[a.tagName]=a}else 0===t.indexOf("#")?i.solidColor=t.substr(1):i.solidColor="none";return new e.jGraduate.Paint(i)};e("#text").focus(function(){}),e("#text").blur(function(){}),u.bind("onGaugeAdded",xe),u.bind("onGaugeResized",ke),u.bind("onGaugeCopyPaste",Se),u.bind("selected",Ee),u.bind("transition",Fe),u.bind("changed",Pe),u.bind("saved",de),u.bind("exported",fe),u.bind("exportedPDF",function(e,t){var n=t.exportWindowName;n&&(j=window.open("",n)),j.location.href=t.dataurlstring}),u.bind("zoomed",Le),u.bind("myZoomed",Te),u.bind("contextset",De),u.bind("extension_added",We),u.textActions.setInputElem(e("#text")[0]);var Xe='<div class="palette_item" style="background-color:#FFF;color:red;font-size:20px;line-height: 15px;text-align:center;" data-rgb="none">X</div>';e.each(B,function(e,t){Xe+='<div class="palette_item" style="background-color: '+t+';" data-rgb="'+t+'"></div>'}),e("#palette").append(Xe);var Ze=["#FFF","#888","#000"];Xe="",e.each(Ze,function(){Xe+='<div class="color_block" style="background-color:'+this+';"></div>'}),e("#bg_blocks").append(Xe);var qe=e("#bg_blocks div"),Qe="cur_background";qe.each(function(){var t=e(this);t.click(function(){qe.removeClass(Qe),e(this).addClass(Qe)})}),r(e.pref("bkgd_color"),e.pref("bkgd_url")),e("#image_save_opts input").val([e.pref("img_save")]);var Ke=function(e){u.setRectRadius(e.value)},Ye=function(e){u.setFontSize(e.value)},Je=function(e){var t=e.value;0==t&&K&&["line","polyline"].indexOf(K.nodeName)>=0&&(t=e.value=1),u.setStrokeWidth(t)},$e=function(t){u.setRotationAngle(t.value),e("#tool_reorient").toggleClass("disabled",0===parseInt(t.value,10))},et=function(t,n){null==n&&(n=t.value),e("#group_opacity").val(n),t&&t.handle||e("#opac_slider").slider("option","value",n),u.setOpacity(n/100)},tt=function(t,n,o){null==n&&(n=t.value),e("#blur").val(n);var i=!1;t&&t.handle||(e("#blur_slider").slider("option","value",n),i=!0),o?u.setBlurNoUndo(n):u.setBlur(n,i)};e("#stroke_style").change(function(){u.setStrokeAttr("stroke-dasharray",e(this).val()),pe()}),e("#stroke_linejoin").change(function(){u.setStrokeAttr("stroke-linejoin",e(this).val()),pe()}),e("select").change(function(){e(this).blur()});var nt=!1;e("#selLayerNames").change(function(){var t=this.options[this.selectedIndex].value,n=uiStrings.notification.QmoveElemsToLayer.replace("%s",t),o=function(e){e&&(nt=!0,u.moveSelectedToLayer(t),u.clearSelection(),se())};t&&(nt?o(!0):e.confirm(n,o))}),e("#font_family").change(function(){u.setFontFamily(this.value)}),e("#seg_type").change(function(){u.setSegType(e(this).val())}),e("#text").keyup(function(){u.setTextContent(this.value)}),e("#image_url").change(function(){he(this.value)}),e("#link_url").change(function(){this.value.length?u.setLinkURL(this.value):u.removeHyperlink()}),e("#g_title").change(function(){u.setGroupTitle(this.value)}),e(".attr_changer").change(function(){var t=this.getAttribute("data-attr"),n=this.value,o=svgedit.units.isValidUnit(t,n,K);if(!o)return e.alert(uiStrings.notification.invalidAttrValGiven),this.value=K.getAttribute(t),!1;if("id"!==t&&"class"!==t)if(isNaN(n))n=u.convertToNum(t,n);else if("px"!==curConfig.baseUnit){var i=svgedit.units.getTypeMap();(K[t]||"pathedit"===u.getMode()||"x"===t||"y"===t)&&(n*=i[curConfig.baseUnit])}if("id"===t){var a=K;u.clearSelection(),a.id=n,u.addToSelection([a],!0)}else u.changeSelectedAttribute(t,n),a=K,u.clearSelection(),u.addToSelection([a],!0);this.blur()}),e("#palette").mouseover(function(){var t=e('<input type="hidden">');e(this).append(t),t.focus().remove()}),e(".palette_item").mousedown(function(t){var n,o=t.shiftKey||2===t.button?"stroke":"fill",i=e(this).data("rgb");"none"===i||"transparent"===i||"initial"===i?(i="none",n=new e.jGraduate.Paint):n=new e.jGraduate.Paint({alpha:100,solidColor:i.substr(1)}),Z[o].setPaint(n),u.setColor(o,i),"none"!==i&&1!==u.getPaintOpacity(o)&&u.setPaintOpacity(o,1),c.changeColor&&c.changeColor(o,i),_e()}).bind("contextmenu",function(e){e.preventDefault()}),e("#toggle_stroke_tools").on("click",function(){e("#tools_bottom").toggleClass("expanded")}),function(){var t=null,n=null,o=G[0],i=!1,a=!1;e("#svgcanvas").bind("mousemove mouseup",function(e){if(!1!==i)return o.scrollLeft-=e.clientX-t,o.scrollTop-=e.clientY-n,t=e.clientX,n=e.clientY,"mouseup"===e.type&&(i=!1),!1}).mousedown(function(e){if(1===e.button||!0===a)return i=!0,t=e.clientX,n=e.clientY,!1}),e(window).mouseup(function(){i=!1}),e(document).bind("keydown","space",function(e){u.spaceKey=a=!0,e.preventDefault()}).bind("keyup","space",function(e){e.preventDefault(),u.spaceKey=a=!1}).bind("keydown","shift",function(e){"zoom"===u.getMode()&&G.css("cursor",W)}).bind("keyup","shift",function(e){"zoom"===u.getMode()&&G.css("cursor",H)}),c.setPanning=function(e){u.spaceKey=a=e}}(),function(){var t=e("#main_icon"),n=e("#main_icon span"),o=e("#main_menu"),i=!1,a=0,r=!0,l=!1;e(window).mouseup(function(n){i||(t.removeClass("buttondown"),"INPUT"!=n.target.tagName?o.fadeOut(200):l||(l=!0,e(n.target).click(function(){o.css("margin-left","-9999px").show()}))),i=!1}).mousedown(function(t){var n=e(t.target).closest("div.tools_flyout, .contextMenu").length;n||e(".tools_flyout:visible,.contextMenu").fadeOut(250)}),n.bind("mousedown",function(){t.hasClass("buttondown")?o.fadeOut(200):(o.css("margin-left",0).show(),a||(a=o.height()),o.css("height",0).animate({height:a},200),i=!0),t.toggleClass("buttondown buttonup")}).hover(function(){i=!0}).mouseout(function(){i=!1});var s=e("#main_menu li");s.mouseover(function(){r="rgba(0, 0, 0, 0)"==e(this).css("background-color"),s.unbind("mouseover"),r&&s.mouseover(function(){this.style.backgroundColor="#FFC"}).mouseout(function(){return this.style.backgroundColor="transparent",!0})})}(),c.addDropDown=function(t,n,o){if(0!=e(t).length){var i=e(t).find("button"),a=e(t).find("ul").attr("id",e(t)[0].id+"-list"),r=!1;o?e(t).addClass("dropup"):e("#option_lists").append(a),a.find("li").bind("mouseup",n),e(window).mouseup(function(e){r||(i.removeClass("down"),a.hide()),r=!1}),i.bind("mousedown",function(){if(i.hasClass("down"))a.hide();else{if(!o){var n=e(t).position();a.css({top:n.top+24,left:n.left-10})}a.show(),r=!0}i.toggleClass("down")}).hover(function(){r=!0}).mouseout(function(){r=!1})}},c.addDropDown("#font_family_dropdown",function(){e("#font_family").val(e(this).text()).change()}),c.addDropDown("#opacity_dropdown",function(){if(!e(this).find("div").length){var t=parseInt(e(this).text().split("%")[0],10);et(!1,t)}},!0),e("#opac_slider").slider({start:function(){e("#opacity_dropdown li:not(.special)").hide()},stop:function(){e("#opacity_dropdown li").show(),e(window).mouseup()},slide:function(e,t){et(t)}}),c.addDropDown("#blur_dropdown",e.noop);var ot,it,at=!1;e("#blur_slider").slider({max:10,step:.1,stop:function(t,n){at=!1,tt(n),e("#blur_dropdown li").show(),e(window).mouseup()},start:function(){at=!0},slide:function(e,t){tt(t,null,at)}}),c.addDropDown("#zoom_dropdown",function(){var t=e(this),n=t.data("val");n?Le(window,n):D({value:parseFloat(t.text())})},!0),je("#stroke_linecap","#linecap_opts",function(){i(this,!0)},{dropUp:!0}),je("#stroke_linejoin","#linejoin_opts",function(){i(this,!0)},{dropUp:!0}),je("#tool_position","#position_opts",function(){var e=this.id.replace("tool_pos","").charAt(0);u.alignSelectedElements(e,"page")},{multiclick:!0}),it=function(){e(ot).blur()},e("#svg_editor").find("button, select, input:not(#text)").focus(function(){ot=this,V="toolbars",G.mousedown(it)}).blur(function(){V="canvas",G.unbind("mousedown",it),"textedit"==u.getMode()&&e("#text").focus()});var rt=function(){ge("#tool_fhpath")&&u.setMode("fhpath")},lt=function(){ge("#tool_line")&&u.setMode("line")},st=function(){ge("#tool_square")&&u.setMode("square")},ct=function(){ge("#tool_rect")&&u.setMode("rect")},ut=function(){ge("#tool_fhrect")&&u.setMode("fhrect")},dt=function(){ge("#tool_circle")&&u.setMode("circle")},ft=function(){ge("#tool_ellipse")&&u.setMode("ellipse")},pt=function(){ge("#tool_fhellipse")&&u.setMode("fhellipse")},gt=function(){ge("#tool_image")&&u.setMode("image")},vt=function(){ge("#tool_zoom")&&(u.setMode("zoom"),G.css("cursor",H))},ht=function(t){var n=u.getResolution();t=t?n.zoom*t:1,e("#zoom").val(100*t),u.setZoom(t),Ae(),me(!0)},mt=function(){ge("#tool_zoom")&&(ht(),Q())},_t=function(){ge("#tool_text")&&u.setMode("text")},wt=function(){ge("#tool_path")&&u.setMode("path")};c.clickExtension=function(e){u.clickExtension(e)},c.clickZoom=function(){u.setMode("zoom"),G.css("cursor",H)},c.clickToSetMode=function(e){u.setMode(e)},c.getSvgString=function(){return c.showSaveWarning=!1,u.getSvgString()},c.getSelectedElements=function(){return u.getSelectedElems()},c.setSvgString=function(e){return u.setSvgString(e)},c.enableGridSnapping=function(e){curConfig.gridSnapping=e},c.setDocProperty=function(e,t,n,o){return!("fit"!=t&&!svgedit.units.isValidUnit("width",t))&&!("fit"!=n&&!svgedit.units.isValidUnit("height",n))&&!!u.setResolution(t,n)&&(o||(o="#ffffff"),!(o&&!u.setBackground(o))&&void me())},c.alignSelectedElements=function(e){u.alignSelectedElements(e,"page")},c.setColor=function(e,t,n){var o={alpha:t,solidColor:e,type:"solidColor"};Z[n].setPaint(o),u.setPaint(n,o)},c.setStrokeOption=function(e){i(e,!0)},c.setFilterShadow=function(e){u.setFilterShadow(e)},c.setFontFamily=function(e){u.setFontFamily(e)},c.setTextAlign=function(e){u.setTextAlign(e)},c.clickClearAll=function(){var e=curConfig.dimensions;Q(),u.clear(),u.setResolution(e[0],e[1]),me(!0),ht(),se(),ye(),Ie(),u.runExtensions("onNewDocument")},c.clearSelection=function(){u.clearSelection()},c.setMarker=function(e,t){console.log("marker selected "+e+" "+t)},c.setSvgImageToAdd=function(e){u.setGoodSvgImageContent(e)},c.getShapes=function(){return c.shapesGrps},c.runExtension=function(e,t,...n){return u.runExtension(e,t,n)},c.makeHyperlink=function(e){e&&u.makeHyperlink(e)},c.renameSvgExtensionId=function(e){let t=e.id.substring(0,e.id.indexOf("_"));var n=u.getNextId().replace("svg_",t+"_");return e.content=e.content.split(e.id).join(n),n},c.renameAllSvgExtensionId=function(t,n){var o={content:t,id:""};return e.each(c.currentExtensionsPrefixIdType,function(e,i){for(var a='id=\\"'+i,r=o.content.indexOf(a);r>0;){idend=o.content.indexOf('\\"',r+a.length),o.id=o.content.substring(r,idend);var l=o.id.replace('id=\\"',"");if(-1===n.indexOf(l)){var s=c.renameSvgExtensionId(o);n.push(s.replace('id=\\"',""))}r=t.indexOf(a,r+1)}}),t=o.content,t},c.resetZoom=function(){D({value:100})},c.refreshCanvas=function(){me(!0)};var yt=function(){if(null!=K||Y){var e=u.deleteSelectedElements();null!=a&&a(e)}},bt=function(){(null!=K||Y)&&u.cutSelectedElements()},Ct=function(){(null!=K||Y)&&u.copySelectedElements()},xt=function(){var e=u.getZoom(),t=(G[0].scrollLeft+G.width()/2)/e-u.contentW,n=(G[0].scrollTop+G.height()/2)/e-u.contentH;u.pasteElements("point",t,n)},kt=function(){null!=K&&u.moveToTopSelectedElement()},St=function(){null!=K&&u.moveToBottomSelectedElement()},Et=function(e){null!=K&&u.moveUpDownSelected(e)},Ft=function(){null!=K&&u.convertToPath()},Pt=function(){null!=K&&U.reorient()},At=function(e,t){if(null!=K||Y){if(curConfig.gridSnapping){var n=u.getZoom()*curConfig.snappingStep;e*=n,t*=n}u.moveSelectedElements(e,t)}},Lt=function(){e("#tool_node_link").toggleClass("push_button_pressed tool_button");var t=e("#tool_node_link").hasClass("push_button_pressed");U.linkControlPoints(t)},Tt=function(){U.getNodePoint()&&U.clonePathNode()},Dt=function(){U.getNodePoint()&&U.deletePathNode()},It=function(){var t=e("#tool_add_subpath"),n=!t.hasClass("push_button_pressed");t.toggleClass("push_button_pressed tool_button"),U.addSubPath(n)},Nt=function(){U.opencloseSubPath()},Bt=function(){u.cycleElement(1)},Ot=function(){u.cycleElement(0)},Ut=function(t,n){if(null!=K&&!Y){t||(n*=-1);var o=parseFloat(e("#angle").val())+n;u.setRotationAngle(o),ye()}};clickClear=function(){var t=curConfig.dimensions;e.confirm(uiStrings.notification.QwantToClear,function(e){e&&(Q(),u.clear(),u.setResolution(t[0],t[1]),me(!0),ht(),se(),ye(),Ie(),u.runExtensions("onNewDocument"))})};var Rt=function(){return u.setBold(!u.getBold()),ye(),!1},Mt=function(){return u.setItalic(!u.getItalic()),ye(),!1},Gt=function(){var t={images:e.pref("img_save"),round_digits:6};u.save(t)},zt=function(){e.select("Select an image type for export: ",["PNG","JPEG","BMP","WEBP","PDF"],function(t){function n(){var e=uiStrings.notification.loadingImage;"new"===curConfig.exportWindowType&&c.exportWindowCt++,o=curConfig.canvasName+c.exportWindowCt,j=window.open("data:text/html;charset=utf-8,"+encodeURIComponent("<title>"+e+"</title><h1>"+e+"</h1>"),o)}var o;if(t)if("PDF"===t)customExportPDF||n(),u.exportPDF(o);else{customExportImage||n();var i=parseInt(e("#image-slider").val(),10)/100;u.rasterExport(t,i,o)}},function(){var t=e(this);"JPEG"===t.val()||"WEBP"===t.val()?e("#image-slider").length||e('<div><label>Quality: <input id="image-slider" type="range" min="1" max="100" value="92" /></label></div>').appendTo(t.parent()):e("#image-slider").parent().remove()})},jt=function(){u.open()},Ht=function(){},Wt=function(){R.getUndoStackSize()>0&&(R.undo(),se())},Vt=function(){R.getRedoStackSize()>0&&(R.redo(),se())},Xt=function(){Y?u.groupSelectedElements():K&&u.ungroupSelectedElement()},Zt=function(){u.copySelectedElements(),u.pasteElements("point",20,20)},qt=function(){var t=this.id.replace("tool_align","").charAt(0);u.alignSelectedElements(t,e("#align_relative_to").val())},Qt=function(){var e=this.id.replace("tool_divide","").charAt(0);u.divideSelectedElements(e)},Kt=function(){if(e("#tool_wireframe").toggleClass("push_button_pressed tool_button"),G.toggleClass("wireframe"),!T){var t=e("#wireframe_rules");t.length?t.empty():t=e('<style id="wireframe_rules"></style>').appendTo("head"),be()}};e("#svg_docprops_container, #svg_prefs_container").draggable({cancel:"button,fieldset",containment:"window"});var Yt,Jt,$t,en=function(){if(!ne){ne=!0,e("#image_save_opts input").val([e.pref("img_save")]);var t=u.getResolution();"px"!==curConfig.baseUnit&&(t.w=svgedit.units.convertUnit(t.w)+curConfig.baseUnit,t.h=svgedit.units.convertUnit(t.h)+curConfig.baseUnit),e("#canvas_width").val(t.w),e("#canvas_height").val(t.h),e("#canvas_title").val(u.getDocumentTitle()),e("#svg_docprops").show()}},tn=function(){if(!oe){oe=!0,e("#main_menu").hide();var t=e("#bg_blocks div"),n="cur_background",o=curPrefs.bkgd_color,i=e.pref("bkgd_url");t.each(function(){var t=e(this),i=t.css("background-color")==o;t.toggleClass(n,i),i&&e("#canvas_bg_url").removeClass(n)}),o||t.eq(0).addClass(n),i&&e("#canvas_bg_url").val(i),e("#grid_snapping_on").prop("checked",curConfig.gridSnapping),e("#grid_snapping_step").attr("value",curConfig.snappingStep),e("#grid_color").attr("value",curConfig.gridColor),e("#svg_prefs").show()}},nn=function(){e("#svg_source_editor").hide(),te=!1,e("#svg_source_textarea").blur()},on=function(){if(te){var t=function(){u.clearSelection(),nn(),ht(),se(),Ce(),Ie()};u.setSvgString(e("#svg_source_textarea").val())?t():e.confirm(uiStrings.notification.QerrorsRevertToSource,function(e){if(!e)return!1;t()}),Q()}},an=function(){e("#svg_docprops").hide(),e("#canvas_width,#canvas_height").removeAttr("disabled"),e("#resolution")[0].selectedIndex=0,e("#image_save_opts input").val([e.pref("img_save")]),ne=!1},rn=function(){e("#svg_prefs").hide(),oe=!1},ln=function(){var t=e("#canvas_title").val();Ce(t),u.setDocumentTitle(t);var n=e("#canvas_width"),o=n.val(),i=e("#canvas_height"),a=i.val();return"fit"==o||svgedit.units.isValidUnit("width",o)?(n.parent().removeClass("error"),"fit"==a||svgedit.units.isValidUnit("height",a)?(i.parent().removeClass("error"),u.setResolution(o,a)?(e.pref("img_save",e("#image_save_opts :checked").val()),me(),void an()):(e.alert(uiStrings.notification.noContentToFitTo),!1)):(e.alert(uiStrings.notification.invalidAttrValGiven),i.parent().addClass("error"),!1)):(e.alert(uiStrings.notification.invalidAttrValGiven),n.parent().addClass("error"),!1)},sn=c.savePreferences=function(){var t=e("#bg_blocks div.cur_background").css("background-color")||"#FFF";r(t,e("#canvas_bg_url").val());var n=e("#lang_select").val();n!==e.pref("lang")&&c.putLocale(n,F),ze(e("#iconsize").val()),curConfig.gridSnapping=e("#grid_snapping_on")[0].checked,curConfig.snappingStep=e("#grid_snapping_step").val(),curConfig.gridColor=e("#grid_color").val(),curConfig.showRulers=e("#show_rulers")[0].checked,e("#rulers").toggle(curConfig.showRulers),curConfig.showRulers&&m(),curConfig.baseUnit=e("#base_unit").val(),u.setConfig(curConfig),me(),rn()},cn=e.noop,un=function(){e("#dialog_box").hide(),te||ne||oe?(te?X!==e("#svg_source_textarea").val()?e.confirm(uiStrings.notification.QignoreSourceChanges,function(e){e&&nn()}):nn():ne?an():oe&&rn(),cn()):ie&&u.leaveContext()},dn={width:e(window).width(),height:e(window).height()};if(svgedit.browser.isIE()&&(cn=function(){0===G[0].scrollLeft&&0===G[0].scrollTop&&(G[0].scrollLeft=N.left,G[0].scrollTop=N.top)},N={left:G[0].scrollLeft,top:G[0].scrollTop},e(window).resize(cn),c.ready(function(){setTimeout(function(){cn()},500)}),G.scroll(function(){N={left:G[0].scrollLeft,top:G[0].scrollTop}})),e(window).resize(function(t){e.each(dn,function(t,n){var o=e(window)[t]();G[0]["scroll"+("width"===t?"Left":"Top")]-=(o-n)/2,dn[t]=o}),Oe()}),G.scroll(function(){0!=e("#ruler_x").length&&(e("#ruler_x")[0].scrollLeft=G[0].scrollLeft),0!=e("#ruler_y").length&&(e("#ruler_y")[0].scrollTop=G[0].scrollTop)}),e("#url_notice").click(function(){e.alert(this.title)}),e("#change_image_url").click(l),Yt=["clear","open","save","source","delete","delete_multi","paste","clone","clone_multi","move_top","move_bottom"],Jt="",$t="tool_button_current",e.each(Yt,function(e,t){Jt+=(e?",":"")+"#tool_"+t}),e(Jt).mousedown(function(){e(this).addClass($t)}).bind("mousedown mouseout",function(){e(this).removeClass($t)}),e("#tool_undo, #tool_redo").mousedown(function(){e(this).hasClass("disabled")||e(this).addClass($t)}).bind("mousedown mouseout",function(){e(this).removeClass($t)}),svgedit.browser.isMac()&&!window.opera){var fn=["tool_clear","tool_save","tool_source","tool_undo","tool_redo","tool_clone"];for(q=fn.length;q--;){var pn=document.getElementById(fn[q]);if(pn){var gn=pn.title,vn=gn.indexOf("Ctrl+");pn.title=[gn.substr(0,vn),"Cmd+",gn.substr(vn+5)].join("")}}}var hn=function(t){var n="stroke_color"==t.attr("id")?"stroke":"fill",o=Z[n].paint,i="stroke"==n?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity",a=t.offset();e("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).css(curConfig.colorPickerCSS||{left:a.left-140,bottom:40}).jGraduate({paint:o,window:{pickerTitle:i},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(t){o=new e.jGraduate.Paint(t),Z[n].setPaint(o),u.setPaint(n,o),e("#color_picker").hide()},function(){e("#color_picker").hide()})},mn=function(t,n){var o,i,a=curConfig["fill"===n?"initFill":"initStroke"],r=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="16.5" height="16.5"\t\t\t\t\tfill="#'+a.color+'" opacity="'+a.opacity+'"/>\t\t\t\t\t<defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml"),l=r.documentElement;l=e(t)[0].appendChild(document.importNode(l,!0)),l.setAttribute("width",16.5),this.rect=l.firstChild,this.defs=l.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new e.jGraduate.Paint({solidColor:a.color}),this.type=n,this.setPaint=function(e,t){this.paint=e;var n="none",a=e.type,r=e.alpha/100;switch(a){case"solidColor":n="none"!=e[a]?"#"+e[a]:e[a];break;case"linearGradient":case"radialGradient":this.defs.removeChild(this.grad),this.grad=this.defs.appendChild(e[a]);var l=this.grad.id="gradbox_"+this.type;n="url(#"+l+")"}this.rect.setAttribute("fill",n),this.rect.setAttribute("opacity",r),t&&(u.setColor(this.type,o,!0),u.setPaintOpacity(this.type,i,!0))},this.update=function(e){if(K){var t,n,a=this.type;switch(K.tagName){case"use":case"image":case"foreignObject":return;case"g":case"a":var r=null,l=K.getElementsByTagName("*");for(t=0,n=l.length;t<n;t++){var s=l[t],c=s.getAttribute(a);if(0===t)r=c;else if(r!==c){r=null;break}}if(null===r)return void(o=null);o=r,i=1;break;default:i=parseFloat(K.getAttribute(a+"-opacity")),isNaN(i)&&(i=1);var d="fill"===a?"black":"none";o=K.getAttribute(a)||d}e&&(u.setColor(a,o,!0),u.setPaintOpacity(a,i,!0)),i*=100;var f=Ve(o,i,a);this.setPaint(f)}},this.prep=function(){var t=this.paint.type;switch(t){case"linearGradient":case"radialGradient":var o=new e.jGraduate.Paint({copy:this.paint});u.setPaint(n,o)}}};Z.fill=new mn("#fill_color","fill"),Z.stroke=new mn("#stroke_color","stroke"),e("#stroke_width").val(curConfig.initStroke.width),e("#group_opacity").val(100*curConfig.initOpacity);var _n=Z.fill.rect.cloneNode(!1);_n.setAttribute("style","vector-effect:non-scaling-stroke"),T="non-scaling-stroke"===_n.style.vectorEffect,_n.removeAttribute("style");var wn,yn,bn=Z.fill.rect.ownerDocument,Cn=bn.createElementNS(svgedit.NS.SVG,"feGaussianBlur");void 0===Cn.stdDeviationX&&e("#tool_blur").hide(),e(Cn).remove(),wn="-"+Me.toLowerCase()+"-zoom-",yn=wn+"in",G.css("cursor",yn),G.css("cursor")===yn&&(H=yn,W=wn+"out"),G.css("cursor","auto"),e("#fill_color, #tool_fill .icon_label").click(function(){hn(e("#fill_color")),_e()}),e("#stroke_color, #tool_stroke .icon_label").click(function(){hn(e("#stroke_color")),_e()}),e("#group_opacityLabel").click(function(){e("#opacity_dropdown button").mousedown(),e(window).mouseup()}),e("#zoomLabel").click(function(){e("#zoom_dropdown button").mousedown(),e(window).mouseup()}),e("#tool_move_top").mousedown(function(t){e("#tools_stacking").show(),t.preventDefault()}),e(".layer_button").mousedown(function(){e(this).addClass("layer_buttonpressed")}).mouseout(function(){e(this).removeClass("layer_buttonpressed")}).mouseup(function(){e(this).removeClass("layer_buttonpressed")}),e(".push_button").mousedown(function(){e(this).hasClass("disabled")||e(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){e(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){e(this).removeClass("push_button_pressed").addClass("push_button")}),e("#layer_new").click(function(){var t,n=u.getCurrentDrawing().getNumLayers();do{t=uiStrings.layers.layer+" "+ ++n}while(u.getCurrentDrawing().hasLayer(t));e.prompt(uiStrings.notification.enterUniqueLayerName,t,function(t){t&&(u.getCurrentDrawing().hasLayer(t)?e.alert(uiStrings.notification.dupeLayerName):(u.createLayer(t),ye(),se()))})}),e("#layer_delete").click(_),e("#layer_up").click(function(){b(-1)}),e("#layer_down").click(function(){b(1)}),e("#layer_rename").click(function(){var t=e("#layerlist tr.layersel td.layername").text();e.prompt(uiStrings.notification.enterNewLayerName,"",function(n){n&&(t==n||u.getCurrentDrawing().hasLayer(n)?e.alert(uiStrings.notification.layerHasThatName):(u.renameCurrentLayer(n),se()))})});var xn=300,kn=150,Sn=-1,En=!1,Fn=!1,Pn=function(t){var n=e("#ruler_x");e("#sidepanels").width("+="+t),e("#layerpanel").width("+="+t),n.css("right",parseInt(n.css("right"),10)+t),G.css("right",parseInt(G.css("right"),10)+t),u.runExtensions("workareaResized")},An=function(t){if(Fn&&-1!=Sn){En=!0;var n=Sn-t.pageX,o=e("#sidepanels").width();o+n>xn?(n=xn-o,o=xn):o+n<2&&(n=2-o,o=2),0!=n&&(Sn-=n,Pn(n))}},Ln=function(t){var n=e("#sidepanels").width(),o=(n>2||t?2:kn)-n;Pn(o)};e("#sidepanel_handle").mousedown(function(t){Sn=t.pageX,e(window).mousemove(An),Fn=!1,setTimeout(function(){Fn=!0},20)}).mouseup(function(e){En||Ln(),Sn=-1,En=!1}),e(window).mouseup(function(){Sn=-1,En=!1,e("#svg_editor").unbind("mousemove",An)}),se();var Tn,Dn,In=function(){G.css("line-height",G.height()+"px")};e(window).bind("load resize",In),e("#resolution").change(function(){var t=e("#canvas_width,#canvas_height");if(this.selectedIndex)if("content"==this.value)t.val("fit").attr("disabled","disabled");else{var n=this.value.split("x");e("#canvas_width").val(n[0]),e("#canvas_height").val(n[1]),t.removeAttr("disabled")}else"fit"==e("#canvas_width").val()&&t.removeAttr("disabled").val(100)}),e("input,select").attr("autocomplete","off"),Tn=[{sel:"#tool_select",fn:ve,evt:"click",key:["V",!0]},{sel:"#tool_fhpath",fn:rt,evt:"click",key:["Q",!0]},{sel:"#tool_line",fn:lt,evt:"click",key:["L",!0]},{sel:"#tool_rect",fn:ct,evt:"mouseup",key:["R",!0],parent:"#tools_rect",icon:"rect"},{sel:"#tool_square",fn:st,evt:"mouseup",parent:"#tools_rect",icon:"square"},{sel:"#tool_fhrect",fn:ut,evt:"mouseup",parent:"#tools_rect",icon:"fh_rect"},{sel:"#tool_ellipse",fn:ft,evt:"mouseup",key:["E",!0],parent:"#tools_ellipse",icon:"ellipse"},{sel:"#tool_circle",fn:dt,evt:"mouseup",parent:"#tools_ellipse",icon:"circle"},{sel:"#tool_fhellipse",fn:pt,evt:"mouseup",parent:"#tools_ellipse",icon:"fh_ellipse"},{sel:"#tool_path",fn:wt,evt:"click",key:["P",!0]},{sel:"#tool_text",fn:_t,evt:"click",key:["T",!0]},{sel:"#tool_image",fn:gt,evt:"mouseup"},{sel:"#tool_zoom",fn:vt,evt:"mouseup",key:["Z",!0]},{sel:"#tool_clear",fn:clickClear,evt:"mouseup",key:["N",!0]},{sel:"#tool_save",fn:function(){te?on():Gt()},evt:"mouseup",key:["S",!0]},{sel:"#tool_export",fn:zt,evt:"mouseup"},{sel:"#tool_open",fn:jt,evt:"mouseup",key:["O",!0]},{sel:"#tool_import",fn:Ht,evt:"mouseup"},{sel:"#tool_source",fn:ce,evt:"click",key:["U",!0]},{sel:"#tool_wireframe",fn:Kt,evt:"click",key:["F",!0]},{sel:"#tool_source_save",fn:on,evt:"click"},{sel:"#tool_docprops_save",fn:ln,evt:"click"},{sel:"#tool_docprops",fn:en,evt:"mouseup"},{sel:"#tool_prefs_save",fn:sn,evt:"click"},{sel:"#tool_prefs_option",fn:function(){return tn(),!1},evt:"mouseup"},{sel:"#tool_delete,#tool_delete_multi",fn:yt,evt:"click",key:["del/backspace",!0]},{sel:"#tool_reorient",fn:Pt,evt:"click"},{sel:"#tool_node_link",fn:Lt,evt:"click"},{sel:"#tool_node_clone",fn:Tt,evt:"click"},{sel:"#tool_node_delete",fn:Dt,evt:"click"},{sel:"#tool_openclose_path",fn:Nt,evt:"click"},{sel:"#tool_add_subpath",fn:It,evt:"click"},{sel:"#tool_move_top",fn:kt,evt:"click",key:"ctrl+shift+]"},{sel:"#tool_move_bottom",fn:St,evt:"click",key:"ctrl+shift+["},{sel:"#tool_topath",fn:Ft,evt:"click"},{sel:"#tool_undo",fn:Wt,evt:"click",key:["Z",!0]},{sel:"#tool_redo",fn:Vt,evt:"click",key:["Y",!0]},{sel:"#tool_clone,#tool_clone_multi",fn:Zt,evt:"click",key:["D",!0]},{sel:"#tool_group_elements",fn:Xt,evt:"click",key:["G",!0]},{sel:"#tool_ungroup",fn:Xt,evt:"click"},{sel:"#tool_unlink_use",fn:Xt,evt:"click"},{sel:"[id^=tool_align]",fn:qt,evt:"click"},{sel:"[id^=tool_divide]",fn:Qt,evt:"click"},{sel:"#tool_bold",fn:Rt,evt:"mousedown"},{sel:"#tool_italic",fn:Mt,evt:"mousedown"},{sel:"#sidepanel_handle",fn:Ln,key:["X"]},{sel:"#copy_save_done",fn:un,evt:"click"},{key:"ctrl+left",fn:function(){Ut(0,1)}},{key:"ctrl+right",fn:function(){Ut(1,1)}},{key:"ctrl+shift+left",fn:function(){Ut(0,5)}},{key:"ctrl+shift+right",fn:function(){Ut(1,5)}},{key:"shift+O",fn:Ot},{key:"shift+P",fn:Bt},{key:[O+"up",!0],fn:function(){ht(2)}},{key:[O+"down",!0],fn:function(){ht(.5)}},{key:[O+"]",!0],fn:function(){Et("Up")}},{key:[O+"[",!0],fn:function(){Et("Down")}},{key:["up",!0],fn:function(){At(0,-1)}},{key:["down",!0],fn:function(){At(0,1)}},{key:["left",!0],fn:function(){At(-1,0)}},{key:["right",!0],fn:function(){At(1,0)}},{key:"shift+up",fn:function(){At(0,-10)}},{key:"shift+down",fn:function(){At(0,10)}},{key:"shift+left",fn:function(){At(-10,0)}},{key:"shift+right",fn:function(){At(10,0)}},{key:"A",fn:function(){u.selectAllInCurrentLayer()}},{key:O+"z",fn:Wt},{key:O+"shift+z",fn:Vt},{key:O+"y",fn:Vt},{key:O+"x",fn:bt},{key:O+"c",fn:Ct},{key:O+"v",fn:xt}],Dn={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"},I={setAll:function(){var t={};e.each(Tn,function(n,o){var i;if(o.sel){if(i=e(o.sel),0==i.length)return!0;if(o.evt&&(svgedit.browser.isTouch()&&"click"===o.evt&&(o.evt="mousedown"),i[o.evt](o.fn)),o.parent&&0!=e(o.parent+"_show").length){var a=e(o.parent);a.length||(a=Re(o.parent.substr(1))),a.append(i),e.isArray(t[o.parent])||(t[o.parent]=[]),t[o.parent].push(o)}}if(o.key){var r,l=o.fn,s=!1;if(e.isArray(o.key)?(r=o.key[0],o.key.length>1&&(s=o.key[1]),o.key.length>2&&o.key[2]):r=o.key,r+="",e.each(r.split("/"),function(t,n){e(document).bind("keydown",n,function(e){return l(),s&&e.preventDefault(),!1})}),o.sel&&!o.hidekey&&i.attr("title")){var c=i.attr("title").split("[")[0]+" ("+r+")";Dn[r]=o.sel,i.parents("#main_menu").length||i.attr("title",c)}}}),Ue(t),e(".attr_changer, #image_url").bind("keydown","return",function(t){e(this).change(),t.preventDefault()}),e(window).bind("keydown","tab",function(e){"canvas"===V&&(e.preventDefault(),Bt())}).bind("keydown","shift+tab",function(e){"canvas"===V&&(e.preventDefault(),Ot())}),e("#tool_zoom").dblclick(mt)},setTitles:function(){e.each(Dn,function(t,n){var o=e(n).parents("#main_menu").length;e(n).each(function(){var n;n=o?e(this).text().split(" [")[0]:this.title.split(" [")[0];var i="";e.each(t.split("/"),function(e,t){var n=t.split("+"),o="";n.length>1&&(o=n[0]+"+",t=n[1]),i+=(e?"/":"")+o+(uiStrings["key_"+t]||t)
}),o?this.lastChild.textContent=n+" ["+i+"]":this.title=n+" ["+i+"]"})})},getButtonData:function(t){var n;return e.each(Tn,function(e,o){o.sel===t&&(n=o)}),n}},I.setAll(),c.ready(function(){var t,n=curConfig.initTool,o=e("#tools_left, #svg_editor .tools_flyout"),i=o.find("#tool_"+n),a=o.find("#"+n);t=i.length?i:a.length?a:e("#tool_select"),t.click().mouseup(),curConfig.wireframe&&e("#tool_wireframe").click(),curConfig.showlayers&&Ln(),e("#rulers").toggle(!!curConfig.showRulers),curConfig.showRulers&&(e("#show_rulers")[0].checked=!0),curConfig.baseUnit&&e("#base_unit").val(curConfig.baseUnit),curConfig.gridSnapping&&(e("#grid_snapping_on")[0].checked=!0),curConfig.snappingStep&&e("#grid_snapping_step").val(curConfig.snappingStep),curConfig.gridColor&&e("#grid_color").val(curConfig.gridColor)}),e("#rect_rx").SpinButton({min:0,max:1e3,callback:Ke}),e("#stroke_width").SpinButton({min:0,max:99,smallStep:.1,callback:Je}),e("#angle").SpinButton({min:-180,max:180,step:5,callback:$e}),e("#font_size").SpinButton({min:.001,stepfunc:C,callback:Ye}),e("#group_opacity").SpinButton({min:0,max:100,step:5,callback:et}),e("#blur").SpinButton({min:0,max:10,step:.1,callback:tt}),e("#zoom").SpinButton({min:.001,max:1e4,step:50,stepfunc:x,callback:D}).val(100*u.getZoom()),e("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(e,t,n){switch(e){case"interactivity":break;case"delete":yt();break;case"deselect":var o=u.getMode();u.clearSelection(),u.setMode(o);break;case"cut":bt();break;case"copy":Ct();break;case"paste":u.pasteElements();break;case"paste_in_place":u.pasteElements("in_place");break;case"group":case"group_elements":u.groupSelectedElements();break;case"ungroup":u.ungroupSelectedElement();break;case"move_front":kt();break;case"move_up":Et("Up");break;case"move_down":Et("Down");break;case"move_back":St();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(e)&&svgedit.contextmenu.getCustomHandler(e).call()}u.clipBoard.length&&z.enableContextMenuItems("#paste,#paste_in_place")});var Nn=function(e,t,n){switch(e){case"dupe":w();break;case"delete":_();break;case"merge_down":y();break;case"merge_all":u.mergeAllLayers(),ye(),se()}};if(e("#layerlist").contextMenu({menu:"cmenu_layers",inSpeed:0},Nn),e("#layer_moreopts").contextMenu({menu:"cmenu_layers",inSpeed:0,allowLeft:!0},Nn),e(".contextMenu li").mousedown(function(e){e.preventDefault()}),e("#cmenu_canvas li").disableContextMenu(),z.enableContextMenuItems("#delete,#deselect,#cut,#copy"),window.addEventListener("beforeunload",function(e){if(0===R.getUndoStackSize()&&(c.showSaveWarning=!1),!curConfig.no_save_warning&&c.showSaveWarning)return e.returnValue=uiStrings.notification.unsavedChanges,uiStrings.notification.unsavedChanges},!1),c.openPrep=function(t){e("#main_menu").hide(),0===R.getUndoStackSize()?t(!0):e.confirm(uiStrings.notification.QwantToOpen,t)},window.FileReader){var Bn=function(t){e.process_cancel(uiStrings.notification.loadingImage),t.stopPropagation(),t.preventDefault(),e("#workarea").removeAttr("style"),e("#main_menu").hide();var n,o="drop"==t.type?t.dataTransfer.files[0]:this.files[0];o?-1!=o.type.indexOf("image")&&(-1!=o.type.indexOf("svg")?(n=new FileReader,n.onloadend=function(t){u.importSvgString(t.target.result,!0),e("#dialog_box").hide()},n.readAsText(o)):(n=new FileReader,n.onloadend=function(t){var n=function(n,o){var i=u.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:n,height:o,id:u.getNextId(),style:"pointer-events:inherit"}});u.setHref(i,t.target.result),u.selectOnly([i]),u.alignSelectedElements("m","page"),u.alignSelectedElements("c","page"),ye(),e("#dialog_box").hide()},o=100,i=100,a=new Image;a.src=t.target.result,a.style.opacity=0,a.onload=function(){o=a.offsetWidth,i=a.offsetHeight,n(o,i)}},n.readAsDataURL(o))):e("#dialog_box").hide()};G[0].addEventListener("dragenter",k,!1),G[0].addEventListener("dragover",S,!1),G[0].addEventListener("dragleave",E,!1),G[0].addEventListener("drop",Bn,!1);var On=e('<input type="file">').change(function(){var t=this;c.openPrep(function(n){if(n&&(u.clear(),1===t.files.length)){e.process_cancel(uiStrings.notification.loadingImage);var o=new FileReader;o.onloadend=function(e){s(e.target.result),me()},o.readAsText(t.files[0])}})});e("#tool_open").show().prepend(On);var Un=e('<input type="file">').change(Bn);e("#tool_import").show().prepend(Un)}me(!0),e(function(){window.svgCanvas=u,u.ready=c.ready,u.setSpecialsIds(p,g)}),c.setLang=function(t,n){if(c.langChanged=!0,e.pref("lang",t),e("#lang_select").val(t),n){var o=e("#layerlist tr.layersel td.layername").text(),i=o==uiStrings.common.layer+" 1";if(e.extend(uiStrings,n),u.setUiStrings(n),I.setTitles(),i&&(u.renameCurrentLayer(uiStrings.common.layer+" 1"),se()),He.length)for(;He.length;){var a=He.shift();a.langReady({lang:t,uiStrings:uiStrings})}else u.runExtensions("langReady",{lang:t,uiStrings:uiStrings});u.runExtensions("langChanged",t),Be();var r={"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"};e.each(r,function(t,n){e(n).attr("title",e(t)[0].title)}),e("#multiselected_panel div[id^=tool_align]").each(function(){e("#tool_pos"+this.id.substr(10))[0].title=this.title})}},u&&u.setColor("fill","#FFFFFF"),v.takePil()&&(A(),L(function(){c.currentExtensionsInteractivityType=u.getExtensionMember("getClassId"),c.currentExtensionsPrefixIdType=u.getExtensionMember("getPrefixId")}))},c.ready=function(e){isReady?e():callbacks.push(e)},c.runCallbacks=function(){e.each(callbacks,function(){this()}),isReady=!0},c.loadFromString=function(e){c.ready(function(){s(e)})},c.disableUI=function(e){},c.loadFromURL=function(t,n){n||(n={});var o=n.cache,i=n.callback;c.ready(function(){e.ajax({url:t,dataType:"text",cache:!!o,beforeSend:function(){e.process_cancel(uiStrings.notification.loadingImage)},success:function(e){s(e,i)},error:function(t,n,o){404!=t.status&&t.responseText?s(t.responseText,i):e.alert(uiStrings.notification.URLloadFail+": \n"+o,i)},complete:function(){e("#dialog_box").hide()}})})},c.loadFromDataURI=function(e){c.ready(function(){var t=!1,n=e.match(/^data:image\/svg\+xml;base64,/);n?t=!0:n=e.match(/^data:image\/svg\+xml(?:;(?:utf8)?)?,/),n&&(n=n[0]);var o=e.slice(n.length);s(t?v.decode64(o):decodeURIComponent(o))})},c.addExtension=function(){var e=arguments;u&&(u.addExtension.apply(this,e),c&&c.extensionLoadedCallback&&c.extensionLoadedCallback(e[0],e))},c}(jQuery)}};